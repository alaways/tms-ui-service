import{an as L,r as i,u as k,a as H,s as j,c as g,f as s,j as t,F as w,g as A,t as V}from"./index-a90aa29c.js";import{F,a as G}from"./formik.esm-c4fd04ca.js";import{I as a}from"./InputField-d7971719.js";import{B}from"./breadcrumbs-b9914bbc.js";import{a as l}from"./formatDate-4e046265.js";import{P as K}from"./preLoading-b2445d9d.js";import{S as y}from"./sweetalert2.all-ca2d1030.js";import{W}from"./react-pin-field-c38d4b32.js";import{t as Y}from"./constant-e85f1578.js";const X="admin",ne=()=>{const{id:E}=L(),[z,T]=i.useState(""),v=k(),p=H(),x=y.mixin(Y),[S,r]=i.useState(!1),C=i.useRef(null),[I,P]=i.useState([]);i.useEffect(()=>{p(j("ข้อมูลสินทรัพย์"))},[p]);const d=localStorage.getItem(X);d&&JSON.parse(d).role;const[n,R]=i.useState({company:"",transfer_name:"",created_at:"",shop_phone:"",shop_name:"",receiverName:"",receiverValue:"",bank_name:"",amount:"",receiverValueType:"",status:"",payed_at:"",note:"",reference:"",uuid:"",v_expired:"",can_pay:!1,p_reference:""}),N=[{to:"/apps/finance/transfer-history",label:"ประวัติการโอนเงิน"},{label:"ข้อมูล",isCurrent:!0}],{mutate:D,isLoading:U}=g(A.bblFindOne+"/"+E,{onSuccess:e=>{var o,c,m,_,u,h,b,f;R({...e==null?void 0:e.data,status_text:((o=e==null?void 0:e.data)==null?void 0:o.status)==="complete"?"สำเร็จ":((c=e==null?void 0:e.data)==null?void 0:c.status)==="pending"?"รอชำระ":"ไม่สำเร็จ",amount:(_=(m=e==null?void 0:e.data)==null?void 0:m.amount)==null?void 0:_.toFixed(2),payed_at:(u=e==null?void 0:e.data)!=null&&u.payed_at?l((h=e==null?void 0:e.data)==null?void 0:h.payed_at):"",created_at:(b=e==null?void 0:e.data)!=null&&b.payed_at?l((f=e==null?void 0:e.data)==null?void 0:f.created_at):""})},onError:()=>{console.error("Failed to fetch bu data")}}),{mutate:O,isLoading:M}=g(A.bblConfirm,{onSuccess:e=>{e.statusCode===200||e.code===200?y.fire({icon:"success",title:"ชำระเงินสำเร็จ",padding:"10px 20px",confirmButtonColor:V.color.themePrimary,confirmButtonText:"ยืนยัน"}).then(o=>{o.isConfirmed&&v("/apps/finance/transfer-history")}):x.fire({icon:"error",title:e.message,padding:"10px 20px"})},onError:()=>{console.error("Failed to fetch asset type data")}});return i.useEffect(()=>{D({})},[]),s("div",{className:"flex flex-col gap-2.5",children:[(U||M)&&t(K,{}),S&&t("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s("div",{className:"relative bg-white p-6 rounded-lg shadow-lg text-center",children:[t("button",{onClick:()=>r(!1),className:"absolute top-2 right-2 text-gray-500 hover:text-red-500 text-xl font-bold",children:"×"}),t("h2",{className:"text-xl font-semibold mb-4",children:"Enter PIN Code"}),t(W,{ref:C,length:6,onChange:e=>{e.toUpperCase().replace(/[^A-Z0-9]/g,"")},onComplete:e=>{r(!1),setTimeout(()=>{T(e),O({data:{...I,pin:e}})},1e3)},inputMode:"text",autoFocus:!0,className:"w-12 h-14 mx-1 text-2xl text-center border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all"})]})}),t("div",{className:"flex items-center justify-between flex-wrap",children:t(B,{items:N})}),t("div",{className:"panel px-6 flex-1 py-6",children:t(F,{initialValues:n,onSubmit:()=>{},enableReinitialize:!0,autoComplete:"off",validationSchema:{},children:e=>s(G,{className:"space-y-5 dark:text-white custom-select",children:[t("div",{className:"text-lg font-semibold ltr:sm:text-left rtl:sm:text-right text-center",children:"ข้อมูลผู้ชำระ"}),s("div",{className:"flex gap-4",children:[t(a,{name:"p_reference",label:"transactionID",disabled:!0}),t(a,{name:"created_at",label:"วันที่ดำเนินการ",disabled:!0})]}),s("div",{className:"flex gap-4",children:[t(a,{name:"company",label:"Company",disabled:!0}),t(a,{name:"transfer_name",label:"ชื่อผู้ชำระ",disabled:!0})]}),t("div",{className:"text-lg font-semibold ltr:sm:text-left rtl:sm:text-right text-center",children:"ข้อมูลผู้รับชำระ"}),s("div",{className:"flex gap-4",children:[t(a,{name:"shop_phone",label:"เบอร์โทรศัพท์",disabled:!0}),t(a,{name:"shop_name",label:"ร้านค้า",disabled:!0})]}),s("div",{className:"flex gap-4",children:[t(a,{name:"receiverValueType",label:"ประเภทการโอน",disabled:!0}),t(a,{name:"bank_name",label:"ชื่อธนาคาร",disabled:!0})]}),s("div",{className:"flex gap-4",children:[t(a,{name:"receiverName",label:"ชื่อบัญชี",disabled:!0}),t(a,{name:"receiverValue",label:"เลขบัญชี",disabled:!0})]}),s("div",{className:"flex gap-4",children:[t(a,{name:"amount",label:"จำนวนเงิน",disabled:!0}),t(a,{name:"status_text",label:"สถานะ",disabled:!0})]}),s("div",{className:"flex gap-4",children:[t(a,{name:"payed_at",label:"วันที่ได้รับเงิน",disabled:!0}),t(a,{name:"reference",label:"หมายเลขอ้างอิง",disabled:!0})]}),t("div",{className:"flex gap-4",children:t("div",{className:"w-full",children:t(a,{label:"บันทึกช่วยจำ",name:"note",as:"textarea",rows:"5",className:"form-textarea ltr:rounded-l-none rtl:rounded-r-none resize-none","default-value":"-",disabled:!0})})}),n.status==="pending"&&t("div",{className:"text-center px-2 flex justify-around ",children:s("p",{className:"font-bold text-red-500 mr-2",children:["ชำระได้ถึงเวลา : ",t("span",{children:l(n.v_expired)})," "]})}),t("div",{className:"text-center px-2 flex justify-around",children:n.status=="pending"&&t(w,{children:n.can_pay?t("button",{type:"button",className:"btn btn-success",onClick:()=>{r(!0),P({reference:n==null?void 0:n.p_reference})},children:"โอนเงิน"}):t("button",{type:"button",className:"btn btn-info",disabled:!0,children:"หมดเวลาชำระเงิน"})})})]})})})]})};export{ne as default};
