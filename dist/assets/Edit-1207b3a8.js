import{Y as Le,Z as Re,g as E,an as le,r,i as K,c as U,f as a,j as e,u as tt,a as it,s as at,b as rt,F as G,am as st}from"./index-a90aa29c.js";import{c as se,a as d}from"./object-7405de1d.js";import{S as lt}from"./sweetalert2.all-ca2d1030.js";import{u as nt,a as ot}from"./useUploadMutation-785f6dd6.js";import{u as dt,a as ct}from"./useProvincesMutation-f0b4cb29.js";import{F as ne,a as oe}from"./formik.esm-c4fd04ca.js";import{I as m}from"./InputField-d7971719.js";import{S as v}from"./SelectField-917481a8.js";import{_ as Te}from"./index-f89ea186.js";import{r as Pe}from"./helpFunction-19eb552d.js";import{t as pt,a as mt}from"./constant-e85f1578.js";import{P as ut}from"./preLoading-b2445d9d.js";import{B as ht}from"./breadcrumbs-b9914bbc.js";import{I as $}from"./IconEdit-bf2b08f0.js";import{I as X}from"./IconX-54a3093e.js";import{Q as _t}from"./index-2f30bf27.js";import{P as bt}from"./config-8de56c22.js";import{s as ft}from"./showNotification-b9615e49.js";import{I as gt}from"./IconEye-eb8ead5b.js";import{a as Me}from"./formatDate-4e046265.js";import{q as N,_ as I}from"./transition-d4ca4cfa.js";import{C as vt}from"./CameraOCR-5a7ecbcf.js";import{$ as A}from"./tabs-dd3b1363.js";import"./_defineProperty-6dbd93ca.js";import"./_baseIsEqual-06123cd3.js";import"./isObjectLike-b76e75a8.js";import"./isSymbol-15555f2d.js";import"./react-select.esm-b46d9623.js";import"./createSuper-98fcd92d.js";import"./floating-ui.dom-0aeb9e8a.js";import"./lodash-f7ec5310.js";import"./keyboard-f171a3e5.js";import"./use-is-mounted-22b05dcc.js";import"./bugs-a60d55c3.js";import"./use-resolve-button-type-789d628c.js";function yt(_){return Le(b=>Re.post(E.customerFind+b.data.id,b.data,{},"json").then(x=>x),_)}function xt(_){return Le(b=>Re.post(E.customerUpdate+b.data.id,b.data,{},"json").then(x=>x),_)}const Nt=()=>{const{id:_}=le(),[b,x]=r.useState([]),[u,T]=r.useState([]);r.useState(1),r.useState(bt[0]),r.useState(0);const y=K(n=>n.dataStore.credit_level),[l,k]=r.useState(!1),[h,P]=r.useState({id:null,id_business_unit:"",credit_level:"",note:null}),{mutate:p}=U(E.contractFilter,{onSuccess:n=>{const w=n.data.business_unit.map(D=>({value:D.id,label:D.name}));T(w)},onError:()=>{console.error("Failed to fetch bu data")}}),{mutate:f}=U(E.customerCreditCreateAndUpdate,{onSuccess:n=>{n.code==200&&n.statusCode==200&&(ft("เพิ่มข้อมูลสำเร็จ","success"),H({data:{id_customer:_}}))},onError:n=>{}}),{mutate:H}=U(E.customerCreditFindAll,{onSuccess:n=>{n.code==200&&n.statusCode==200&&(console.log("data",n.data),x(n.data))},onError:n=>{}}),Z=se().shape({id_business_unit:d().required("กรุณาใส่ข้อมูลให้ครบ"),credit_level:d().required("กรุณาใส่ข้อมูลให้ครบ")}),Q=se().shape({id_business_unit:d().required("กรุณาใส่ข้อมูลให้ครบ"),credit_level:d().required("กรุณาใส่ข้อมูลให้ครบ"),note:d().required("กรุณาใส่ข้อมูลให้ครบ")}),J=async n=>{const w={...n,id_customer:_};n.id?f({data:w}):f({data:w}),k(!1)},V=n=>{P({...n,note:""}),k(!0)};return r.useEffect(()=>{p({}),H({data:{id_customer:_}})},[]),a("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:[a("div",{className:"px-5 mb-4 flex justify-between items-center",children:[e("h5",{className:"text-lg font-semibold ltr:sm:text-left rtl:sm:text-right text-center",children:"เครดิตลูกค้า"}),e("button",{className:"hover:text-info cursor-pointer btn btn-primary mr-1",onClick:()=>k(!0),children:"เพิ่มข้อมูล"})]}),e("div",{className:"datatables pagination-padding",children:e(_t,{className:"whitespace-nowrap table-hover invoice-table",records:b,columns:[{accessor:"id",title:"ลำดับ",sortable:!1,textAlignment:"center",render:(n,w)=>e("div",{children:w+1})},{accessor:"business_unit_name",title:"หน่วยธุรกิจ",sortable:!1},{accessor:"credit_level",title:"ระดับเครดิต",sortable:!1,render:({credit_level:n})=>{var w;return e("div",{className:"flex items-center font-normal",children:e("div",{children:`${((w=y.find(D=>D.value===n))==null?void 0:w.label)||"-"}`})})}},{accessor:"admin_name",title:"ผู้ดำเนินการ",sortable:!1},{accessor:"created_at",title:"วันที่ - เวลา",sortable:!1,render:n=>e("p",{children:Me(n==null?void 0:n.created_at)})},{accessor:"action",title:"Actions",sortable:!1,textAlignment:"center",render:n=>a("div",{className:"flex gap-4 items-center w-max mx-auto",children:[a("a",{className:"flex cursor-pointer items-center relative group",onClick:()=>V(n),children:[e($,{className:"w-4.5 h-4.5 flex items-center transition-opacity duration-200 group-hover:opacity-0"}),e("p",{className:"absolute left-[-5px] text-center text-blue-500 opacity-0 transition-opacity duration-200 group-hover:opacity-100",children:"แก้ไข"})]}),a("a",{href:`/apps/customer/credit-level/${n.id_business_unit}?id_customer=${_}`,className:"flex cursor-pointer items-center relative group",children:[e(gt,{className:"w-4.5 h-4.5 flex items-center transition-opacity duration-200 group-hover:opacity-0"}),e("p",{className:"absolute left-[-10px] text-center text-blue-500 opacity-0 transition-opacity duration-200 group-hover:opacity-100",children:"ดูข้อมูล"})]})]})}],minHeight:160,highlightOnHover:!0})}),e(N,{appear:!0,show:l,as:r.Fragment,children:a(I,{as:"div",open:l,onClose:()=>k(!1),className:"relative z-[51]",children:[e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(I.Panel,{className:"panel border-0 p-0 rounded-lg w-full max-w-lg text-black dark:text-white-dark",children:[a("div",{children:[e("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>k(!1),children:e(X,{})}),a("div",{className:"text-lg font-medium  dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:[h!=null&&h.id?"แก้ไขข้อมูล":"เพิ่มข้อมูล"," "]})]}),e(ne,{initialValues:h,onSubmit:J,enableReinitialize:!0,autoComplete:"off",validationSchema:h!=null&&h.id?Q:Z,children:a(oe,{className:"px-4 flex flex-col gap-3 custom-select",children:[e(v,{require:!0,placeholder:"กรุณาเลือก",isSearchable:!0,label:"หน่วยธุรกิจ",options:u,name:"id_business_unit",id:"id_business_unit"}),e(v,{require:!0,label:"ระดับเครดิต (แอดมิน)",id:"credit_level",name:"credit_level",options:y,placeholder:"กรุณาเลือก",isSearchable:!0}),h.id&&e(m,{require:!0,label:"เหตุผลการแก้ไข",name:"note"}),e("div",{className:" pb-5",children:a("div",{className:"flex justify-end items-center mt-8",children:[e("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>{k(!1)},children:"ยกเลิก"}),e("button",{type:"submit",className:"btn btn-primary ltr:ml-4 rtl:mr-4",children:"ยืนยัน"})]})})]})})]})})})})]})})]})},kt=()=>{const{id:_}=le(),[b,x]=r.useState(!1),[u,T]=r.useState({memo:""}),[y,l]=r.useState([]),{mutate:k}=U(E.customerMemoFindAll,{onSuccess:p=>{l(p.data)},onError:p=>{}}),{mutate:h}=U(E.customerMemoAdd,{onSuccess:p=>{k({data:{id_customer:_}})},onError:p=>{}}),P=async p=>{h({data:{id_customer:_,memo:p.memo}}),x(!1)};return r.useEffect(()=>{k({data:{id_customer:_}})},[]),a("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:[a("div",{className:"px-5 mb-4 flex justify-between items-center",children:[e("h1",{className:"text-lg font-semibold ltr:sm:text-left rtl:sm:text-right text-center",children:"บันทึกข้อความสำหรับลูกค้า"}),e("button",{className:"hover:text-info cursor-pointer btn btn-primary mr-1",onClick:()=>{x(!0),T({memo:""})},children:"เพิ่มข้อมูล"})]}),e("div",{className:"overflow-x-auto px-4",children:(y==null?void 0:y.length)>0&&(y==null?void 0:y.map((p,f)=>a("div",{className:"flex flex-col bg-[#FAFAFA] gap-3 border rounded-xl p-4 mb-5",children:[a("div",{className:"flex-1 flex-col justify-center",children:[e("h5",{className:"font-semibold",children:"ข้อความ"}),e("p",{style:{whiteSpace:"pre-line",wordWrap:"break-word"},children:p.memo})]}),a("div",{className:"flex gap-3 justify-end",children:[e("h5",{className:"font-semibold",children:"ผู้ดำเนินการ"}),a("p",{children:[p.admin_name," ",Me(p==null?void 0:p.created_at)]})]})]},f)))}),e(N,{appear:!0,show:b,as:r.Fragment,children:a(I,{as:"div",open:b,onClose:()=>x(!1),className:"relative z-[51]",children:[e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(I.Panel,{className:"panel border-0 p-0 rounded-lg w-full max-w-lg text-black dark:text-white-dark",children:[a("div",{children:[e("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>x(!1),children:e(X,{})}),e("div",{className:"text-lg font-medium  dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:u.id?"ดูข้อมูล":"เพิ่มข้อมูล"})]}),e(ne,{initialValues:u,onSubmit:P,enableReinitialize:!0,autoComplete:"off",children:a(oe,{className:"px-4 pb-4 flex flex-col gap-3 custom-select",children:[e(m,{as:"textarea",label:"ข้อความ",name:"memo",rows:"10"}),!u.id&&e("button",{type:"submit",className:"btn btn-primary  rtl:mr-4",children:"บันทึก"})]})})]})})})})]})})]})},De="admin",li=()=>{var Ae,Ee;const _=(Ae=JSON.parse(localStorage.getItem(De)??"{}"))==null?void 0:Ae.acc,{id:b}=le(),x=K(t=>t.dataStore.credit_level),u=lt.mixin(pt),T=tt(),y=it();r.useEffect(()=>{y(at("ข้อมูลลูกค้า")),y(rt(["customer","/apps/customer/list"]))});const l=K(t=>t.pageStore.pageAction)!=="edit",[k,h]=r.useState(0),P=K(t=>t.dataStore.provinces),p=localStorage.getItem(De),f=p?JSON.parse(p).role:null,[H,Z]=r.useState([]),Q=[{to:"/apps/customer/list",label:"ลูกค้า"},{label:l?"ข้อมูล":"แก้ไข",isCurrent:!0}];f!="admin"&&f!=="business_unit"&&l===!1&&T("/"),_||T("/apps/customer/list");const[J,V]=r.useState(!1),n=t=>{Ce([t]),V(!1)},w=K(t=>t.dataStore.customer),[D,Oe]=r.useState([]),[de,ce]=r.useState([]),[pe,me]=r.useState([]),[ue,B]=r.useState([]),[he,ee]=r.useState([]),[_e,te]=r.useState([]),[be,fe]=r.useState({shop_credit_level:"",title:"",name:"",citizen_id:"",phone_number:"",phone_number_ref:"",line_id:"",facebook_id:"",email:"",citizen_image_url:"",address:"",id_province:0,id_district:0,id_subdistrict:0,zip_code:"",current_address:"",current_id_province:0,current_id_district:0,current_id_subdistrict:0,current_zip_code:"",work_address:"",work_id_province:0,work_id_district:0,work_id_subdistrict:0,work_zip_code:"",tiktok_id:"",instagram_id:"",credit_level:"",approval_status:"Approved",enabled_line_notify:!1}),[s,Fe]=r.useState({citizen_id:"",name:"",address:"",subdistrict:"",district:"",province:"",zip_code:""}),[W,ie]=r.useState([]),[Y,ae]=r.useState([]),[wt,ge]=r.useState(!1),[ve,j]=r.useState(!1),[ye,xe]=r.useState(!1),{mutate:Ue,isLoading:je}=yt({onSuccess:t=>{const i=t.data;L({id:i==null?void 0:i.id_province,type:"id_province"}),R({id:i==null?void 0:i.id_district,type:"id_district"}),L({id:i==null?void 0:i.current_id_province,type:"current_id_province"}),R({id:i==null?void 0:i.current_id_district,type:"current_id_district"}),L({id:i==null?void 0:i.work_id_province,type:"work_id_province"}),R({id:i==null?void 0:i.work_id_district,type:"work_id_district"}),fe(i),i!=null&&i.citizen_image_url&&ie([{dataURL:i.citizen_image_url}]),i!=null&&i.verification_image_url&&ae([{dataURL:i.verification_image_url}])},onError:t=>{}});r.useEffect(()=>{Ue({data:{id:b||w.id}})},[]);const S=(t,i,o)=>{const c=(z,q)=>{z.forEach(g=>t.setFieldValue(g,null)),q.forEach(g=>g([]))},M={id_province:()=>{L({id:i.value,type:o}),c(["id_district","id_subdistrict"],[B,B])},current_id_province:()=>{L({id:i.value,type:o}),c(["current_id_district","current_id_subdistrict"],[ce,ee])},work_id_province:()=>{L({id:i.value,type:o}),c(["work_id_district","work_id_subdistrict"],[me,te])},id_district:()=>{R({id:i.value,type:o}),c(["id_subdistrict"],[B])},current_id_district:()=>{R({id:i.value,type:o}),c(["current_id_subdistrict"],[ee])},work_id_district:()=>{R({id:i.value,type:o}),c(["work_id_subdistrict"],[te])},id_subdistrict:()=>{t.setFieldValue("zip_code",parseInt(i.zipCode))},current_id_subdistrict:()=>{t.setFieldValue("current_zip_code",parseInt(i.zipCode))},work_id_subdistrict:()=>{t.setFieldValue("work_zip_code",parseInt(i.zipCode))}};M[o]&&M[o]()},{mutateAsync:ze,isLoading:qe}=nt({onSuccess:t=>{Fe(i=>{var o;return{...t.data,zip_code:parseInt((o=t.data)==null?void 0:o.zip_code)}})},onError:t=>{u.fire({icon:"warning",title:"ไม่สามารถอ่านค่ารูปบัตรประชาชนได้",padding:"10px 20px"})}}),{mutate:L}=dt({onSuccess:(t,i)=>{const o=t.data.map(c=>({value:c.id,label:c.name_th}));switch(i.type){case"id_province":Oe(o);break;case"current_id_province":ce(o);break;case"work_id_province":me(o);break}},onError:t=>{}}),{mutate:R}=ct({onSuccess:(t,i)=>{const o=t.data.map(c=>({value:c.id,label:c.name_th,zipCode:c.zip_code}));switch(i.type){case"id_district":B(o);break;case"current_id_district":ee(o);break;case"work_id_district":te(o);break}},onError:t=>{}}),{mutateAsync:Ne,isLoading:ke}=ot({onSuccess:t=>{},onError:t=>{}}),{mutate:we,isLoading:re}=xt({onSuccess:t=>{t.statusCode===200||t.code===200?(u.fire({icon:"success",title:"บันทึกสำเร็จ",padding:"10px 20px"}),setTimeout(()=>{location.reload()},500)):u.fire({icon:"warning",title:t.message,padding:"10px 20px"})}}),{mutate:He}=U(E.shopUpdateCredit,{onSuccess:t=>{t.statusCode===200||t.code===200?u.fire({icon:"success",title:"บันทึกระดับเครดิต (ร้านค้า)สำเร็จ",padding:"10px 20px"}):u.fire({icon:"warning",title:t.message,padding:"10px 20px"})}}),{mutate:Ve,isLoading:We}=U(E.customerSearchProfile,{onSuccess:t=>{t.statusCode===200||t.code===200?(Z(t==null?void 0:t.data),xe(!0)):u.fire({icon:"warning",title:t.message,padding:"10px 20px"})},onError:t=>{u.fire({icon:"warning",title:t.message,padding:"10px 20px"})}}),Ge=r.useCallback(async t=>{var i,o,c,M,z,q;if(!re){const g=[];if((i=W[0])!=null&&i.file)g.push(Ne({data:{file:W[0].file,type:"customer"}}));else{if(t.citizen_image_url===""||t.citizen_image_url===null){u.fire({icon:"warning",title:"ไม่พบข้อมูลรูปบัตรประชาชน",padding:"10px 20px"});return}g.push(Promise.resolve({}))}if((o=Y[0])!=null&&o.file)g.push(Ne({data:{file:Y[0].file,type:"customer"}}));else{if(t.verification_image_url===""||t.verification_image_url===null){u.fire({icon:"warning",title:"ไม่พบข้อมูลรูปภาพยืนยันบุคคล",padding:"10px 20px"});return}g.push(Promise.resolve({}))}let C,O;if(g.length>0){const Ie=await Promise.all(g);C=Ie[0],O=Ie[1]}let F={data:{...t,is_active:!0}};(c=C==null?void 0:C.data)!=null&&c.file_name&&(F.data.citizen_image_url=(M=C==null?void 0:C.data)==null?void 0:M.file_name),(z=O==null?void 0:O.data)!=null&&z.file_name&&(F.data.verification_image_url=(q=O==null?void 0:O.data)==null?void 0:q.file_name),F.data.citizen_image_url.includes("http")&&delete F.data.citizen_image_url,F.data.verification_image_url.includes("http")&&delete F.data.verification_image_url,we(F)}},[we,W,Y]),Ce=async t=>{const i=await Pe(t);ie(i)},Ke=async()=>{ge(!0),await ze({data:{image:W[0].file}}),ge(!1),j(!0)},Be=()=>{L({id:s==null?void 0:s.id_province,type:"id_province"}),R({id:s==null?void 0:s.id_district,type:"id_district"}),fe(t=>({...t,...s,...isNaN(s==null?void 0:s.zip_code)&&{zip_code:" "},citizen_id:t.citizen_id})),j(!1)},Ye=async t=>{const i=await Pe(t);ae(i)},$e=se().shape({title:d().required("กรุณาใส่ข้อมูลให้ครบ"),name:d().required("กรุณาใส่ข้อมูลให้ครบ"),phone_number:d().length(10,"กรุณาใส่ข้อมูลให้ครบ 10 เลข"),citizen_id:d().required("กรุณาใส่ข้อมูลให้ครบ").length(13,"กรุณาใส่ข้อมูลให้ครบ 13 หลัก"),email:d().required("กรุณาใส่ข้อมูลให้ครบ").matches(/^[A-Za-z0-9@._]+$/,"กรุณาใช้ตัวอักษรภาษาอังกฤษ ตัวเลข เครื่องหมายมหัพภาค(.) _ และ @ เท่านั้น").email("กรุณาใส่อีเมลที่ถูกต้อง"),address:d().required("กรุณาใส่ข้อมูลให้ครบ"),id_province:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),id_district:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),id_subdistrict:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),current_address:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),current_id_province:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),current_id_district:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),current_id_subdistrict:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),work_address:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),work_id_province:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),work_id_district:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ"),work_id_subdistrict:d().nullable().required("กรุณาใส่ข้อมูลให้ครบ")}),Xe=t=>a("div",{className:"md:col-span-1 xl:col-span-3 mr-6",children:[e("div",{className:"input-flex-row",children:e("div",{className:"check-container",children:e(m,{label:"รหัสบัตรประชาชน",name:"citizen_id",type:"text",disabled:l,onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},maxLength:13})})}),e("hr",{className:"mt-4"}),e("div",{className:"text-l font-semibold ltr:sm:text-left rtl:sm:text-right text-center mt-4",children:"ข้อมูลส่วนบุคคล"}),a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"คำนำหน้า",id:"title",name:"title",options:mt,placeholder:"กรุณาเลือก",onChange:i=>S(t,i,"title"),isSearchable:!1,disabled:l}),e(m,{require:!0,label:"ชื่อ-นามสกุล",name:"name",type:"text",disabled:l})]}),a("div",{className:"input-flex-row",children:[e(m,{require:!0,label:"เบอร์โทรติดต่อ",name:"phone_number",type:"text",maxLength:10,onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},disabled:l}),e(m,{require:!0,label:"เบอร์โทรอ้างอิง",name:"phone_number_ref",type:"text",maxLength:10,onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},disabled:l})]}),a("div",{className:"input-flex-row",children:[e(m,{label:"Facebook ID",name:"facebook_id",type:"text",disabled:l}),e(m,{label:"Line ID",name:"line_id",type:"text",disabled:l})]}),a("div",{className:"input-flex-row",children:[e(m,{label:"Tiktok ID",name:"tiktok_id",type:"text",disabled:l}),e(m,{label:"Instagram ID",name:"instagram_id",type:"text",disabled:l})]}),a("div",{className:"input-flex-row",children:[e(m,{require:!0,label:"Email",name:"email",type:"text",disabled:l}),e("div",{className:"blank-container"})]}),e("br",{}),e("div",{className:"text-l font-semibold ltr:sm:text-left rtl:sm:text-right text-center mt-4",children:"ข้อมูลที่อยู่"}),Ze(t),e("br",{}),f!="shop"&&e("div",{className:"input-flex-row",children:e(v,{require:!0,label:"รับการแจ้งเตือนค่างวด",id:"enabled_line_notify",name:"enabled_line_notify",options:[{label:"เปิด",value:!0},{label:"ปิด",value:!1}],placeholder:"กรุณาเลือก",isSearchable:!0,disabled:l})}),f=="shop"&&a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"ระดับเครดิต (ร้านค้า)",id:"shop_credit_level",name:"shop_credit_level",options:x,placeholder:"กรุณาเลือก",isSearchable:!0}),e("div",{className:"blank-container"})]})]}),Ze=t=>a(G,{children:[a("div",{className:"mt-6 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[e("div",{className:" border-white-light dark:border-[#1b2e4b] p-5 pt-0",children:e("span",{className:"bg-white dark:bg-black dark:text-white-light w-[15svw] h-[20px] lg:w-[10vw] lg:h-[20px] rounded flex justify-center items-center text-[12px] font-semibold -mt-[10px] ",children:"ที่อยู่ตามบัตรประชาชน"})}),a("div",{className:"px-5 pb-5",children:[e("div",{className:"input-flex-row",children:e(m,{require:!0,label:"ที่อยู่",name:"address",rows:"1",disabled:l,onChange:i=>{t.setFieldValue("address",i.target.value),t.setFieldValue("copyAddress",!1),t.setFieldValue("copyAddressForWork",!1)}})}),a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"จังหวัด",id:"id_province",name:"id_province",options:P,placeholder:"กรุณาเลือก",onChange:i=>{S(t,i,"id_province"),t.setFieldValue("copyAddress",!1),t.setFieldValue("copyAddressForWork",!1)},isSearchable:!1,disabled:l}),e(v,{require:!0,label:"อำเภอ/เขต",id:"id_district",name:"id_district",options:D,placeholder:"กรุณาเลือก",onChange:i=>{S(t,i,"id_district"),t.setFieldValue("copyAddress",!1),t.setFieldValue("copyAddressForWork",!1)},isSearchable:!1,disabled:D.length===0||l})]}),a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"ตำบล/แขวง",id:"id_subdistrict",name:"id_subdistrict",options:ue,placeholder:"กรุณาเลือก",onChange:i=>{S(t,i,"id_subdistrict"),t.setFieldValue("copyAddress",!1),t.setFieldValue("copyAddressForWork",!1)},isSearchable:!1,disabled:ue.length===0||l}),e(m,{label:"รหัสไปรษณีย์",name:"zip_code",rows:"1",disabled:!0})]})]})]}),e("label",{className:"flex cursor-pointer items-center",children:e("br",{})}),a("div",{className:"mt-6 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[e("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0",children:e("span",{className:"bg-white dark:bg-black  dark:text-white-light w-[15svw] h-[20px] lg:w-[8vw] lg:h-[20px] rounded flex justify-center items-center text-[12px] font-semibold -mt-[10px] ",children:"ที่อยู่ปัจจุบัน"})}),a("div",{className:"px-5 pb-5",children:[e("div",{className:"input-flex-row",children:e(m,{require:!0,label:"ที่อยู่",name:"current_address",rows:"1",disabled:l,onChange:i=>{t.setFieldValue("copyAddress",!1),t.setFieldValue("current_address",i.target.value)}})}),a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"จังหวัด",id:"current_id_province",name:"current_id_province",options:P,placeholder:"กรุณาเลือก",onChange:i=>{S(t,i,"current_id_province"),t.setFieldValue("copyAddress",!1)},isSearchable:!1,disabled:l}),e(v,{require:!0,label:"อำเภอ/เขต",id:"current_id_district",name:"current_id_district",options:de,placeholder:"กรุณาเลือก",onChange:i=>{S(t,i,"current_id_district"),t.setFieldValue("copyAddress",!1)},isSearchable:!1,disabled:de.length===0||l})]}),a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"ตำบล/แขวง",id:"current_id_subdistrict",name:"current_id_subdistrict",options:he,placeholder:"กรุณาเลือก",onChange:i=>{S(t,i,"current_id_subdistrict"),t.setFieldValue("copyAddress",!1)},isSearchable:!1,disabled:he.length===0||l}),e(m,{label:"รหัสไปรษณีย์",name:"current_zip_code",rows:"1",disabled:!0})]})]})]}),e("label",{className:"flex cursor-pointer items-center",children:e("br",{})}),a("div",{className:"mt-6 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[e("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0",children:e("span",{className:"bg-white dark:bg-black  dark:text-white-light w-[15svw] h-[20px] lg:w-[8vw] lg:h-[20px] rounded flex justify-center items-center text-[12px] font-semibold -mt-[10px] ",children:"ที่อยู่ที่ทำงาน"})}),a("div",{className:"px-5 pb-5",children:[e("div",{className:"input-flex-row",children:e(m,{require:!0,label:"ที่อยู่",name:"work_address",rows:"1",disabled:l,onChange:i=>{t.setFieldValue("copyAddressForWork",!1),t.setFieldValue("work_address",i.target.value)}})}),a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"จังหวัด",id:"work_id_province",name:"work_id_province",options:P,placeholder:"กรุณาเลือก",onChange:i=>{S(t,i,"work_id_province"),t.setFieldValue("copyAddressForWork",!1)},isSearchable:!1,disabled:l}),e(v,{require:!0,label:"อำเภอ/เขต",id:"work_id_district",name:"work_id_district",options:pe,placeholder:"กรุณาเลือก",onChange:i=>{t.setFieldValue("copyAddressForWork",!1),S(t,i,"work_id_district")},isSearchable:!1,disabled:pe.length===0||l})]}),a("div",{className:"input-flex-row",children:[e(v,{require:!0,label:"ตำบล/แขวง",id:"work_id_subdistrict",name:"work_id_subdistrict",options:_e,placeholder:"กรุณาเลือก",onChange:i=>{t.setFieldValue("copyAddressForWork",!1),S(t,i,"work_id_subdistrict")},isSearchable:!1,disabled:_e.length===0||l}),e(m,{label:"รหัสไปรษณีย์",name:"work_zip_code",rows:"1",disabled:!0})]})]})]})]});if(je)return e("div",{children:"Loading..."});const Qe=()=>a("div",{className:"md:col-span-1 xl:col-span-1 pt-5",children:[e("div",{className:"upload-container",children:a("div",{className:"custom-file-container","data-upload-id":"myFirstImage",children:[a("div",{className:"label-container",children:[a("label",{children:["รูปบัตรประชาชน ",e("span",{className:"text-rose-600",children:"*"})]}),!l&&e("button",{type:"button",className:"custom-file-container__image-clear",title:"Clear Image",onClick:()=>{ie([])},children:"×"})]}),e("label",{className:"custom-file-container__custom-file hidden"}),e("input",{type:"file",className:"custom-file-container__custom-file__custom-file-input hidden",accept:"image/*"}),e("input",{type:"hidden",name:"MAX_FILE_SIZE1",value:"10485760"}),e(Te,{value:W,onChange:Ce,children:({imageList:t,onImageUpload:i,onImageRemoveAll:o,onImageUpdate:c,onImageRemove:M,isDragging:z,dragProps:q})=>a("div",{className:"upload__image-wrapper",children:[!l&&a(G,{children:[e("button",{className:"custom-file-container__custom-file__custom-file-control",onClick:i,type:"button",children:"เลือกไฟล์..."}),e("div",{style:{textAlign:"right"},children:e("button",{type:"button",className:"btn btn-primary",onClick:()=>V(!0),style:{display:"inline-block"},children:"ถ่ายรูป"})})]})," ",t.map((g,C)=>e("div",{className:"custom-file-container__image-preview relative",children:e("img",{src:g.dataURL,alt:"img",className:l?"m-auto":"m-auto mt-10"})},C)),!l&&t.length>0&&e("button",{type:"button",className:"btn btn-success mt-2 w-full border-0 uppercase shadow-[0_10px_20px_-10px_rgba(67,97,238,0.44)]",onClick:Ke,children:"ตรวจสอบบัตรประชาชน"})]})})]})}),e("div",{className:"upload-container mt-10",children:a("div",{className:"custom-file-container","data-upload-id":"myFirstImage",children:[a("div",{className:"label-container",children:[a("label",{children:["รูปยืนยันบุคคล ",e("span",{className:"text-rose-600",children:"*"})]}),!l&&e("button",{type:"button",className:"custom-file-container__image-clear",title:"Clear Image",onClick:()=>{ae([])},children:"×"})]}),e("label",{className:"custom-file-container__custom-file hidden"}),e("input",{type:"file",className:"custom-file-container__custom-file__custom-file-input hidden",accept:"image/*"}),e("input",{type:"hidden",name:"MAX_FILE_SIZE2",value:"10485760"}),e(Te,{value:Y,onChange:Ye,children:({imageList:t,onImageUpload:i,onImageRemoveAll:o,onImageUpdate:c,onImageRemove:M,isDragging:z,dragProps:q})=>a("div",{className:"upload__image-wrapper",children:[!l&&e("button",{className:"custom-file-container__custom-file__custom-file-control",onClick:i,type:"button",children:"เลือกไฟล์..."})," ",t.map((g,C)=>e("div",{className:"custom-file-container__image-preview relative",children:e("img",{src:g.dataURL,alt:"img",className:l?"m-auto":"m-auto mt-10"})},C))]})})]})})]}),Je=()=>{y(st("edit")),h(0)},Se=()=>{T("/apps/customer/credit/"+b)},et=()=>{Ve({data:{uuid:b}})};return e(G,{children:J?e(vt,{onSubmit:n,onClose:()=>V(!1)}):a("div",{className:"flex flex-col gap-2.5",children:[qe||We&&e(ut,{}),a("div",{className:"flex items-center justify-between flex-wrap",children:[e(ht,{items:Q}),a("div",{className:"flex",children:[l&&f!=="shop"&&a(G,{children:[e("a",{className:"cursor-pointer btn btn-warning mr-1",onClick:()=>et(),children:"ตรวจสอบเครดิต"}),a("a",{className:"cursor-pointer btn btn-primary mr-1",onClick:()=>Se(),children:[e($,{className:"w-4.5 h-4.5"}),"   สัญญาที่ดำเนินการ"]}),a("a",{className:"cursor-pointer btn btn-info mr-1",onClick:()=>Je(),children:[e($,{className:"w-4.5 h-4.5"}),"   แก้ไข"]})]}),l&&f==="shop"&&e(G,{children:a("a",{className:"hover:text-info cursor-pointer btn btn-primary mr-1",onClick:()=>Se(),children:[e($,{className:"w-4.5 h-4.5"}),"   สัญญาที่ดำเนินการ"]})})]})]}),e("div",{children:a(A.Group,{selectedIndex:k,children:[a(A.List,{className:"mt-3 flex flex-wrap border-b border-white-light dark:border-[#191e3a] bg-white",children:[e(A,{as:r.Fragment,children:({selected:t})=>e("button",{onClick:()=>h(0),className:`${t?"!border-white-light !border-b-white  text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black ":""} dark:hover:border-b-black' -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,children:"บัญชีลูกค้า"})}),f!=="shop"&&e(A,{as:r.Fragment,children:({selected:t})=>e("button",{onClick:()=>h(1),className:`${t?"!border-white-light !border-b-white  text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black ":""} dark:hover:border-b-black' -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,children:"เครดิตลูกค้า"})}),f!=="shop"&&e(A,{as:r.Fragment,children:({selected:t})=>e("button",{onClick:()=>h(2),className:`${t?"!border-white-light !border-b-white  text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black ":""} dark:hover:border-b-black' -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,children:"บันทึกข้อความ"})})]}),a(A.Panels,{children:[a(A.Panel,{children:[e("div",{className:"panel px-6 flex-1 py-6 rtl:xl:ml-6",children:e(ne,{initialValues:be,onSubmit:Ge,enableReinitialize:!0,autoComplete:"off",validationSchema:$e,children:t=>a(oe,{className:"space-y-5 dark:text-white custom-select",children:[e("div",{className:"text-lg font-semibold ltr:sm:text-left rtl:sm:text-right text-center",children:"บัญชีลูกค้า"}),a("div",{className:"grid md:grid-rows-1 xl:grid-cols-4 gap-2 pb-5",children:[Xe(t),Qe()]}),!l&&a("button",{type:"submit",className:"btn !mt-6 w-full border-0 btn-primary",children:[(ke||re)&&e("span",{className:"animate-spin border-2 border-white border-l-transparent rounded-full w-5 h-5 ltr:mr-4 rtl:ml-4 inline-block align-middle"}),l?"ข้อมูล":"แก้ไข"]}),f=="shop"&&a("button",{className:"btn !mt-6 w-full border-0 btn-primary",type:"button",onClick:()=>{He({data:{shop_credit_level:t.values.shop_credit_level,id_customer:be.uuid}})},children:[(ke||re)&&e("span",{className:"animate-spin border-2 border-white border-l-transparent rounded-full w-5 h-5 ltr:mr-4 rtl:ml-4 inline-block align-middle"}),"แก้ไขระดับเครดิต (ร้านค้า)"]})]})})}),e(N,{appear:!0,show:ve,as:r.Fragment,children:a(I,{as:"div",open:ve,onClose:()=>j(!1),className:"relative z-[51]",children:[e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(I.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>j(!1),children:e(X,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:"ข้อมูลบัตรประชาชน"}),a("div",{className:"px-5 pt-3 pb-5",children:[a("div",{className:"flex flex-wrap justify-start",children:[e("div",{className:"w-full",children:a("p",{children:["เลขบัตรประชาชน:",s==null?void 0:s.citizen_id]})}),e("div",{className:"w-full",children:a("p",{children:["ชื่อ-นามสกุล: ",(Ee=s.name)==null?void 0:Ee.trim()]})}),e("div",{className:"w-full",children:a("p",{children:[s!=null&&s.address?`ที่อยู่: ${s==null?void 0:s.address} `:" ",s!=null&&s.subdistrict?`ตำบล${s==null?void 0:s.subdistrict} `:" ",s!=null&&s.district?`อำเภอ${s==null?void 0:s.district} `:" ",s!=null&&s.province?`จังหวัด${s==null?void 0:s.province} `:" ",isNaN(s==null?void 0:s.zip_code)?" ":s==null?void 0:s.zip_code]})})]}),a("div",{className:"flex justify-end items-center mt-8",children:[e("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>{j(!1)},children:"ยกเลิก"}),e("button",{type:"submit",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:Be,children:"ยืนยัน"})]})]})]})})})})]})})]}),e(A.Panel,{children:e(Nt,{})}),e(A.Panel,{children:e(kt,{})})]})]})}),e(N,{appear:!0,show:ye,as:r.Fragment,children:a(I,{as:"div",open:ye,onClose:()=>xe(!1),className:"relative z-[51]",children:[e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(N.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(I.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>j(!1),children:e(X,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:"ข้อมูลเครดิต"}),e("div",{className:"px-5 pt-3 pb-5 space-y-2",children:H.length===0?e("p",{children:"ไม่มีข้อมูลผ่อนชำระ"}):H.map((t,i)=>a("div",{className:"flex justify-between items-center p-3 border rounded-md bg-[#f9f9f9] dark:bg-[#1e2a3a]",children:[e("div",{children:e("p",{className:"font-medium",children:t==null?void 0:t.shopName})}),e("span",{className:"text-sm font-semibold ",children:t==null?void 0:t.display})]},i))})]})})})})]})})]})})};export{li as default};
