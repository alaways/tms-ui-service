import{ak as K,a as W,u as Y,r as a,s as B,c as v,j as s,f as i,L as z,as as y,g as I}from"./index-a90aa29c.js";import{l as P}from"./lodash-f7ec5310.js";import{Q as $}from"./index-2f30bf27.js";import{T as R}from"./tippy-react.esm-150a8dd6.js";import{S as q}from"./react-select.esm-b46d9623.js";import{I as X}from"./IconEye-eb8ead5b.js";import{I as Q}from"./IconPlus-4c7e79c8.js";import{I as Z}from"./IconEdit-bf2b08f0.js";/* empty css              */import"./floating-ui.dom-0aeb9e8a.js";import"./createSuper-98fcd92d.js";const J="admin",de=()=>{const{t}=K(),m=W(),g=Y(),p=localStorage.getItem(J),A=p?JSON.parse(p).role:null,_=p?JSON.parse(p).id_shop:null;a.useEffect(()=>{m(B(t("asset_list")))});const[C,D]=a.useState([]),[c,U]=a.useState(1),E=[10,20,30,50,100],[n,N]=a.useState(E[0]),[O,x]=a.useState([]),[L,M]=a.useState(0),[b,k]=a.useState(!1);a.useEffect(()=>{k(!0)},[]);const[l,H]=a.useState(""),[S,w]=a.useState(""),[r,j]=a.useState(null),{mutate:d}=v(I.assetFindAll,{onSuccess:e=>{D(e.data.list),M(e.data.total)},onError:()=>{console.error("Failed to fetch asset type data")}}),{mutate:f}=v(I.shopFindAll,{onSuccess:e=>{x(e.data.list.map(o=>({value:o.id,label:o.name})))},onError:()=>{console.error("Failed to fetch asset type data")}}),T=e=>{m(y(e)),g("/apps/asset/view/"+e.id)},G=e=>{m(y(e)),g("/apps/asset/edit/"+e.id)};a.useEffect(()=>{if(!b)return;let e={data:{page:c,page_size:n,query:l}};r&&(e.data.id_shop=r.value),d(e)},[c]),a.useEffect(()=>{if(!b)return;let e={data:{page:1,page_size:n,query:l}};r&&(e.data.id_shop=r.value),d(e)},[n]);const h=a.useMemo(()=>P.debounce(e=>{let o={data:{page:1,page_size:n,query:e}};r&&(o.data.id_shop=r.value),d(o)},500),[d,n,r]);a.useEffect(()=>(h(l),()=>{h.cancel()}),[l,h]);const u=a.useMemo(()=>P.debounce(e=>{_||f({data:{page:1,page_size:10,query:e}})},500),[f]);a.useEffect(()=>(u(S),()=>{u.cancel()}),[S,u]);const V=e=>{w(e)};return s("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:i("div",{className:"invoice-table ",children:[i("div",{className:"mb-4.5 px-5 flex md:items-center md:flex-row flex-col gap-5",children:[s("div",{className:"flex items-center gap-2",children:i(z,{to:"/apps/asset/add",className:"btn btn-primary gap-2",children:[s(Q,{}),t("add_asset")]})}),i("div",{className:"flex flex-column ltr:ml-auto rtl:mr-auto",children:[!_&&s("div",{className:"flex-1",children:s(q,{placeholder:"ร้านค้า",className:"pr-6 z-10 w-[200px]",options:[{value:null,label:t("all")},...O],isSearchable:!0,onInputChange:V,onChange:e=>{j(e)}})}),s("input",{type:"text",className:"form-input w-auto",placeholder:t("search_text"),value:l,onChange:e=>H(e.target.value)})]})]}),s("div",{className:"datatables pagination-padding",children:s($,{className:"whitespace-nowrap table-hover invoice-table",records:C,columns:[{accessor:"index",title:t("order"),textAlignment:"center",render:(e,o)=>o+1+(c-1)*n},{accessor:"shopo",title:t("shop"),textAlignment:"left",sortable:!0,hidden:A!=="admin"&&A!=="business_unit",render:e=>{var o;return s("div",{children:((o=e.shop)==null?void 0:o.name)||"-"})}},{accessor:"asset_type",title:t("asset_type"),textAlignment:"left",sortable:!1,render:({asset_type:e})=>s("div",{children:(e==null?void 0:e.name)||"-"})},{accessor:"name",title:t("asset_model_name"),textAlignment:"left",sortable:!0,render:e=>s("a",{className:"flex cursor-pointer active",onClick:()=>T(e),children:s("div",{children:e.name||"-"})})},{accessor:"capacity",title:t("asset_capacity"),textAlignment:"left",sortable:!1},{accessor:"serial_number",title:t("asset_serial_number"),textAlignment:"left",sortable:!1},{accessor:"imei",title:t("asset_imei"),textAlignment:"left",sortable:!1},{accessor:"price",title:t("price"),textAlignment:"right",sortable:!0,render:({price:e})=>s("div",{children:e?e.toLocaleString("en-US"):"-"})},{accessor:"is_active",title:t("active_status"),textAlignment:"center",sortable:!0,render:({is_active:e})=>i("span",{className:`badge ${e?"badge-outline-success":"badge-outline-danger"}`,children:[t(e?"open":"close"),"  // 已有 key"]})},{accessor:"action",title:t("actions"),textAlignment:"center",sortable:!1,render:e=>i("div",{className:"flex gap-4 items-center w-max mx-auto",children:[s(R,{content:t("view_data"),theme:"Primary",children:s("a",{className:"flex cursor-pointer active",onClick:()=>T(e),children:s(X,{})})}),!_&&s(R,{content:t("edit"),theme:"Primary",children:s("a",{className:"flex cursor-pointer active",onClick:()=>G(e),children:s(Z,{className:"w-4.5 h-4.5"})})})]})}],page:c,highlightOnHover:!0,totalRecords:L,recordsPerPage:n,onPageChange:e=>U(e),recordsPerPageOptions:E,onRecordsPerPageChange:N,paginationText:({from:e,to:o,totalRecords:F})=>`${t("showing")} ${e} ${t("to")} ${o} ${t("of")} ${F} ${t("total_pages")}`})})]})})};export{de as default};
