import{r as n,c as r,f as s,F as L,j as t,g as c}from"./index-a90aa29c.js";import{F as Y,a as v}from"./formik.esm-c4fd04ca.js";import{S as M}from"./SelectField-917481a8.js";import{d as i,b as R,a as T,t as h,D as j}from"./buddhistEra-a2d9672b.js";import{n as o}from"./formatNumeric-862380d6.js";import{t as C}from"./constant-e85f1578.js";import{S as E}from"./sweetalert2.all-ca2d1030.js";import{P}from"./preLoading-b2445d9d.js";import"./react-select.esm-b46d9623.js";import"./createSuper-98fcd92d.js";import"./floating-ui.dom-0aeb9e8a.js";import"./lodash-f7ec5310.js";import"./index-8d8bdff8.js";const Z=()=>{i.extend(R),i.locale(T);const d=E.mixin(C),_={total_price_total:0,total_down_payment:0,total_pay_amount:0,total_pay_penalty:0,total_pay_unlock:0,total_discount:0,total_summary1:0,total_asset_price:0,total_commission_price:0,total_benefit:0,total_fee:0,total_summary2:0,total_unpaid:0,total_profit:0},p={on_process:0,closed:0,refund:0,tracking:0,unabled_contract:0,report_to_police:0,bad_debt:0,cancel:0,total:0},[m,u]=n.useState(Array.from({length:13},(l,a)=>({month:a,..._}))),[b,f]=n.useState(Array.from({length:13},(l,a)=>({month:a,...p}))),[N,y]=n.useState([]),g={...h,lang:{...h.lang,fieldDateFormat:"BBBB-MM-DD",fieldYearFormat:"BBBB",fieldDateTimeFormat:"BBBB-MM-DD HH:mm:ss",yearFormat:"BBBB",cellYearFormat:"BBBB"}},x=(l,a,e)=>{const D=a.locale("en").format("YYYY");l.setFieldValue("date",D)},w=l=>{const a=l==null?void 0:l.date,e=l.id_business_unit;e==null?d.fire({icon:"warning",title:"กรุณาเลือกหน่วยธุรกิจเพื่อค้นหา",padding:"10px 20px"}):a==null?d.fire({icon:"warning",title:"กรุณาเลือกปีเพื่อค้นหา",padding:"10px 20px"}):(F({data:{id_business_unit:e,year:+a}}),k({data:{id_business_unit:e,year:+a}}))},{mutate:B}=r(c.businessUnitFindAll,{onSuccess:l=>{y(l.data.list.map(a=>({value:a.id,label:a.name})))},onError:()=>{}}),{mutate:F,isLoading:S}=r(c.dashboardRepord+"?tab=tab_1",{onSuccess:l=>{if(l.message){const a=l.data.map(e=>({month:e.month,total_price_total:e.total_price_total,total_down_payment:e.total_down_payment,total_pay_amount:e.total_pay_amount,total_pay_penalty:e.total_pay_penalty,total_pay_unlock:e.total_pay_unlock,total_discount:e.total_discount,total_summary1:e.total_summary1,total_asset_price:e.total_asset_price,total_commission_price:e.total_commission_price,total_benefit:e.total_benefit,total_fee:e.total_fee,total_summary2:e.total_summary2,total_unpaid:e.total_unpaid,total_profit:e.total_profit}));u(a)}}}),{mutate:k,isLoading:A}=r(c.dashboardRepord+"?tab=tab_2",{onSuccess:l=>{if(l.message){const a=l.data.map(e=>({month:e.month,on_process:e.on_process,closed:e.closed,refund:e.refund,tracking:e.tracking,unabled_contract:e.unabled_contract,report_to_police:e.report_to_police,bad_debt:e.bad_debt,cancel:e.cancel,total:e.total}));f(a)}}});return n.useEffect(()=>{B({})},[]),s(L,{children:[S||A&&t(P,{}),t(Y,{initialValues:{id_business_unt:"",year:""},onSubmit:w,children:l=>s(v,{className:"flex flex-col gap-6",children:[t("div",{className:"flex flex-row flex-wrap justify-end items-center gap-2 w-full",children:s("div",{className:"flex flex-row gap-5 items-center",children:[t(j,{onChange:(a,e)=>x(l,a),name:"date",picker:"year",className:"w-[200px]",locale:g}),t(M,{id:"bu",label:"",className:"z-10",name:"id_business_unit",options:N,isSearchable:!0,isMulti:!0,onChange:a=>{}}),t("button",{type:"submit",className:"text-white bg-[#002A41] rounded-lg py-2 px-4",children:"ค้นหา"})]})}),s("div",{className:"flex flex-col gap-1",children:[t("h1",{className:"font-semibold text-xl",children:"สรุปยอดแยกเดือน"}),t("div",{className:"bg-white rounded-xl ",style:{overflowY:"auto",display:"block"},children:s("table",{className:"income",children:[s("tr",{className:"h-[40px]",children:[t("th",{colSpan:2,className:"border-b border-white bg-[#002A41] text-white"}),t("th",{colSpan:7,className:"border-r border-b border-white bg-[#002A41] text-white",children:"รายรับ"}),t("th",{colSpan:4,className:"border border-white bg-[#002A41] text-white",children:"ต้นทุน"}),t("th",{colSpan:2,className:"border border-b-none border-white bg-[#002A41] text-white",children:"สรุป"})]}),s("tr",{className:"second bg-[#F0F2F7] h-[40px] sec",children:[t("th",{children:"เดือน"}),t("th",{children:"ยอดสินเชื่อ"}),t("th",{children:"ยอดดาวน์"}),t("th",{children:"ยอดค่างวดที่จ่ายแล้ว"}),t("th",{children:"ยอดค่าดำเนินการล่าช้าที่จ่ายแล้ว"}),t("th",{children:"ยอดค่าปลดล็อคที่จ่ายแล้ว"}),t("th",{children:"ส่วนลด"}),t("th",{children:"ค่าทำสัญญา"}),t("th",{children:"รวม"}),t("th",{children:"ค่าเครื่อง"}),t("th",{children:"ค่าคอม"}),t("th",{children:"ค่าผลตอบแทนพิเศษ"}),t("th",{children:"รวม"}),t("th",{children:"ยอดค้างจ่าย"}),t("th",{children:"กำไร/ขาดทุน"})]}),t("tbody",{children:m.map((a,e)=>s("tr",{children:[t("td",{className:"",children:a.month===12?"รวม":a.month+1}),t("td",{className:"",children:o(a.total_price_total)}),t("td",{className:"",children:o(a.total_down_payment)}),t("td",{className:"",children:o(a.total_pay_amount)}),t("td",{className:"",children:o(a.total_pay_penalty)}),t("td",{className:"",children:o(a.total_pay_unlock)}),t("td",{className:"",children:o(a.total_discount)}),t("td",{className:"",children:o(a.total_fee)}),t("td",{className:"",children:o(a.total_summary1)}),t("td",{className:"",children:o(a.total_asset_price)}),t("td",{className:"",children:o(a.total_commission_price)}),t("td",{className:"",children:o(a.total_benefit)}),t("td",{className:"",children:o(a.total_summary2)}),t("td",{className:"",children:o(a.total_unpaid)}),t("td",{className:"",children:o(a.total_profit)})]},e))})]})})]}),s("div",{className:"flex flex-col gap-1",children:[t("h1",{className:"font-semibold text-xl",children:"สรุปสถานะแยกเดือน"}),t("div",{className:"bg-white rounded-xl ",style:{overflowY:"auto",display:"block"},children:s("table",{className:"income",children:[t("tr",{className:"h-[50px]",children:t("th",{colSpan:10,className:"border border-b-none border-white bg-[#002A41] text-white",children:"จำนวนสินเชื่อ"})}),s("tr",{className:"second bg-[#F0F2F7] h-[40px] sec",children:[t("th",{children:"เดือน"}),t("th",{children:"กำลังผ่อน"}),t("th",{children:"ปิดยอด"}),t("th",{children:"คืนเงิน"}),t("th",{children:"ติดตาม"}),t("th",{children:"ติดต่อไม่ได้"}),t("th",{children:"แจ้งความ"}),t("th",{children:"หนี้สิน"}),t("th",{children:"ยกเลิก"}),t("th",{children:"รวม"})]}),t("tbody",{children:b.map((a,e)=>s("tr",{children:[t("td",{className:"",children:a.month===12?"รวม":a.month+1}),t("td",{className:"",children:a.on_process}),t("td",{className:"",children:a.closed}),t("td",{className:"",children:a.refund}),t("td",{className:"",children:a.tracking}),t("td",{className:"",children:a.unabled_contract}),t("td",{className:"",children:a.report_to_police}),t("td",{className:"",children:a.bad_debt}),t("td",{className:"",children:a.cancel}),t("td",{className:"",children:a.total})]},e))})]})})]})]})})]})};export{Z as default};
