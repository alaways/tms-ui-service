import{u as $,r as s,c as d,f as n,j as t,N as B,F as D,g as u}from"./index-a90aa29c.js";import{F as G,a as Q}from"./formik.esm-c4fd04ca.js";import{S as g}from"./SelectField-917481a8.js";import{I as W}from"./InputField-d7971719.js";import{t as O,l as X}from"./constant-e85f1578.js";import{D as Z}from"./DateRangeAntd-92e3cf4d.js";import{P as y}from"./config-8de56c22.js";import{Q as H}from"./index-2f30bf27.js";import{a as v}from"./formatDate-4e046265.js";import{I as J}from"./IconRefresh-fed8c080.js";import{I as K}from"./IconEye-eb8ead5b.js";import{I as Y}from"./IconX-54a3093e.js";import{P as ee}from"./preLoading-b2445d9d.js";import{S as te}from"./sweetalert2.all-ca2d1030.js";import{n as ae}from"./formatNumeric-862380d6.js";import{q as f,_ as N}from"./transition-d4ca4cfa.js";import"./react-select.esm-b46d9623.js";import"./createSuper-98fcd92d.js";import"./floating-ui.dom-0aeb9e8a.js";import"./lodash-f7ec5310.js";import"./buddhistEra-a2d9672b.js";import"./index-8d8bdff8.js";import"./keyboard-f171a3e5.js";import"./use-is-mounted-22b05dcc.js";import"./bugs-a60d55c3.js";const se={start_at:"",end_at:"",id_business_unit:null,query:"",status:"",payment_method:""},Ce=()=>{const _=$(),[b,x]=s.useState([]),[ne,w]=s.useState(se),[o,p]=s.useState(1),[l,S]=s.useState(y[0]),[F,k]=s.useState(0);s.useState(1);const P=te.mixin(O),[A,E]=s.useState([]),[h,c]=s.useState(!1),[r,C]=s.useState({p_reference:"",responseCode:"",responseMesg:"",bankRefNo:""}),{mutate:I}=d(u.businessUnitFindAll,{onSuccess:e=>{E(e.data.list.map(a=>({value:a==null?void 0:a.id,label:a==null?void 0:a.name})))},onError:()=>{console.error("Failed to fetch bu data")}}),{mutate:i,isLoading:L}=d(u.bblFindALL,{onSuccess:e=>{x(e.data.list),k(e.data.total)},onError:()=>{console.error("Failed to fetch bu data")}}),{mutate:T,isLoading:R}=d(u.bblInquiry,{onSuccess:e=>{C(e==null?void 0:e.data)},onError:()=>{console.error("Failed to fetch bu data")}}),{mutate:j,isLoading:q}=d(u.bblInquiry,{onSuccess:e=>{c(!1),P.fire({icon:"success",title:"สำเร็จ",padding:"10px 20px"}),i({})},onError:()=>{console.error("Failed to fetch bu data")}}),z=()=>{},U=(e=null)=>{T({data:{reference:e.p_reference}}),c(!0)},V=(e=null)=>{_("/apps/finance/transfer/view/"+e.uuid)},M=async(e,a)=>{};return s.useEffect(()=>{I({}),i({data:{page:1,page_size:l}})},[]),s.useEffect(()=>{i({data:{page:o,page_size:l}})},[o]),s.useEffect(()=>{i({data:{page:1,page_size:l}})},[l]),n("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:[(L||R||q)&&t(ee,{}),t("div",{className:"invoice-table",children:t("div",{className:"ml-7 my-5 text-lg font-semibold ltr:sm:text-left rtl:sm:text-right text-center flex flex-row justify-between",children:"ประวัติการโอนเงิน"})}),t("div",{className:"mb-4.5 px-5 md:items-center md:flex-row flex-col gap-5",children:t(G,{initialValues:{},onSubmit:z,onReset:()=>{w({start_at:"",end_at:"",id_business_unit:null,query:"",status:"",payment_method:""}),p(1),x([])},children:({setFieldValue:e,handleReset:a,values:m})=>n(Q,{className:"flex flex-col flex-auto gap-2",children:[t(B,{to:"/apps/finance/transfer/add",className:"btn btn-primary gap-2 w-28 mb-2",children:"โอนเงิน"}),n("div",{className:"flex flex-col sm:flex-row md:flex-row gap-5",children:[t(g,{zIndex:"z-9",id:"id_business_unit",label:"หน่วยธุรกิจ",name:"id_business_unit",placeholder:"เลือกหน่วยธุรกิจ",options:A}),t(g,{zIndex:"z-9",id:"status",label:"สถานะการชำระเงิน",name:"status",placeholder:"กรุณาเลือก",options:X})]}),n("div",{className:"flex flex-col sm:flex-row md:flex-row gap-5",children:[t(W,{label:"ค้นหา",placeholder:"ค้นหา",name:"query",type:"text"}),t(Z,{label:"วันที่ชำระ",name:"date_at"}),t("button",{type:"submit",className:"btn btn-primary gap-2 mt-5",children:"ค้นหา"}),t("button",{type:"reset",className:"btn btn-info gap-2 mt-5",onClick:()=>{a()},children:"ล้างค่า"}),t("div",{className:"flex flex-col pt-5",children:t("button",{type:"button",className:"btn btn-success gap-2 w-full h-[40px]",onClick:()=>M(`payment_history_${new Date().toLocaleString()}`),children:"Export"})})]})]})})}),t("div",{className:"datatables pagination-padding",children:b.length===0?t("div",{className:"text-center text-gray-500",children:"ไม่พบข้อมูล"}):t(H,{className:"whitespace-nowrap table-hover invoice-table",records:b,columns:[{accessor:"id",title:"ลำดับ",textAlignment:"center",sortable:!1,render:(e,a)=>(e==null?void 0:e.isTotalRow)?null:t("div",{children:a+1+(o-1)*l})},{accessor:"company",title:"โอนจาก",textAlignment:"center",sortable:!1,render:(e,a)=>e==null?void 0:e.company},{accessor:"shop_name",title:"ร้านค้า",textAlignment:"center",sortable:!1,render:(e,a)=>e==null?void 0:e.shop_name},{accessor:"bank_name",title:"ธนาคาร",textAlignment:"center",sortable:!1,render:(e,a)=>e==null?void 0:e.bank_name},{accessor:"receiverValueType",title:"ประเภทการโอน",textAlignment:"center",sortable:!1,render:(e,a)=>e==null?void 0:e.receiverValueType},{accessor:"receiverName",title:"ชื่อผู้รับ",textAlignment:"center",sortable:!1,render:(e,a)=>e==null?void 0:e.receiverName},{accessor:"receiverValue",title:"หมายเลขบัญชี",textAlignment:"center",sortable:!1,render:(e,a)=>e==null?void 0:e.receiverValue},{accessor:"amount",title:"จำนวนเงิน",textAlignment:"center",sortable:!1,render:(e,a)=>t("p",{children:ae(e==null?void 0:e.amount)})},{accessor:"status",title:"สถานะการชำระเงิน",textAlignment:"center",sortable:!1,render:({status:e,isTotalRow:a})=>a?null:t("div",{className:"flex text-center justify-center font-normal",children:t("div",{className:`badge ${e==="complete"?"badge-outline-success":e==="pending"?"badge-outline-warning":e==="wait_to_update"?"badge-outline-secondary":"badge-outline-danger"}`,children:e==="complete"?"สำเร็จ":e==="pending"?"รอชำระ":e==="wait_to_update"?"รอตรวจสอบ":"ไม่สำเร็จ"})})},{accessor:"payed_at",title:"วันที่ชำระ",textAlignment:"center",sortable:!1,render:(e,a)=>v(e==null?void 0:e.payed_at)},{accessor:"created_at",title:"วันที่ดำเนินการ",textAlignment:"center",sortable:!1,render:(e,a)=>v(e==null?void 0:e.created_at)},{accessor:"action",title:"Actions",sortable:!1,textAlignment:"center",render:e=>e.isTotalRow?null:t("div",{className:"flex gap-4 items-center w-max mx-auto",children:n(D,{children:[((e==null?void 0:e.status)=="pending"||(e==null?void 0:e.status)=="wait_to_update")&&t("div",{className:"bg-[#E5E4E2] w-8 h-8 rounded-full flex items-center justify-center text-white",children:t("a",{className:"flex cursor-pointer active",onClick:()=>U(e),children:t(J,{className:"w-4.5 h-4.5"})})}),t("div",{className:"bg-[#E5E4E2] w-8 h-8 rounded-full flex items-center justify-center text-white",children:t("a",{className:"flex cursor-pointer active",onClick:()=>V(e),children:t(K,{className:"w-4.5 h-4.5"})})})]})})}],page:o,totalRecords:F,recordsPerPage:l,recordsPerPageOptions:y,onPageChange:e=>p(e),onRecordsPerPageChange:e=>{p(1),S(e)},paginationText:({from:e,to:a,totalRecords:m})=>`โชว์ ${e} ถึง ${a} ของ ${m} หน้าทั้งหมด`})}),t(f,{appear:!0,show:h,as:s.Fragment,children:n(N,{as:"div",open:h,onClose:()=>{c(!1)},className:"relative z-[51]",children:[t(f.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t("div",{className:"fixed inset-0 bg-[black]/60"})}),t("div",{className:"fixed inset-0 overflow-y-auto",children:t("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:t(f.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:n(N.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",style:{maxWidth:"40rem"},children:[t("button",{type:"button",onClick:()=>{c(!1)},className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",children:t(Y,{})}),t("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px] text-center",children:"ตรวจสอบข้อมูล"}),t("div",{className:"p-5",children:n("div",{className:"p-5",children:[n("div",{className:"mb-5 space-y-1",children:[n("div",{className:"flex items-center justify-between",children:[t("p",{className:"text-[#515365] font-semibold",children:"สถานะการโอนเงิน "}),t("p",{className:"text-base",children:t("span",{className:"font-semibold",children:(r==null?void 0:r.responseMesg)??""})})]}),n("div",{className:"flex items-center justify-between",children:[t("p",{className:"text-[#515365] font-semibold",children:"BBL transaction"}),t("p",{className:"text-base",children:t("span",{className:"font-semibold",children:(r==null?void 0:r.bankRefNo)??"-"})})]})]}),t("div",{className:"text-center px-2 flex justify-around",children:r!=null&&r.bankRefNo?t("button",{type:"button",className:"btn btn-success",onClick:()=>{j({data:{reference:r.p_reference,callback:!0}})},children:"ปรับปรุงข้อมูล"}):t("button",{type:"button",className:"btn btn-success",disabled:!0,children:"ปรับปรุงข้อมูล"})})]})})]})})})})]})})]})};export{Ce as default};
