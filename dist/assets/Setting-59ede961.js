import{ak as K,an as W,ao as Y,u as X,a as Z,i as f,r as o,s as z,b as J,c,j as i,f as a,g as m}from"./index-a90aa29c.js";import{c as Q,a as D,e as s}from"./object-7405de1d.js";import{S as ee}from"./sweetalert2.all-ca2d1030.js";import{d as ie}from"./debounce-5af6d14d.js";import{F as re,a as se}from"./formik.esm-c4fd04ca.js";import{I as n}from"./InputField-d7971719.js";import{S as ne}from"./SelectField-917481a8.js";import{B as te}from"./breadcrumbs-b9914bbc.js";import"./_defineProperty-6dbd93ca.js";import"./_baseIsEqual-06123cd3.js";import"./isObjectLike-b76e75a8.js";import"./isSymbol-15555f2d.js";import"./react-select.esm-b46d9623.js";import"./createSuper-98fcd92d.js";import"./floating-ui.dom-0aeb9e8a.js";import"./lodash-f7ec5310.js";const ae="admin",Ce=()=>{const{t:e}=K();W();const[P,oe]=Y(),x=X(),S=Z(),w=P.get("business_id")||"",g=f(r=>r.dataStore.businessUnits),p=f(r=>r.dataStore.shopGroupBuConfig);f(r=>r.pageStore.pageAction);const v=localStorage.getItem(ae),A=v?JSON.parse(v).role:null;A!="admin"&&A!="business_unit"&&x("/");const O=[{to:"/apps/business-unit/list",label:e("business_unit")},{to:"/apps/business-unit/preview/"+w,label:e("business_unit_info")},{label:e("business_unit_setting"),isCurrent:!0}];o.useEffect(()=>{S(z(e("partner_shop"))),S(J(["bu","/apps/business-unit/list"]))});const[le,_]=o.useState([]),[h,y]=o.useState([]),[de,q]=o.useState([]),[M,L]=o.useState([]),[E,pe]=o.useState("");o.useEffect(()=>{L([{value:p.id,label:p.name}])},[]);const[k,H]=o.useState({id:null,name:p.name,id_shop_group:p.id,inr_1:0,inr_2:0,inr_3:0,inr_4:0,inr_5:0,inr_6:0,inr_7:0,inr_8:0,inr_9:0,inr_10:0,inr_11:0,inr_12:0,inr_13:0,inr_14:0,inr_15:0,inr_16:0,inr_17:0,inr_18:0,inr_19:0,inr_20:0,inr_21:0,inr_22:0,inr_23:0,inr_24:0,is_active:!0}),{mutate:b,isLoading:T}=c(m.businessUnitGetRate,{onSuccess:r=>{(r.statusCode===200||r.code===200)&&H(r.data)},onError:()=>{console.error("Failed to fetch asset model data")}}),{mutate:N}=c(m.shopReadyToAddBu,{onSuccess:r=>{const t=r.data.map(l=>({value:l.id,label:l.name}));q(t)}}),{mutate:R}=c(m.buGetShop,{onSuccess:r=>{const t=r.data.filter((l,u,F)=>u===F.findIndex(B=>B.id===l.id)).map(l=>l);_(t),y(t)},onError:()=>{G(e("shop_not_found_in_group")),_([]),y([])}}),C=o.useCallback(()=>{N({data:{id_business_unit:g.id}}),b({data:{id_shop_group:p.id}}),R({data:{id_business_unit:g.id}})},[N,b,R]);o.useEffect(()=>{C()},[C]);const{mutate:I}=c(m.interestRateCreate,{onSuccess:r=>{r.statusCode===200||r.code===200?(d(e("add_success"),"success"),b({data:{id_shop_group:p.id}})):d(r.message,"error")},onError:r=>{d(r.message,"error")}}),j=(r,t,l)=>{r.setFieldValue(l,t.value)},{mutate:U}=c(m.interestRateUpdate,{onSuccess:r=>{r.statusCode===200||r.code===200?d(e("edit_success"),"success"):d(r.message,"error")},onError:r=>{d(r.message,"error")}}),G=r=>{d(r,"error")},d=(r,t)=>{ee.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3}).fire({icon:t,title:r,padding:"10px 20px"})},$=o.useCallback(r=>{const t={...r,active:r.is_active};r.id?U({data:t,id:r.id}):I({data:t})},[I,U]),V=Q().shape({name:D().required(e("required_field")),id_shop_group:D().nullable().required(e("required_field")),inr_1:s().required(e("required_field")),inr_2:s().required(e("required_field")),inr_3:s().required(e("required_field")),inr_4:s().required(e("required_field")),inr_5:s().required(e("required_field")),inr_6:s().required(e("required_field")),inr_7:s().required(e("required_field")),inr_8:s().required(e("required_field")),inr_9:s().required(e("required_field")),inr_10:s().required(e("required_field")),inr_11:s().required(e("required_field")),inr_12:s().required(e("required_field")),inr_13:s().required(e("required_field")),inr_14:s().required(e("required_field")),inr_15:s().required(e("required_field")),inr_16:s().required(e("required_field")),inr_17:s().required(e("required_field")),inr_18:s().required(e("required_field")),inr_19:s().required(e("required_field")),inr_20:s().required(e("required_field")),inr_21:s().required(e("required_field")),inr_22:s().required(e("required_field")),inr_23:s().required(e("required_field")),inr_24:s().required(e("required_field"))});return o.useEffect(()=>{const r=ie(t=>{if(t.trim()==="")_(h);else{const l=h.filter(u=>u.name&&u.name.toLowerCase().includes(t.toLowerCase()));_(l)}},200);return r(E),()=>{r.cancel()}},[E,h]),T?i("div",{children:e("loading")}):a("div",{className:"flex xl:flex-col flex-col gap-2.5",children:[i(te,{items:O}),i("div",{className:"panel px-6 flex-1 py-6 ltr:xl:mr-6 rtl:xl:ml-6",children:i(re,{initialValues:k,onSubmit:$,enableReinitialize:!0,autoComplete:"off",validationSchema:V,children:r=>a(se,{className:"space-y-5 dark:text-white",children:[i("div",{className:"text-lg font-semibold ltr:sm:text-left rtl:sm:text-right text-center",children:e("set_return")}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:i(ne,{label:e("shop_group"),id:"id_shop_group",name:"id_shop_group",options:M,placeholder:e("please_select"),onChange:t=>j(r,t,"id_shop_group"),isSearchable:!0,disabled:!0})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`1 ${e("month")}`,name:"inr_1",type:"number"}),i(n,{label:`2 ${e("months")}`,name:"inr_2",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`3 ${e("months")}`,name:"inr_3",type:"number"}),i(n,{label:`4 ${e("months")}`,name:"inr_4",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`5 ${e("months")}`,name:"inr_5",type:"number"}),i(n,{label:`6 ${e("months")}`,name:"inr_6",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`7 ${e("months")}`,name:"inr_7",type:"number"}),i(n,{label:`8 ${e("months")}`,name:"inr_8",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`9 ${e("months")}`,name:"inr_9",type:"number"}),i(n,{label:`10 ${e("months")}`,name:"inr_10",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`11 ${e("months")}`,name:"inr_11",type:"number"}),i(n,{label:`12 ${e("months")}`,name:"inr_12",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`13 ${e("months")}`,name:"inr_13",type:"number"}),i(n,{label:`14 ${e("months")}`,name:"inr_14",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`15 ${e("months")}`,name:"inr_15",type:"number"}),i(n,{label:`16 ${e("months")}`,name:"inr_16",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`17 ${e("months")}`,name:"inr_17",type:"number"}),i(n,{label:`18 ${e("months")}`,name:"inr_18",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`19 ${e("months")}`,name:"inr_19",type:"number"}),i(n,{label:`20 ${e("months")}`,name:"inr_20",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`21 ${e("months")}`,name:"inr_21",type:"number"}),i(n,{label:`22 ${e("months")}`,name:"inr_22",type:"number"})]})})}),i("div",{className:"input-flex-row",children:i("div",{className:"input-container",children:a("div",{className:"input-flex-row",children:[i(n,{label:`23 ${e("months")}`,name:"inr_23",type:"number"}),i(n,{label:`24 ${e("months")}`,name:"inr_24",type:"number"})]})})}),i("div",{className:"input-flex-row"}),a("button",{type:"submit",className:"btn !mt-6 w-full border-0 btn-primary",children:[T&&i("span",{className:"animate-spin border-2 border-white border-l-transparent rounded-full w-5 h-5 ltr:mr-4 rtl:ml-4 inline-block align-middle"}),e("save")]})]})})})]})};export{Ce as default};
