import{a as F,u as V,r as s,s as G,c as _,j as t,f as a,v as K,g as u}from"./index-a90aa29c.js";import{c as B,a as W}from"./object-7405de1d.js";import{d as Y}from"./debounce-5af6d14d.js";import{P as C,D as q}from"./config-8de56c22.js";import{F as z,a as X}from"./formik.esm-c4fd04ca.js";import{T as J}from"./tippy-react.esm-150a8dd6.js";import{I as Q}from"./InputField-d7971719.js";import{S as Z}from"./SelectField-917481a8.js";import{Q as $}from"./index-2f30bf27.js";import{s as c}from"./showNotification-b9615e49.js";import{I as ee}from"./IconX-54a3093e.js";import{I as te}from"./IconPlus-4c7e79c8.js";import{I as se}from"./IconEdit-bf2b08f0.js";/* empty css              */import{q as h,_ as P}from"./transition-d4ca4cfa.js";import"./_defineProperty-6dbd93ca.js";import"./_baseIsEqual-06123cd3.js";import"./isObjectLike-b76e75a8.js";import"./isSymbol-15555f2d.js";import"./react-select.esm-b46d9623.js";import"./createSuper-98fcd92d.js";import"./floating-ui.dom-0aeb9e8a.js";import"./lodash-f7ec5310.js";import"./sweetalert2.all-ca2d1030.js";import"./keyboard-f171a3e5.js";import"./use-is-mounted-22b05dcc.js";import"./bugs-a60d55c3.js";const N={id:"",name:"",is_active:!0},ae="admin",Ue=()=>{const g=F(),b=V();s.useEffect(()=>{g(G("รายการสัญญา"))},[g]);const f=localStorage.getItem(ae),y=f?JSON.parse(f).role:null;s.useEffect(()=>{y!=="admin"&&b("/")},[y,b]);const[A,R]=s.useState(!1);s.useEffect(()=>{R(!0)},[]);const[E,n]=s.useState(!1),[m,D]=s.useState(N),[U,x]=s.useState([]),[p,T]=s.useState(1),[r,O]=s.useState(C[0]),[M,k]=s.useState(0),[i,L]=s.useState(""),w=B().shape({name:W().required("กรุณาใส่ข้อมูลให้ครบ")}),{mutate:l}=_(u.contractTypeFindAll,{onSuccess:e=>{x(e.data.list),k(e.data.total)},onError:()=>{console.error("Failed to fetch asset type data")}});s.useEffect(()=>{A&&l({data:{page:p,page_size:r,query:i}})},[p]),s.useEffect(()=>{A&&l({data:{page:1,page_size:r,query:i}})},[r]);const d=s.useMemo(()=>Y(e=>{l({data:{page:1,page_size:r,query:e}})},q.FAST),[l,r]);s.useEffect(()=>(d(i),()=>{d.cancel()}),[i,d]);const{mutate:v}=_(u.contractTypeCreate,{onSuccess:e=>{e.statusCode===200||e.code===200?(c("เพิ่มข้อมูลสำเร็จ","success"),n(!1),l({data:{page:p,page_size:r,query:i}})):c(e.message,"error")},onError:e=>{c(e.message,"error")}}),{mutate:S}=_(u.contractTypeUpdate,{onSuccess:e=>{e.statusCode===200||e.code===200?(c("แก้ไขข้อมูลสำเร็จ","success"),n(!1),l({data:{page:p,page_size:r,query:i}})):c(e.message,"error")},onError:e=>{c(e.message,"error")}}),H=s.useCallback(e=>{const o={...e,active:e.is_active};e.id?S({data:o,id:e.id}):v({data:o})},[v,S]),I=(e=null)=>{D(e?JSON.parse(JSON.stringify(e)):N),n(!0)};return t("div",{children:a("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:[a("div",{className:"flex items-center justify-between flex-wrap gap-4 mb-4.5 px-5 ",children:[t("h2",{className:"text-xl",children:"ประเภทสัญญา"}),a("div",{className:"flex sm:flex-row flex-col sm:items-center sm:gap-3 gap-4 w-full sm:w-auto",children:[t("div",{className:"flex gap-3",children:a("button",{type:"button",className:"btn btn-primary",onClick:()=>I(),children:[t(te,{className:"ltr:mr-2 rtl:ml-2"}),"เพิ่มสัญญา"]})}),a("div",{className:"relative",children:[t("input",{type:"text",placeholder:"ค้นหา",className:"form-input py-2 ltr:pr-11 rtl:pl-11 peer",value:i,onChange:e=>L(e.target.value)}),t("button",{type:"button",className:"absolute ltr:right-[11px] rtl:left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-primary",children:t(K,{className:"mx-auto"})})]})]})]}),t("div",{className:"datatables pagination-padding",children:t($,{className:"whitespace-nowrap table-hover invoice-table",records:U,columns:[{accessor:"id",title:"ลำดับ",textAlignment:"center",sortable:!1,render:(e,o)=>t("div",{children:o+1})},{accessor:"name",title:"ชื่อสัญญา",textAlignment:"left",sortable:!1,render:({name:e})=>t("div",{className:"flex items-center font-normal",children:t("div",{children:e})})},{accessor:"is_active",title:"เปิด/ปิด การใช้งาน",textAlignment:"center",sortable:!1,render:({is_active:e})=>t("span",{className:`badge ${e?"badge-outline-success":"badge-outline-danger"}`,children:e?"เปิดใช้งาน":"ปิดใช้งาน"})},{accessor:"action",title:"Actions",textAlignment:"center",sortable:!1,render:e=>t("div",{className:"flex gap-4 items-center w-max mx-auto",children:t(J,{content:"แก้ไข",theme:"Primary",children:t("a",{className:"flex cursor-pointer active",onClick:()=>{I(e)},children:t(se,{className:"w-4.5 h-4.5"})})})})}],page:p,totalRecords:M,recordsPerPage:r,highlightOnHover:!0,onPageChange:e=>T(e),recordsPerPageOptions:C,onRecordsPerPageChange:e=>{T(1),O(e)},paginationText:({from:e,to:o,totalRecords:j})=>`โชว์ ${e} ถึง ${o} ของ ${j} หน้าทั้งหมด`})}),t(h,{appear:!0,show:E,as:s.Fragment,children:a(P,{as:"div",open:E,onClose:()=>n(!1),className:"relative z-[51]",children:[t(h.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t("div",{className:"fixed inset-0 bg-[black]/60"})}),t("div",{className:"fixed inset-0 overflow-y-auto",children:t("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:t(h.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(P.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[t("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>n(!1),children:t(ee,{})}),t("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:m.id?"แก้ไข":"เพิ่ม"}),t("div",{className:"p-5",children:t(z,{initialValues:m,onSubmit:H,enableReinitialize:!0,autoComplete:"off",validationSchema:w,children:e=>a(X,{className:"space-y-5 mb-7 dark:text-white custom-select",children:[t(Q,{label:"ชื่อสัญญา",name:"name",type:"text",placeholder:"กรุณาใส่ข้อมูล"}),t(Z,{label:"สถานะ*",id:"is_active",name:"is_active",options:[{value:!0,label:"เปิด"},{value:!1,label:"ปิด"}],placeholder:"กรุณาเลือก",onChange:o=>{e.setFieldValue("is_active",o.value)},isSearchable:!1}),a("div",{className:"flex justify-end items-center mt-8",children:[t("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>n(!1),children:"ยกเลิก"}),t("button",{type:"submit",className:"btn btn-primary ltr:ml-4 rtl:mr-4",children:m.id?"บันทึก":"เพิ่ม"})]})]})})})]})})})})]})})]})})};export{Ue as default};
