import{f as h,j as a,r as R,F as Ve,q as Xr,R as j,ay as Tn,P as yc,i as Qr,an as Tc,u as Ic,a as vc,m as Ne,c as oe,az as ft,b as In,s as Rc,t as pe,aA as Zr,aq as Rs,z as Jr,D as Sc,am as wc,g as Q}from"./index-a90aa29c.js";import{_ as rt}from"./lodash-f7ec5310.js";import{u as Ac,E as Nc,F as kt,a as Ut}from"./formik.esm-c4fd04ca.js";import{t as Cc,p as xc,i as Oc,f as Pc}from"./constant-e85f1578.js";import{C as Lc}from"./CheckboxField-4d710d64.js";import{I as le}from"./InputField-d7971719.js";import{F as ei}from"./DatePicker-5cf5930a.js";import{S as Me}from"./SelectField-917481a8.js";import{c as Zt,a as Ie,e as ti}from"./object-7405de1d.js";import{S as ce}from"./sweetalert2.all-ca2d1030.js";import{P as yt}from"./regex-a1235873.js";import{a as da}from"./useUploadMutation-785f6dd6.js";import{_ as Dc}from"./index-f89ea186.js";import{r as Mc}from"./helpFunction-19eb552d.js";import{c as Bt,a as Jt,e as kc,b as ni}from"./formatDate-4e046265.js";import{P as ua}from"./preLoading-b2445d9d.js";import{B as Uc}from"./breadcrumbs-b9914bbc.js";import{I as Ft}from"./IconX-54a3093e.js";import{I as en}from"./IconMapPin-780fe235.js";import{I as vn}from"./IconPhoneCall-d077c5b2.js";import{I as Bc}from"./IconLink-e59a7f13.js";import{I as si}from"./IconMail-ccee7844.js";import{I as ri}from"./IconCreditCard-26c6e5da.js";import{I as Tt}from"./IconChecks-e4ba7579.js";import{I as ii}from"./IconLine-2b703383.js";import{I as ai}from"./IconFacebook-4942f70b.js";import{I as Fc}from"./IconInstagram-81fedbbc.js";import{I as oi}from"./IconPlus-4c7e79c8.js";import{S as Gc,N as Vc,P as Hc,a as jc}from"./pagination.min-be96664e.js";/* empty css              */import{R as Js}from"./index.es-edddd9ad.js";import{I as li}from"./IconAward-a6526f88.js";import{e as Ss,c as ci,b as Rn}from"./formatNumeric-862380d6.js";import{I as qc}from"./IconSend-abfbd91c.js";import{I as Yc}from"./IconPaperclip-af76ad56.js";import{I as di}from"./IconChatDot-a1f0ea6d.js";import{S as zc}from"./index-125b8661.js";import{I as $c}from"./IconRefresh-fed8c080.js";import{I as Wc}from"./IconCopy-f9046c33.js";import{s as Gt}from"./showNotification-b9615e49.js";import{I as Kc}from"./IconXCircle-e548bf89.js";import{$ as _e}from"./tabs-dd3b1363.js";import{q as ke,_ as Je}from"./transition-d4ca4cfa.js";import"./flatpickr-2301360e.js";import"./react-select.esm-b46d9623.js";import"./createSuper-98fcd92d.js";import"./floating-ui.dom-0aeb9e8a.js";import"./_defineProperty-6dbd93ca.js";import"./_baseIsEqual-06123cd3.js";import"./isObjectLike-b76e75a8.js";import"./isSymbol-15555f2d.js";import"./keyboard-f171a3e5.js";import"./use-resolve-button-type-789d628c.js";import"./use-is-mounted-22b05dcc.js";import"./bugs-a60d55c3.js";const Xc=({className:e,fill:t=!1,duotone:n=!0})=>h("svg",{width:"20",height:"20",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg",className:e,children:[a("rect",{height:"427.97",rx:"71.15",width:"427.97",x:"42.01",y:"42.95"}),a("path",{d:"m389.39 221.92v-57.07c-74.6-3.15-77-70.94-77-77.31v-.48h-57.66v222.27a45.66 45.66 0 1 1 -32.36-43.71v-58.86a104.57 104.57 0 0 0 -13.32-.85 103.42 103.42 0 1 0 103.42 103.42c0-1.45 0-2.89-.1-4.32v-109.45c26.55 24.29 77.02 26.36 77.02 26.36z",fill:"#00f6ef"}),a("path",{d:"m406.37 236v-57.1c-74.61-3.15-77-70.94-77-77.31v-.48h-57.66v222.27a45.66 45.66 0 1 1 -32.36-43.7v-58.87a104.57 104.57 0 0 0 -13.35-.81 103.42 103.42 0 1 0 103.45 103.38c0-1.45 0-2.89-.1-4.32v-109.45c26.55 24.29 77.02 26.39 77.02 26.39z",fill:"#fff"}),h("g",{fill:"#ff004f",children:[a("path",{d:"m313.82 101.11c2.78 15.14 10.9 38.81 34.57 52.66-18.09-21.07-19-48.26-19-52.18v-.48z"}),a("path",{d:"m406.37 236v-57.1a106.46 106.46 0 0 1 -17-2v44.95s-50.47-2.07-77-26.36v109.42c.06 1.43.1 2.87.1 4.32a103.43 103.43 0 0 1 -160.72 86.1 103.41 103.41 0 0 0 177.7-71.95c0-1.45 0-2.89-.1-4.32v-109.45c26.55 24.29 77.02 26.39 77.02 26.39z"}),a("path",{d:"m222.37 265.53a45.69 45.69 0 0 0 -33.19 84.85 45.69 45.69 0 0 1 50.17-70.7v-58.87a104.57 104.57 0 0 0 -13.35-.81c-1.23 0-2.44 0-3.66.07z"})]})]}),ws=({items:e})=>{const[t,n]=R.useState(-1),[s,i]=R.useState(!1),l=e.filter(c=>c.image_url&&c.image_url.includes("http")),o=c=>{n(c),i(!0)};return R.useEffect(()=>{window.global=window},[]),h(Ve,{children:[h(Gc,{modules:[Vc,Hc],navigation:{nextEl:".swiper-button-next-ex1",prevEl:".swiper-button-prev-ex1"},pagination:{clickable:!0},className:"swiper max-w-3xl mx-auto mb-5 !z-0 flex items-center",id:"slider1",children:[a("div",{className:"swiper-wrapper",children:l.map((c,d)=>a(jc,{children:a("img",{src:`${c.image_url}`,className:"w-full max-h-80 object-contain",alt:"itemImage",onClick:()=>o(d)})},d))}),a("button",{className:"swiper-button-prev-ex1 grid place-content-center ltr:left-2 rtl:right-2 p-1 transition text-primary hover:text-white border border-primary hover:border-primary hover:bg-primary rounded-full absolute z-[999] top-1/2 -translate-y-1/2",children:a(Xr,{className:"w-5 h-5 rtl:-rotate-90 rotate-90"})}),a("button",{className:"swiper-button-next-ex1 grid place-content-center ltr:right-2 rtl:left-2 p-1 transition text-primary hover:text-white border border-primary hover:border-primary hover:bg-primary rounded-full absolute z-[999] top-1/2 -translate-y-1/2",children:a(Xr,{className:"w-5 h-5 rtl:rotate-90 -rotate-90"})})]}),s&&a(Js,{mainSrc:l[t].image_url,nextSrc:l[(t+1)%l.length].image_url,prevSrc:l[(t+l.length-1)%l.length].image_url,onCloseRequest:()=>i(!1),onMovePrevRequest:()=>n((t+l.length-1)%l.length),onMoveNextRequest:()=>n((t+1)%l.length)})]})};/*!
 * FilePond 4.31.3
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Qc=e=>e instanceof HTMLElement,Zc=(e,t=[],n=[])=>{const s={...e},i=[],l=[],o=()=>({...s}),c=()=>{const f=[...i];return i.length=0,f},d=()=>{const f=[...l];l.length=0,f.forEach(({type:v,data:O})=>{m(v,O)})},m=(f,v,O)=>{if(O&&!document.hidden){l.push({type:f,data:v});return}y[f]&&y[f](v),i.push({type:f,data:v})},p=(f,...v)=>I[f]?I[f](...v):null,b={getState:o,processActionQueue:c,processDispatchQueue:d,dispatch:m,query:p};let I={};t.forEach(f=>{I={...f(s),...I}});let y={};return n.forEach(f=>{y={...f(m,p,s),...y}}),b},Jc=(e,t,n)=>{if(typeof n=="function"){e[t]=n;return}Object.defineProperty(e,t,{...n})},ge=(e,t)=>{for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])},_t=e=>{const t={};return ge(e,n=>{Jc(t,n,e[n])}),t},we=(e,t,n=null)=>{if(n===null)return e.getAttribute(t)||e.hasAttribute(t);e.setAttribute(t,n)},ed="http://www.w3.org/2000/svg",td=["svg","path"],ui=e=>td.includes(e),Gn=(e,t,n={})=>{typeof t=="object"&&(n=t,t=null);const s=ui(e)?document.createElementNS(ed,e):document.createElement(e);return t&&(ui(e)?we(s,"class",t):s.className=t),ge(n,(i,l)=>{we(s,i,l)}),s},nd=e=>(t,n)=>{typeof n<"u"&&e.children[n]?e.insertBefore(t,e.children[n]):e.appendChild(t)},sd=(e,t)=>(n,s)=>(typeof s<"u"?t.splice(s,0,n):t.push(n),n),rd=(e,t)=>n=>(t.splice(t.indexOf(n),1),n.element.parentNode&&e.removeChild(n.element),n),id=(()=>typeof window<"u"&&typeof window.document<"u")(),pa=()=>id,ad=pa()?Gn("svg"):{},od="children"in ad?e=>e.children.length:e=>e.childNodes.length,ha=(e,t,n,s)=>{const i=n[0]||e.left,l=n[1]||e.top,o=i+e.width,c=l+e.height*(s[1]||1),d={element:{...e},inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:i,top:l,right:o,bottom:c}};return t.filter(m=>!m.isRectIgnored()).map(m=>m.rect).forEach(m=>{pi(d.inner,{...m.inner}),pi(d.outer,{...m.outer})}),hi(d.inner),d.outer.bottom+=d.element.marginBottom,d.outer.right+=d.element.marginRight,hi(d.outer),d},pi=(e,t)=>{t.top+=e.top,t.right+=e.left,t.bottom+=e.top,t.left+=e.left,t.bottom>e.bottom&&(e.bottom=t.bottom),t.right>e.right&&(e.right=t.right)},hi=e=>{e.width=e.right-e.left,e.height=e.bottom-e.top},It=e=>typeof e=="number",ld=(e,t,n,s=.001)=>Math.abs(e-t)<s&&Math.abs(n)<s,cd=({stiffness:e=.5,damping:t=.75,mass:n=10}={})=>{let s=null,i=null,l=0,o=!1;const m=_t({interpolate:(p,b)=>{if(o)return;if(!(It(s)&&It(i))){o=!0,l=0;return}const I=-(i-s)*e;l+=I/n,i+=l,l*=t,ld(i,s,l)||b?(i=s,l=0,o=!0,m.onupdate(i),m.oncomplete(i)):m.onupdate(i)},target:{set:p=>{if(It(p)&&!It(i)&&(i=p),s===null&&(s=p,i=p),s=p,i===s||typeof s>"u"){o=!0,l=0,m.onupdate(i),m.oncomplete(i);return}o=!1},get:()=>s},resting:{get:()=>o},onupdate:p=>{},oncomplete:p=>{}});return m},dd=e=>e<.5?2*e*e:-1+(4-2*e)*e,ud=({duration:e=500,easing:t=dd,delay:n=0}={})=>{let s=null,i,l,o=!0,c=!1,d=null;const p=_t({interpolate:(b,I)=>{o||d===null||(s===null&&(s=b),!(b-s<n)&&(i=b-s-n,i>=e||I?(i=1,l=c?0:1,p.onupdate(l*d),p.oncomplete(l*d),o=!0):(l=i/e,p.onupdate((i>=0?t(c?1-l:l):0)*d))))},target:{get:()=>c?0:d,set:b=>{if(d===null){d=b,p.onupdate(b),p.oncomplete(b);return}b<d?(d=1,c=!0):(c=!1,d=b),o=!1,s=null}},resting:{get:()=>o},onupdate:b=>{},oncomplete:b=>{}});return p},fi={spring:cd,tween:ud},pd=(e,t,n)=>{const s=e[t]&&typeof e[t][n]=="object"?e[t][n]:e[t]||e,i=typeof s=="string"?s:s.type,l=typeof s=="object"?{...s}:{};return fi[i]?fi[i](l):null},er=(e,t,n,s=!1)=>{t=Array.isArray(t)?t:[t],t.forEach(i=>{e.forEach(l=>{let o=l,c=()=>n[l],d=m=>n[l]=m;typeof l=="object"&&(o=l.key,c=l.getter||c,d=l.setter||d),!(i[o]&&!s)&&(i[o]={get:c,set:d})})})},hd=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:s})=>{const i={...t},l=[];return ge(e,(o,c)=>{const d=pd(c);if(!d)return;d.onupdate=p=>{t[o]=p},d.target=i[o],er([{key:o,setter:p=>{d.target!==p&&(d.target=p)},getter:()=>t[o]}],[n,s],t,!0),l.push(d)}),{write:o=>{let c=document.hidden,d=!0;return l.forEach(m=>{m.resting||(d=!1),m.interpolate(o,c)}),d},destroy:()=>{}}},fd=e=>(t,n)=>{e.addEventListener(t,n)},md=e=>(t,n)=>{e.removeEventListener(t,n)},_d=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:s,viewState:i,view:l})=>{const o=[],c=fd(l.element),d=md(l.element);return s.on=(m,p)=>{o.push({type:m,fn:p}),c(m,p)},s.off=(m,p)=>{o.splice(o.findIndex(b=>b.type===m&&b.fn===p),1),d(m,p)},{write:()=>!0,destroy:()=>{o.forEach(m=>{d(m.type,m.fn)})}}},gd=({mixinConfig:e,viewProps:t,viewExternalAPI:n})=>{er(e,n,t)},Ue=e=>e!=null,Ed={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},bd=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:s,view:i})=>{const l={...t},o={};er(e,[n,s],t);const c=()=>[t.translateX||0,t.translateY||0],d=()=>[t.scaleX||0,t.scaleY||0],m=()=>i.rect?ha(i.rect,i.childViews,c(),d()):null;return n.rect={get:m},s.rect={get:m},e.forEach(p=>{t[p]=typeof l[p]>"u"?Ed[p]:l[p]}),{write:()=>{if(yd(o,t))return Td(i.element,t),Object.assign(o,{...t}),!0},destroy:()=>{}}},yd=(e,t)=>{if(Object.keys(e).length!==Object.keys(t).length)return!0;for(const n in t)if(t[n]!==e[n])return!0;return!1},Td=(e,{opacity:t,perspective:n,translateX:s,translateY:i,scaleX:l,scaleY:o,rotateX:c,rotateY:d,rotateZ:m,originX:p,originY:b,width:I,height:y})=>{let f="",v="";(Ue(p)||Ue(b))&&(v+=`transform-origin: ${p||0}px ${b||0}px;`),Ue(n)&&(f+=`perspective(${n}px) `),(Ue(s)||Ue(i))&&(f+=`translate3d(${s||0}px, ${i||0}px, 0) `),(Ue(l)||Ue(o))&&(f+=`scale3d(${Ue(l)?l:1}, ${Ue(o)?o:1}, 1) `),Ue(m)&&(f+=`rotateZ(${m}rad) `),Ue(c)&&(f+=`rotateX(${c}rad) `),Ue(d)&&(f+=`rotateY(${d}rad) `),f.length&&(v+=`transform:${f};`),Ue(t)&&(v+=`opacity:${t};`,t===0&&(v+="visibility:hidden;"),t<1&&(v+="pointer-events:none;")),Ue(y)&&(v+=`height:${y}px;`),Ue(I)&&(v+=`width:${I}px;`);const O=e.elementCurrentStyle||"";(v.length!==O.length||v!==O)&&(e.style.cssText=v,e.elementCurrentStyle=v)},Id={styles:bd,listeners:_d,animations:hd,apis:gd},mi=(e={},t={},n={})=>(t.layoutCalculated||(e.paddingTop=parseInt(n.paddingTop,10)||0,e.marginTop=parseInt(n.marginTop,10)||0,e.marginRight=parseInt(n.marginRight,10)||0,e.marginBottom=parseInt(n.marginBottom,10)||0,e.marginLeft=parseInt(n.marginLeft,10)||0,t.layoutCalculated=!0),e.left=t.offsetLeft||0,e.top=t.offsetTop||0,e.width=t.offsetWidth||0,e.height=t.offsetHeight||0,e.right=e.left+e.width,e.bottom=e.top+e.height,e.scrollTop=t.scrollTop,e.hidden=t.offsetParent===null,e),Re=({tag:e="div",name:t=null,attributes:n={},read:s=()=>{},write:i=()=>{},create:l=()=>{},destroy:o=()=>{},filterFrameActionsForChild:c=(y,f)=>f,didCreateView:d=()=>{},didWriteView:m=()=>{},ignoreRect:p=!1,ignoreRectUpdate:b=!1,mixins:I=[]}={})=>(y,f={})=>{const v=Gn(e,`filepond--${t}`,n),O=window.getComputedStyle(v,null),_=mi();let L=null,D=!1;const U=[],k=[],V={},te={},M=[i],Y=[s],X=[o],w=()=>v,z=()=>U.concat(),Ee=()=>V,P=K=>(q,fe)=>q(K,fe),Z=()=>L||(L=ha(_,U,[0,0],[1,1]),L),N=()=>O,C=()=>{L=null,U.forEach(fe=>fe._read()),!(b&&_.width&&_.height)&&mi(_,v,O);const q={root:he,props:f,rect:_};Y.forEach(fe=>fe(q))},B=(K,q,fe)=>{let Ge=q.length===0;return M.forEach(Ae=>{Ae({props:f,root:he,actions:q,timestamp:K,shouldOptimize:fe})===!1&&(Ge=!1)}),k.forEach(Ae=>{Ae.write(K)===!1&&(Ge=!1)}),U.filter(Ae=>!!Ae.element.parentNode).forEach(Ae=>{Ae._write(K,c(Ae,q),fe)||(Ge=!1)}),U.forEach((Ae,Et)=>{Ae.element.parentNode||(he.appendChild(Ae.element,Et),Ae._read(),Ae._write(K,c(Ae,q),fe),Ge=!1)}),D=Ge,m({props:f,root:he,actions:q,timestamp:K}),Ge},F=()=>{k.forEach(K=>K.destroy()),X.forEach(K=>{K({root:he,props:f})}),U.forEach(K=>K._destroy())},J={element:{get:w},style:{get:N},childViews:{get:z}},S={...J,rect:{get:Z},ref:{get:Ee},is:K=>t===K,appendChild:nd(v),createChildView:P(y),linkView:K=>(U.push(K),K),unlinkView:K=>{U.splice(U.indexOf(K),1)},appendChildView:sd(v,U),removeChildView:rd(v,U),registerWriter:K=>M.push(K),registerReader:K=>Y.push(K),registerDestroyer:K=>X.push(K),invalidateLayout:()=>v.layoutCalculated=!1,dispatch:y.dispatch,query:y.query},Ye={element:{get:w},childViews:{get:z},rect:{get:Z},resting:{get:()=>D},isRectIgnored:()=>p,_read:C,_write:B,_destroy:F},H={...J,rect:{get:()=>_}};Object.keys(I).sort((K,q)=>K==="styles"?1:q==="styles"?-1:0).forEach(K=>{const q=Id[K]({mixinConfig:I[K],viewProps:f,viewState:te,viewInternalAPI:S,viewExternalAPI:Ye,view:_t(H)});q&&k.push(q)});const he=_t(S);l({root:he,props:f});const Ot=od(v);return U.forEach((K,q)=>{he.appendChild(K.element,Ot+q)}),d(he),_t(Ye)},vd=(e,t,n=60)=>{const s="__framePainter";if(window[s]){window[s].readers.push(e),window[s].writers.push(t);return}window[s]={readers:[e],writers:[t]};const i=window[s],l=1e3/n;let o=null,c=null,d=null,m=null;const p=()=>{document.hidden?(d=()=>window.setTimeout(()=>b(performance.now()),l),m=()=>window.clearTimeout(c)):(d=()=>window.requestAnimationFrame(b),m=()=>window.cancelAnimationFrame(c))};document.addEventListener("visibilitychange",()=>{m&&m(),p(),b(performance.now())});const b=I=>{c=d(b),o||(o=I);const y=I-o;y<=l||(o=I-y%l,i.readers.forEach(f=>f()),i.writers.forEach(f=>f(I)))};return p(),b(performance.now()),{pause:()=>{m(c)}}},Fe=(e,t)=>({root:n,props:s,actions:i=[],timestamp:l,shouldOptimize:o})=>{i.filter(c=>e[c.type]).forEach(c=>e[c.type]({root:n,props:s,action:c.data,timestamp:l,shouldOptimize:o})),t&&t({root:n,props:s,actions:i,timestamp:l,shouldOptimize:o})},_i=(e,t)=>t.parentNode.insertBefore(e,t),gi=(e,t)=>t.parentNode.insertBefore(e,t.nextSibling),Yn=e=>Array.isArray(e),lt=e=>e==null,Rd=e=>e.trim(),zn=e=>""+e,Sd=(e,t=",")=>lt(e)?[]:Yn(e)?e:zn(e).split(t).map(Rd).filter(n=>n.length),fa=e=>typeof e=="boolean",ma=e=>fa(e)?e:e==="true",Be=e=>typeof e=="string",_a=e=>It(e)?e:Be(e)?zn(e).replace(/[a-z]+/gi,""):0,Dn=e=>parseInt(_a(e),10),Ei=e=>parseFloat(_a(e)),Yt=e=>It(e)&&isFinite(e)&&Math.floor(e)===e,bi=(e,t=1e3)=>{if(Yt(e))return e;let n=zn(e).trim();return/MB$/i.test(n)?(n=n.replace(/MB$i/,"").trim(),Dn(n)*t*t):/KB/i.test(n)?(n=n.replace(/KB$i/,"").trim(),Dn(n)*t):Dn(n)},vt=e=>typeof e=="function",wd=e=>{let t=self,n=e.split("."),s=null;for(;s=n.shift();)if(t=t[s],!t)return null;return t},yi={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},Ad=e=>{const t={};return t.url=Be(e)?e:e.url||"",t.timeout=e.timeout?parseInt(e.timeout,10):0,t.headers=e.headers?e.headers:{},ge(yi,n=>{t[n]=Nd(n,e[n],yi[n],t.timeout,t.headers)}),t.process=e.process||Be(e)||e.url?t.process:null,t.remove=e.remove||null,delete t.headers,t},Nd=(e,t,n,s,i)=>{if(t===null)return null;if(typeof t=="function")return t;const l={url:n==="GET"||n==="PATCH"?`?${e}=`:"",method:n,headers:i,withCredentials:!1,timeout:s,onload:null,ondata:null,onerror:null};if(Be(t))return l.url=t,l;if(Object.assign(l,t),Be(l.headers)){const o=l.headers.split(/:(.+)/);l.headers={header:o[0],value:o[1]}}return l.withCredentials=ma(l.withCredentials),l},Cd=e=>Ad(e),xd=e=>e===null,xe=e=>typeof e=="object"&&e!==null,Od=e=>xe(e)&&Be(e.url)&&xe(e.process)&&xe(e.revert)&&xe(e.restore)&&xe(e.fetch),Us=e=>Yn(e)?"array":xd(e)?"null":Yt(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":Od(e)?"api":typeof e,Pd=e=>e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'),Ld={array:Sd,boolean:ma,int:e=>Us(e)==="bytes"?bi(e):Dn(e),number:Ei,float:Ei,bytes:bi,string:e=>vt(e)?e:zn(e),function:e=>wd(e),serverapi:Cd,object:e=>{try{return JSON.parse(Pd(e))}catch{return null}}},Dd=(e,t)=>Ld[t](e),ga=(e,t,n)=>{if(e===t)return e;let s=Us(e);if(s!==n){const i=Dd(e,n);if(s=Us(i),i===null)throw`Trying to assign value with incorrect type to "${option}", allowed type: "${n}"`;e=i}return e},Md=(e,t)=>{let n=e;return{enumerable:!0,get:()=>n,set:s=>{n=ga(s,e,t)}}},kd=e=>{const t={};return ge(e,n=>{const s=e[n];t[n]=Md(s[0],s[1])}),_t(t)},Ud=e=>({items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:kd(e)}),$n=(e,t="-")=>e.split(/(?=[A-Z])/).map(n=>n.toLowerCase()).join(t),Bd=(e,t)=>{const n={};return ge(t,s=>{n[s]={get:()=>e.getState().options[s],set:i=>{e.dispatch(`SET_${$n(s,"_").toUpperCase()}`,{value:i})}}}),n},Fd=e=>(t,n,s)=>{const i={};return ge(e,l=>{const o=$n(l,"_").toUpperCase();i[`SET_${o}`]=c=>{try{s.options[l]=c.value}catch{}t(`DID_SET_${o}`,{value:s.options[l]})}}),i},Gd=e=>t=>{const n={};return ge(e,s=>{n[`GET_${$n(s,"_").toUpperCase()}`]=i=>t.options[s]}),n},Ze={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5},tr=()=>Math.random().toString(36).substring(2,11),nr=(e,t)=>e.splice(t,1),Vd=(e,t)=>{t?e():document.hidden?Promise.resolve(1).then(e):setTimeout(e,0)},Wn=()=>{const e=[],t=(s,i)=>{nr(e,e.findIndex(l=>l.event===s&&(l.cb===i||!i)))},n=(s,i,l)=>{e.filter(o=>o.event===s).map(o=>o.cb).forEach(o=>Vd(()=>o(...i),l))};return{fireSync:(s,...i)=>{n(s,i,!0)},fire:(s,...i)=>{n(s,i,!1)},on:(s,i)=>{e.push({event:s,cb:i})},onOnce:(s,i)=>{e.push({event:s,cb:(...l)=>{t(s,i),i(...l)}})},off:t}},Ea=(e,t,n)=>{Object.getOwnPropertyNames(e).filter(s=>!n.includes(s)).forEach(s=>Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(e,s)))},Hd=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],He=e=>{const t={};return Ea(e,t,Hd),t},jd=e=>{e.forEach((t,n)=>{t.released&&nr(e,n)})},W={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},Ce={INPUT:1,LIMBO:2,LOCAL:3},ba=e=>/[^0-9]+/.exec(e),ya=()=>ba(1.1.toLocaleString())[0],qd=()=>{const e=ya(),t=1e3.toLocaleString(),n=1e3.toString();return t!==n?ba(t)[0]:e==="."?",":"."},A={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},sr=[],et=(e,t,n)=>new Promise((s,i)=>{const l=sr.filter(c=>c.key===e).map(c=>c.cb);if(l.length===0){s(t);return}const o=l.shift();l.reduce((c,d)=>c.then(m=>d(m,n)),o(t,n)).then(c=>s(c)).catch(c=>i(c))}),Ct=(e,t,n)=>sr.filter(s=>s.key===e).map(s=>s.cb(t,n)),Yd=(e,t)=>sr.push({key:e,cb:t}),zd=e=>Object.assign(Vt,e),Vn=()=>({...Vt}),$d=e=>{ge(e,(t,n)=>{Vt[t]&&(Vt[t][0]=ga(n,Vt[t][0],Vt[t][1]))})},Vt={id:[null,A.STRING],name:["filepond",A.STRING],disabled:[!1,A.BOOLEAN],className:[null,A.STRING],required:[!1,A.BOOLEAN],captureMethod:[null,A.STRING],allowSyncAcceptAttribute:[!0,A.BOOLEAN],allowDrop:[!0,A.BOOLEAN],allowBrowse:[!0,A.BOOLEAN],allowPaste:[!0,A.BOOLEAN],allowMultiple:[!1,A.BOOLEAN],allowReplace:[!0,A.BOOLEAN],allowRevert:[!0,A.BOOLEAN],allowRemove:[!0,A.BOOLEAN],allowProcess:[!0,A.BOOLEAN],allowReorder:[!1,A.BOOLEAN],allowDirectoriesOnly:[!1,A.BOOLEAN],storeAsFile:[!1,A.BOOLEAN],forceRevert:[!1,A.BOOLEAN],maxFiles:[null,A.INT],checkValidity:[!1,A.BOOLEAN],itemInsertLocationFreedom:[!0,A.BOOLEAN],itemInsertLocation:["before",A.STRING],itemInsertInterval:[75,A.INT],dropOnPage:[!1,A.BOOLEAN],dropOnElement:[!0,A.BOOLEAN],dropValidation:[!1,A.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],A.ARRAY],instantUpload:[!0,A.BOOLEAN],maxParallelUploads:[2,A.INT],allowMinimumUploadDuration:[!0,A.BOOLEAN],chunkUploads:[!1,A.BOOLEAN],chunkForce:[!1,A.BOOLEAN],chunkSize:[5e6,A.INT],chunkRetryDelays:[[500,1e3,3e3],A.ARRAY],server:[null,A.SERVER_API],fileSizeBase:[1e3,A.INT],labelFileSizeBytes:["bytes",A.STRING],labelFileSizeKilobytes:["KB",A.STRING],labelFileSizeMegabytes:["MB",A.STRING],labelFileSizeGigabytes:["GB",A.STRING],labelDecimalSeparator:[ya(),A.STRING],labelThousandsSeparator:[qd(),A.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',A.STRING],labelInvalidField:["Field contains invalid files",A.STRING],labelFileWaitingForSize:["Waiting for size",A.STRING],labelFileSizeNotAvailable:["Size not available",A.STRING],labelFileCountSingular:["file in list",A.STRING],labelFileCountPlural:["files in list",A.STRING],labelFileLoading:["Loading",A.STRING],labelFileAdded:["Added",A.STRING],labelFileLoadError:["Error during load",A.STRING],labelFileRemoved:["Removed",A.STRING],labelFileRemoveError:["Error during remove",A.STRING],labelFileProcessing:["Uploading",A.STRING],labelFileProcessingComplete:["Upload complete",A.STRING],labelFileProcessingAborted:["Upload cancelled",A.STRING],labelFileProcessingError:["Error during upload",A.STRING],labelFileProcessingRevertError:["Error during revert",A.STRING],labelTapToCancel:["tap to cancel",A.STRING],labelTapToRetry:["tap to retry",A.STRING],labelTapToUndo:["tap to undo",A.STRING],labelButtonRemoveItem:["Remove",A.STRING],labelButtonAbortItemLoad:["Abort",A.STRING],labelButtonRetryItemLoad:["Retry",A.STRING],labelButtonAbortItemProcessing:["Cancel",A.STRING],labelButtonUndoItemProcessing:["Undo",A.STRING],labelButtonRetryItemProcessing:["Retry",A.STRING],labelButtonProcessItem:["Upload",A.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',A.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],oninit:[null,A.FUNCTION],onwarning:[null,A.FUNCTION],onerror:[null,A.FUNCTION],onactivatefile:[null,A.FUNCTION],oninitfile:[null,A.FUNCTION],onaddfilestart:[null,A.FUNCTION],onaddfileprogress:[null,A.FUNCTION],onaddfile:[null,A.FUNCTION],onprocessfilestart:[null,A.FUNCTION],onprocessfileprogress:[null,A.FUNCTION],onprocessfileabort:[null,A.FUNCTION],onprocessfilerevert:[null,A.FUNCTION],onprocessfile:[null,A.FUNCTION],onprocessfiles:[null,A.FUNCTION],onremovefile:[null,A.FUNCTION],onpreparefile:[null,A.FUNCTION],onupdatefiles:[null,A.FUNCTION],onreorderfiles:[null,A.FUNCTION],beforeDropFile:[null,A.FUNCTION],beforeAddFile:[null,A.FUNCTION],beforeRemoveFile:[null,A.FUNCTION],beforePrepareFile:[null,A.FUNCTION],stylePanelLayout:[null,A.STRING],stylePanelAspectRatio:[null,A.STRING],styleItemPanelAspectRatio:[null,A.STRING],styleButtonRemoveItemPosition:["left",A.STRING],styleButtonProcessItemPosition:["right",A.STRING],styleLoadIndicatorPosition:["right",A.STRING],styleProgressIndicatorPosition:["right",A.STRING],styleButtonRemoveItemAlign:[!1,A.BOOLEAN],files:[[],A.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],A.ARRAY]},Rt=(e,t)=>lt(t)?e[0]||null:Yt(t)?e[t]||null:(typeof t=="object"&&(t=t.id),e.find(n=>n.id===t)||null),Ta=e=>{if(lt(e))return e;if(/:/.test(e)){const t=e.split(":");return t[1]/t[0]}return parseFloat(e)},nt=e=>e.filter(t=>!t.archived),Wd={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4};let Sn=null;const Kd=()=>{if(Sn===null)try{const e=new DataTransfer;e.items.add(new File(["hello world"],"This_Works.txt"));const t=document.createElement("input");t.setAttribute("type","file"),t.files=e.files,Sn=t.files.length===1}catch{Sn=!1}return Sn},Xd=[W.LOAD_ERROR,W.PROCESSING_ERROR,W.PROCESSING_REVERT_ERROR],Qd=[W.LOADING,W.PROCESSING,W.PROCESSING_QUEUED,W.INIT],Zd=[W.PROCESSING_COMPLETE],Jd=e=>Xd.includes(e.status),eu=e=>Qd.includes(e.status),tu=e=>Zd.includes(e.status),Ti=e=>xe(e.options.server)&&(xe(e.options.server.process)||vt(e.options.server.process)),nu=e=>({GET_STATUS:()=>{const t=nt(e.items),{EMPTY:n,ERROR:s,BUSY:i,IDLE:l,READY:o}=Wd;return t.length===0?n:t.some(Jd)?s:t.some(eu)?i:t.some(tu)?o:l},GET_ITEM:t=>Rt(e.items,t),GET_ACTIVE_ITEM:t=>Rt(nt(e.items),t),GET_ACTIVE_ITEMS:()=>nt(e.items),GET_ITEMS:()=>e.items,GET_ITEM_NAME:t=>{const n=Rt(e.items,t);return n?n.filename:null},GET_ITEM_SIZE:t=>{const n=Rt(e.items,t);return n?n.fileSize:null},GET_STYLES:()=>Object.keys(e.options).filter(t=>/^style/.test(t)).map(t=>({name:t,value:e.options[t]})),GET_PANEL_ASPECT_RATIO:()=>/circle/.test(e.options.stylePanelLayout)?1:Ta(e.options.stylePanelAspectRatio),GET_ITEM_PANEL_ASPECT_RATIO:()=>e.options.styleItemPanelAspectRatio,GET_ITEMS_BY_STATUS:t=>nt(e.items).filter(n=>n.status===t),GET_TOTAL_ITEMS:()=>nt(e.items).length,SHOULD_UPDATE_FILE_INPUT:()=>e.options.storeAsFile&&Kd()&&!Ti(e),IS_ASYNC:()=>Ti(e),GET_FILE_SIZE_LABELS:t=>({labelBytes:t("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:t("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:t("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:t("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0})}),su=e=>{const t=nt(e.items).length;if(!e.options.allowMultiple)return t===0;const n=e.options.maxFiles;return n===null||t<n},Ia=(e,t,n)=>Math.max(Math.min(n,e),t),ru=(e,t,n)=>e.splice(t,0,n),iu=(e,t,n)=>lt(t)?null:typeof n>"u"?(e.push(t),t):(n=Ia(n,0,e.length),ru(e,n,t),t),Bs=e=>/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e),un=e=>`${e}`.split("/").pop().split("?").shift(),Kn=e=>e.split(".").pop(),au=e=>{if(typeof e!="string")return"";const t=e.split("/").pop();return/svg/.test(t)?"svg":/zip|compressed/.test(t)?"zip":/plain/.test(t)?"txt":/msword/.test(t)?"doc":/[a-z]+/.test(t)?t==="jpeg"?"jpg":t:""},tn=(e,t="")=>(t+e).slice(-t.length),va=(e=new Date)=>`${e.getFullYear()}-${tn(e.getMonth()+1,"00")}-${tn(e.getDate(),"00")}_${tn(e.getHours(),"00")}-${tn(e.getMinutes(),"00")}-${tn(e.getSeconds(),"00")}`,qt=(e,t,n=null,s=null)=>{const i=typeof n=="string"?e.slice(0,e.size,n):e.slice(0,e.size,e.type);return i.lastModifiedDate=new Date,e._relativePath&&(i._relativePath=e._relativePath),Be(t)||(t=va()),t&&s===null&&Kn(t)?i.name=t:(s=s||au(i.type),i.name=t+(s?"."+s:"")),i},ou=()=>window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,Ra=(e,t)=>{const n=ou();if(n){const s=new n;return s.append(e),s.getBlob(t)}return new Blob([e],{type:t})},lu=(e,t)=>{const n=new ArrayBuffer(e.length),s=new Uint8Array(n);for(let i=0;i<e.length;i++)s[i]=e.charCodeAt(i);return Ra(n,t)},Sa=e=>(/^data:(.+);/.exec(e)||[])[1]||null,cu=e=>e.split(",")[1].replace(/\s/g,""),du=e=>atob(cu(e)),uu=e=>{const t=Sa(e),n=du(e);return lu(n,t)},pu=(e,t,n)=>qt(uu(e),t,null,n),hu=e=>{if(!/^content-disposition:/i.test(e))return null;const t=e.split(/filename=|filename\*=.+''/).splice(1).map(n=>n.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(n=>n.length);return t.length?decodeURI(t[t.length-1]):null},fu=e=>{if(/content-length:/i.test(e)){const t=e.match(/[0-9]+/)[0];return t?parseInt(t,10):null}return null},mu=e=>/x-content-transfer-id:/i.test(e)&&(e.split(":")[1]||"").trim()||null,rr=e=>{const t={source:null,name:null,size:null},n=e.split(`
`);for(let s of n){const i=hu(s);if(i){t.name=i;continue}const l=fu(s);if(l){t.size=l;continue}const o=mu(s);if(o){t.source=o;continue}}return t},_u=e=>{const t={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},n=()=>t.progress,s=()=>{t.request&&t.request.abort&&t.request.abort()},i=()=>{const c=t.source;o.fire("init",c),c instanceof File?o.fire("load",c):c instanceof Blob?o.fire("load",qt(c,c.name)):Bs(c)?o.fire("load",pu(c)):l(c)},l=c=>{if(!e){o.fire("error",{type:"error",body:"Can't load URL",code:400});return}t.timestamp=Date.now(),t.request=e(c,d=>{t.duration=Date.now()-t.timestamp,t.complete=!0,d instanceof Blob&&(d=qt(d,d.name||un(c))),o.fire("load",d instanceof Blob?d:d?d.body:null)},d=>{o.fire("error",typeof d=="string"?{type:"error",code:0,body:d}:d)},(d,m,p)=>{if(p&&(t.size=p),t.duration=Date.now()-t.timestamp,!d){t.progress=null;return}t.progress=m/p,o.fire("progress",t.progress)},()=>{o.fire("abort")},d=>{const m=rr(typeof d=="string"?d:d.headers);o.fire("meta",{size:t.size||m.size,filename:m.name,source:m.source})})},o={...Wn(),setSource:c=>t.source=c,getProgress:n,abort:s,load:i};return o},Ii=e=>/GET|HEAD/.test(e),St=(e,t,n)=>{const s={onheaders:()=>{},onprogress:()=>{},onload:()=>{},ontimeout:()=>{},onerror:()=>{},onabort:()=>{},abort:()=>{i=!0,o.abort()}};let i=!1,l=!1;n={method:"POST",headers:{},withCredentials:!1,...n},t=encodeURI(t),Ii(n.method)&&e&&(t=`${t}${encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))}`);const o=new XMLHttpRequest,c=Ii(n.method)?o:o.upload;return c.onprogress=d=>{i||s.onprogress(d.lengthComputable,d.loaded,d.total)},o.onreadystatechange=()=>{o.readyState<2||o.readyState===4&&o.status===0||l||(l=!0,s.onheaders(o))},o.onload=()=>{o.status>=200&&o.status<300?s.onload(o):s.onerror(o)},o.onerror=()=>s.onerror(o),o.onabort=()=>{i=!0,s.onabort()},o.ontimeout=()=>s.ontimeout(o),o.open(n.method,t,!0),Yt(n.timeout)&&(o.timeout=n.timeout),Object.keys(n.headers).forEach(d=>{const m=unescape(encodeURIComponent(n.headers[d]));o.setRequestHeader(d,m)}),n.responseType&&(o.responseType=n.responseType),n.withCredentials&&(o.withCredentials=!0),o.send(e),s},ye=(e,t,n,s)=>({type:e,code:t,body:n,headers:s}),wt=e=>t=>{e(ye("error",0,"Timeout",t.getAllResponseHeaders()))},vi=e=>/\?/.test(e),dn=(...e)=>{let t="";return e.forEach(n=>{t+=vi(t)&&vi(n)?n.replace(/\?/,"&"):n}),t},As=(e="",t)=>{if(typeof t=="function")return t;if(!t||!Be(t.url))return null;const n=t.onload||(i=>i),s=t.onerror||(i=>null);return(i,l,o,c,d,m)=>{const p=St(i,dn(e,t.url),{...t,responseType:"blob"});return p.onload=b=>{const I=b.getAllResponseHeaders(),y=rr(I).name||un(i);l(ye("load",b.status,t.method==="HEAD"?null:qt(n(b.response),y),I))},p.onerror=b=>{o(ye("error",b.status,s(b.response)||b.statusText,b.getAllResponseHeaders()))},p.onheaders=b=>{m(ye("headers",b.status,null,b.getAllResponseHeaders()))},p.ontimeout=wt(o),p.onprogress=c,p.onabort=d,p}},Ke={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4},gu=(e,t,n,s,i,l,o,c,d,m,p)=>{const b=[],{chunkTransferId:I,chunkServer:y,chunkSize:f,chunkRetryDelays:v}=p,O={serverId:I,aborted:!1},_=t.ondata||(P=>P),L=t.onload||((P,Z)=>Z==="HEAD"?P.getResponseHeader("Upload-Offset"):P.response),D=t.onerror||(P=>null),U=P=>{const Z=new FormData;xe(i)&&Z.append(n,JSON.stringify(i));const N=typeof t.headers=="function"?t.headers(s,i):{...t.headers,"Upload-Length":s.size},C={...t,headers:N},B=St(_(Z),dn(e,t.url),C);B.onload=F=>P(L(F,C.method)),B.onerror=F=>o(ye("error",F.status,D(F.response)||F.statusText,F.getAllResponseHeaders())),B.ontimeout=wt(o)},k=P=>{const Z=dn(e,y.url,O.serverId),C={headers:typeof t.headers=="function"?t.headers(O.serverId):{...t.headers},method:"HEAD"},B=St(null,Z,C);B.onload=F=>P(L(F,C.method)),B.onerror=F=>o(ye("error",F.status,D(F.response)||F.statusText,F.getAllResponseHeaders())),B.ontimeout=wt(o)},V=Math.floor(s.size/f);for(let P=0;P<=V;P++){const Z=P*f,N=s.slice(Z,Z+f,"application/offset+octet-stream");b[P]={index:P,size:N.size,offset:Z,data:N,file:s,progress:0,retries:[...v],status:Ke.QUEUED,error:null,request:null,timeout:null}}const te=()=>l(O.serverId),M=P=>P.status===Ke.QUEUED||P.status===Ke.ERROR,Y=P=>{if(O.aborted)return;if(P=P||b.find(M),!P){b.every(J=>J.status===Ke.COMPLETE)&&te();return}P.status=Ke.PROCESSING,P.progress=null;const Z=y.ondata||(J=>J),N=y.onerror||(J=>null),C=dn(e,y.url,O.serverId),B=typeof y.headers=="function"?y.headers(P):{...y.headers,"Content-Type":"application/offset+octet-stream","Upload-Offset":P.offset,"Upload-Length":s.size,"Upload-Name":s.name},F=P.request=St(Z(P.data),C,{...y,headers:B});F.onload=()=>{P.status=Ke.COMPLETE,P.request=null,z()},F.onprogress=(J,S,Ye)=>{P.progress=J?S:null,w()},F.onerror=J=>{P.status=Ke.ERROR,P.request=null,P.error=N(J.response)||J.statusText,X(P)||o(ye("error",J.status,N(J.response)||J.statusText,J.getAllResponseHeaders()))},F.ontimeout=J=>{P.status=Ke.ERROR,P.request=null,X(P)||wt(o)(J)},F.onabort=()=>{P.status=Ke.QUEUED,P.request=null,d()}},X=P=>P.retries.length===0?!1:(P.status=Ke.WAITING,clearTimeout(P.timeout),P.timeout=setTimeout(()=>{Y(P)},P.retries.shift()),!0),w=()=>{const P=b.reduce((N,C)=>N===null||C.progress===null?null:N+C.progress,0);if(P===null)return c(!1,0,0);const Z=b.reduce((N,C)=>N+C.size,0);c(!0,P,Z)},z=()=>{b.filter(Z=>Z.status===Ke.PROCESSING).length>=1||Y()},Ee=()=>{b.forEach(P=>{clearTimeout(P.timeout),P.request&&P.request.abort()})};return O.serverId?k(P=>{O.aborted||(b.filter(Z=>Z.offset<P).forEach(Z=>{Z.status=Ke.COMPLETE,Z.progress=Z.size}),z())}):U(P=>{O.aborted||(m(P),O.serverId=P,z())}),{abort:()=>{O.aborted=!0,Ee()}}},Eu=(e,t,n,s)=>(i,l,o,c,d,m,p)=>{if(!i)return;const b=s.chunkUploads,I=b&&i.size>s.chunkSize,y=b&&(I||s.chunkForce);if(i instanceof Blob&&y)return gu(e,t,n,i,l,o,c,d,m,p,s);const f=t.ondata||(k=>k),v=t.onload||(k=>k),O=t.onerror||(k=>null),_=typeof t.headers=="function"?t.headers(i,l)||{}:{...t.headers},L={...t,headers:_};var D=new FormData;xe(l)&&D.append(n,JSON.stringify(l)),(i instanceof Blob?[{name:null,file:i}]:i).forEach(k=>{D.append(n,k.file,k.name===null?k.file.name:`${k.name}${k.file.name}`)});const U=St(f(D),dn(e,t.url),L);return U.onload=k=>{o(ye("load",k.status,v(k.response),k.getAllResponseHeaders()))},U.onerror=k=>{c(ye("error",k.status,O(k.response)||k.statusText,k.getAllResponseHeaders()))},U.ontimeout=wt(c),U.onprogress=d,U.onabort=m,U},bu=(e="",t,n,s)=>typeof t=="function"?(...i)=>t(n,...i,s):!t||!Be(t.url)?null:Eu(e,t,n,s),nn=(e="",t)=>{if(typeof t=="function")return t;if(!t||!Be(t.url))return(i,l)=>l();const n=t.onload||(i=>i),s=t.onerror||(i=>null);return(i,l,o)=>{const c=St(i,e+t.url,t);return c.onload=d=>{l(ye("load",d.status,n(d.response),d.getAllResponseHeaders()))},c.onerror=d=>{o(ye("error",d.status,s(d.response)||d.statusText,d.getAllResponseHeaders()))},c.ontimeout=wt(o),c}},wa=(e=0,t=1)=>e+Math.random()*(t-e),yu=(e,t=1e3,n=0,s=25,i=250)=>{let l=null;const o=Date.now(),c=()=>{let d=Date.now()-o,m=wa(s,i);d+m>t&&(m=d+m-t);let p=d/t;if(p>=1||document.hidden){e(1);return}e(p),l=setTimeout(c,m)};return t>0&&c(),{clear:()=>{clearTimeout(l)}}},Tu=(e,t)=>{const n={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},{allowMinimumUploadDuration:s}=t,i=(p,b)=>{const I=()=>{n.duration===0||n.progress===null||m.fire("progress",m.getProgress())},y=()=>{n.complete=!0,m.fire("load-perceived",n.response.body)};m.fire("start"),n.timestamp=Date.now(),n.perceivedPerformanceUpdater=yu(f=>{n.perceivedProgress=f,n.perceivedDuration=Date.now()-n.timestamp,I(),n.response&&n.perceivedProgress===1&&!n.complete&&y()},s?wa(750,1500):0),n.request=e(p,b,f=>{n.response=xe(f)?f:{type:"load",code:200,body:`${f}`,headers:{}},n.duration=Date.now()-n.timestamp,n.progress=1,m.fire("load",n.response.body),(!s||s&&n.perceivedProgress===1)&&y()},f=>{n.perceivedPerformanceUpdater.clear(),m.fire("error",xe(f)?f:{type:"error",code:0,body:`${f}`})},(f,v,O)=>{n.duration=Date.now()-n.timestamp,n.progress=f?v/O:null,I()},()=>{n.perceivedPerformanceUpdater.clear(),m.fire("abort",n.response?n.response.body:null)},f=>{m.fire("transfer",f)})},l=()=>{n.request&&(n.perceivedPerformanceUpdater.clear(),n.request.abort&&n.request.abort(),n.complete=!0)},o=()=>{l(),n.complete=!1,n.perceivedProgress=0,n.progress=0,n.timestamp=null,n.perceivedDuration=0,n.duration=0,n.request=null,n.response=null},c=s?()=>n.progress?Math.min(n.progress,n.perceivedProgress):null:()=>n.progress||null,d=s?()=>Math.min(n.duration,n.perceivedDuration):()=>n.duration,m={...Wn(),process:i,abort:l,getProgress:c,getDuration:d,reset:o};return m},Aa=e=>e.substring(0,e.lastIndexOf("."))||e,Iu=e=>{let t=[e.name,e.size,e.type];return e instanceof Blob||Bs(e)?t[0]=e.name||va():Bs(e)?(t[1]=e.length,t[2]=Sa(e)):Be(e)&&(t[0]=un(e),t[1]=0,t[2]="application/octet-stream"),{name:t[0],size:t[1],type:t[2]}},At=e=>!!(e instanceof File||e instanceof Blob&&e.name),Na=e=>{if(!xe(e))return e;const t=Yn(e)?[]:{};for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n];t[n]=s&&xe(s)?Na(s):s}return t},vu=(e=null,t=null,n=null)=>{const s=tr(),i={archived:!1,frozen:!1,released:!1,source:null,file:n,serverFileReference:t,transferId:null,processingAborted:!1,status:t?W.PROCESSING_COMPLETE:W.INIT,activeLoader:null,activeProcessor:null};let l=null;const o={},c=M=>i.status=M,d=(M,...Y)=>{i.released||i.frozen||V.fire(M,...Y)},m=()=>Kn(i.file.name),p=()=>i.file.type,b=()=>i.file.size,I=()=>i.file,y=(M,Y,X)=>{if(i.source=M,V.fireSync("init"),i.file){V.fireSync("load-skip");return}i.file=Iu(M),Y.on("init",()=>{d("load-init")}),Y.on("meta",w=>{i.file.size=w.size,i.file.filename=w.filename,w.source&&(e=Ce.LIMBO,i.serverFileReference=w.source,i.status=W.PROCESSING_COMPLETE),d("load-meta")}),Y.on("progress",w=>{c(W.LOADING),d("load-progress",w)}),Y.on("error",w=>{c(W.LOAD_ERROR),d("load-request-error",w)}),Y.on("abort",()=>{c(W.INIT),d("load-abort")}),Y.on("load",w=>{i.activeLoader=null;const z=P=>{i.file=At(P)?P:i.file,e===Ce.LIMBO&&i.serverFileReference?c(W.PROCESSING_COMPLETE):c(W.IDLE),d("load")},Ee=P=>{i.file=w,d("load-meta"),c(W.LOAD_ERROR),d("load-file-error",P)};if(i.serverFileReference){z(w);return}X(w,z,Ee)}),Y.setSource(M),i.activeLoader=Y,Y.load()},f=()=>{i.activeLoader&&i.activeLoader.load()},v=()=>{if(i.activeLoader){i.activeLoader.abort();return}c(W.INIT),d("load-abort")},O=(M,Y)=>{if(i.processingAborted){i.processingAborted=!1;return}if(c(W.PROCESSING),l=null,!(i.file instanceof Blob)){V.on("load",()=>{O(M,Y)});return}M.on("load",z=>{i.transferId=null,i.serverFileReference=z}),M.on("transfer",z=>{i.transferId=z}),M.on("load-perceived",z=>{i.activeProcessor=null,i.transferId=null,i.serverFileReference=z,c(W.PROCESSING_COMPLETE),d("process-complete",z)}),M.on("start",()=>{d("process-start")}),M.on("error",z=>{i.activeProcessor=null,c(W.PROCESSING_ERROR),d("process-error",z)}),M.on("abort",z=>{i.activeProcessor=null,i.serverFileReference=z,c(W.IDLE),d("process-abort"),l&&l()}),M.on("progress",z=>{d("process-progress",z)});const X=z=>{i.archived||M.process(z,{...o})},w=console.error;Y(i.file,X,w),i.activeProcessor=M},_=()=>{i.processingAborted=!1,c(W.PROCESSING_QUEUED)},L=()=>new Promise(M=>{if(!i.activeProcessor){i.processingAborted=!0,c(W.IDLE),d("process-abort"),M();return}l=()=>{M()},i.activeProcessor.abort()}),D=(M,Y)=>new Promise((X,w)=>{const z=i.serverFileReference!==null?i.serverFileReference:i.transferId;if(z===null){X();return}M(z,()=>{i.serverFileReference=null,i.transferId=null,X()},Ee=>{if(!Y){X();return}c(W.PROCESSING_REVERT_ERROR),d("process-revert-error"),w(Ee)}),c(W.IDLE),d("process-revert")}),U=(M,Y,X)=>{const w=M.split("."),z=w[0],Ee=w.pop();let P=o;w.forEach(Z=>P=P[Z]),JSON.stringify(P[Ee])!==JSON.stringify(Y)&&(P[Ee]=Y,d("metadata-update",{key:z,value:o[z],silent:X}))},V={id:{get:()=>s},origin:{get:()=>e,set:M=>e=M},serverId:{get:()=>i.serverFileReference},transferId:{get:()=>i.transferId},status:{get:()=>i.status},filename:{get:()=>i.file.name},filenameWithoutExtension:{get:()=>Aa(i.file.name)},fileExtension:{get:m},fileType:{get:p},fileSize:{get:b},file:{get:I},relativePath:{get:()=>i.file._relativePath},source:{get:()=>i.source},getMetadata:M=>Na(M?o[M]:o),setMetadata:(M,Y,X)=>{if(xe(M)){const w=M;return Object.keys(w).forEach(z=>{U(z,w[z],Y)}),M}return U(M,Y,X),Y},extend:(M,Y)=>te[M]=Y,abortLoad:v,retryLoad:f,requestProcessing:_,abortProcessing:L,load:y,process:O,revert:D,...Wn(),freeze:()=>i.frozen=!0,release:()=>i.released=!0,released:{get:()=>i.released},archive:()=>i.archived=!0,archived:{get:()=>i.archived},setFile:M=>i.file=M},te=_t(V);return te},Ru=(e,t)=>lt(t)?0:Be(t)?e.findIndex(n=>n.id===t):-1,Ri=(e,t)=>{const n=Ru(e,t);if(!(n<0))return e[n]||null},Si=(e,t,n,s,i,l)=>{const o=St(null,e,{method:"GET",responseType:"blob"});return o.onload=c=>{const d=c.getAllResponseHeaders(),m=rr(d).name||un(e);t(ye("load",c.status,qt(c.response,m),d))},o.onerror=c=>{n(ye("error",c.status,c.statusText,c.getAllResponseHeaders()))},o.onheaders=c=>{l(ye("headers",c.status,null,c.getAllResponseHeaders()))},o.ontimeout=wt(n),o.onprogress=s,o.onabort=i,o},wi=e=>(e.indexOf("//")===0&&(e=location.protocol+e),e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]),Su=e=>(e.indexOf(":")>-1||e.indexOf("//")>-1)&&wi(location.href)!==wi(e),wn=e=>(...t)=>vt(e)?e(...t):e,wu=e=>!At(e.file),Ns=(e,t)=>{clearTimeout(t.listUpdateTimeout),t.listUpdateTimeout=setTimeout(()=>{e("DID_UPDATE_ITEMS",{items:nt(t.items)})},0)},Ai=(e,...t)=>new Promise(n=>{if(!e)return n(!0);const s=e(...t);if(s==null)return n(!0);if(typeof s=="boolean")return n(s);typeof s.then=="function"&&s.then(n)}),Cs=(e,t)=>{e.items.sort((n,s)=>t(He(n),He(s)))},Xe=(e,t)=>({query:n,success:s=()=>{},failure:i=()=>{},...l}={})=>{const o=Rt(e.items,n);if(!o){i({error:ye("error",0,"Item not found"),file:null});return}t(o,s,i,l||{})},Au=(e,t,n)=>({ABORT_ALL:()=>{nt(n.items).forEach(s=>{s.freeze(),s.abortLoad(),s.abortProcessing()})},DID_SET_FILES:({value:s=[]})=>{const i=s.map(o=>({source:o.source?o.source:o,options:o.options}));let l=nt(n.items);l.forEach(o=>{i.find(c=>c.source===o.source||c.source===o.file)||e("REMOVE_ITEM",{query:o,remove:!1})}),l=nt(n.items),i.forEach((o,c)=>{l.find(d=>d.source===o.source||d.file===o.source)||e("ADD_ITEM",{...o,interactionMethod:Ze.NONE,index:c})})},DID_UPDATE_ITEM_METADATA:({id:s,action:i,change:l})=>{l.silent||(clearTimeout(n.itemUpdateTimeout),n.itemUpdateTimeout=setTimeout(()=>{const o=Ri(n.items,s);if(!t("IS_ASYNC")){et("SHOULD_PREPARE_OUTPUT",!1,{item:o,query:t,action:i,change:l}).then(p=>{const b=t("GET_BEFORE_PREPARE_FILE");b&&(p=b(o,p)),p&&e("REQUEST_PREPARE_OUTPUT",{query:s,item:o,success:I=>{e("DID_PREPARE_OUTPUT",{id:s,file:I})}},!0)});return}o.origin===Ce.LOCAL&&e("DID_LOAD_ITEM",{id:o.id,error:null,serverFileReference:o.source});const c=()=>{setTimeout(()=>{e("REQUEST_ITEM_PROCESSING",{query:s})},32)},d=p=>{o.revert(nn(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(p?c:()=>{}).catch(()=>{})},m=p=>{o.abortProcessing().then(p?c:()=>{})};if(o.status===W.PROCESSING_COMPLETE)return d(n.options.instantUpload);if(o.status===W.PROCESSING)return m(n.options.instantUpload);n.options.instantUpload&&c()},0))},MOVE_ITEM:({query:s,index:i})=>{const l=Rt(n.items,s);if(!l)return;const o=n.items.indexOf(l);i=Ia(i,0,n.items.length-1),o!==i&&n.items.splice(i,0,n.items.splice(o,1)[0])},SORT:({compare:s})=>{Cs(n,s),e("DID_SORT_ITEMS",{items:t("GET_ACTIVE_ITEMS")})},ADD_ITEMS:({items:s,index:i,interactionMethod:l,success:o=()=>{},failure:c=()=>{}})=>{let d=i;if(i===-1||typeof i>"u"){const y=t("GET_ITEM_INSERT_LOCATION"),f=t("GET_TOTAL_ITEMS");d=y==="before"?0:f}const m=t("GET_IGNORED_FILES"),p=y=>At(y)?!m.includes(y.name.toLowerCase()):!lt(y),I=s.filter(p).map(y=>new Promise((f,v)=>{e("ADD_ITEM",{interactionMethod:l,source:y.source||y,success:f,failure:v,index:d++,options:y.options||{}})}));Promise.all(I).then(o).catch(c)},ADD_ITEM:({source:s,index:i=-1,interactionMethod:l,success:o=()=>{},failure:c=()=>{},options:d={}})=>{if(lt(s)){c({error:ye("error",0,"No source"),file:null});return}if(At(s)&&n.options.ignoredFiles.includes(s.name.toLowerCase()))return;if(!su(n)){if(n.options.allowMultiple||!n.options.allowMultiple&&!n.options.allowReplace){const L=ye("warning",0,"Max files");e("DID_THROW_MAX_FILES",{source:s,error:L}),c({error:L,file:null});return}const _=nt(n.items)[0];if(_.status===W.PROCESSING_COMPLETE||_.status===W.PROCESSING_REVERT_ERROR){const L=t("GET_FORCE_REVERT");if(_.revert(nn(n.options.server.url,n.options.server.revert),L).then(()=>{L&&e("ADD_ITEM",{source:s,index:i,interactionMethod:l,success:o,failure:c,options:d})}).catch(()=>{}),L)return}e("REMOVE_ITEM",{query:_.id})}const m=d.type==="local"?Ce.LOCAL:d.type==="limbo"?Ce.LIMBO:Ce.INPUT,p=vu(m,m===Ce.INPUT?null:s,d.file);Object.keys(d.metadata||{}).forEach(_=>{p.setMetadata(_,d.metadata[_])}),Ct("DID_CREATE_ITEM",p,{query:t,dispatch:e});const b=t("GET_ITEM_INSERT_LOCATION");n.options.itemInsertLocationFreedom||(i=b==="before"?-1:n.items.length),iu(n.items,p,i),vt(b)&&s&&Cs(n,b);const I=p.id;p.on("init",()=>{e("DID_INIT_ITEM",{id:I})}),p.on("load-init",()=>{e("DID_START_ITEM_LOAD",{id:I})}),p.on("load-meta",()=>{e("DID_UPDATE_ITEM_META",{id:I})}),p.on("load-progress",_=>{e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:I,progress:_})}),p.on("load-request-error",_=>{const L=wn(n.options.labelFileLoadError)(_);if(_.code>=400&&_.code<500){e("DID_THROW_ITEM_INVALID",{id:I,error:_,status:{main:L,sub:`${_.code} (${_.body})`}}),c({error:_,file:He(p)});return}e("DID_THROW_ITEM_LOAD_ERROR",{id:I,error:_,status:{main:L,sub:n.options.labelTapToRetry}})}),p.on("load-file-error",_=>{e("DID_THROW_ITEM_INVALID",{id:I,error:_.status,status:_.status}),c({error:_.status,file:He(p)})}),p.on("load-abort",()=>{e("REMOVE_ITEM",{query:I})}),p.on("load-skip",()=>{p.on("metadata-update",_=>{At(p.file)&&e("DID_UPDATE_ITEM_METADATA",{id:I,change:_})}),e("COMPLETE_LOAD_ITEM",{query:I,item:p,data:{source:s,success:o}})}),p.on("load",()=>{const _=L=>{if(!L){e("REMOVE_ITEM",{query:I});return}p.on("metadata-update",D=>{e("DID_UPDATE_ITEM_METADATA",{id:I,change:D})}),et("SHOULD_PREPARE_OUTPUT",!1,{item:p,query:t}).then(D=>{const U=t("GET_BEFORE_PREPARE_FILE");U&&(D=U(p,D));const k=()=>{e("COMPLETE_LOAD_ITEM",{query:I,item:p,data:{source:s,success:o}}),Ns(e,n)};if(D){e("REQUEST_PREPARE_OUTPUT",{query:I,item:p,success:V=>{e("DID_PREPARE_OUTPUT",{id:I,file:V}),k()}},!0);return}k()})};et("DID_LOAD_ITEM",p,{query:t,dispatch:e}).then(()=>{Ai(t("GET_BEFORE_ADD_FILE"),He(p)).then(_)}).catch(L=>{if(!L||!L.error||!L.status)return _(!1);e("DID_THROW_ITEM_INVALID",{id:I,error:L.error,status:L.status})})}),p.on("process-start",()=>{e("DID_START_ITEM_PROCESSING",{id:I})}),p.on("process-progress",_=>{e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:I,progress:_})}),p.on("process-error",_=>{e("DID_THROW_ITEM_PROCESSING_ERROR",{id:I,error:_,status:{main:wn(n.options.labelFileProcessingError)(_),sub:n.options.labelTapToRetry}})}),p.on("process-revert-error",_=>{e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:I,error:_,status:{main:wn(n.options.labelFileProcessingRevertError)(_),sub:n.options.labelTapToRetry}})}),p.on("process-complete",_=>{e("DID_COMPLETE_ITEM_PROCESSING",{id:I,error:null,serverFileReference:_}),e("DID_DEFINE_VALUE",{id:I,value:_})}),p.on("process-abort",()=>{e("DID_ABORT_ITEM_PROCESSING",{id:I})}),p.on("process-revert",()=>{e("DID_REVERT_ITEM_PROCESSING",{id:I}),e("DID_DEFINE_VALUE",{id:I,value:null})}),e("DID_ADD_ITEM",{id:I,index:i,interactionMethod:l}),Ns(e,n);const{url:y,load:f,restore:v,fetch:O}=n.options.server||{};p.load(s,_u(m===Ce.INPUT?Be(s)&&Su(s)&&O?As(y,O):Si:m===Ce.LIMBO?As(y,v):As(y,f)),(_,L,D)=>{et("LOAD_FILE",_,{query:t}).then(L).catch(D)})},REQUEST_PREPARE_OUTPUT:({item:s,success:i,failure:l=()=>{}})=>{const o={error:ye("error",0,"Item not found"),file:null};if(s.archived)return l(o);et("PREPARE_OUTPUT",s.file,{query:t,item:s}).then(c=>{et("COMPLETE_PREPARE_OUTPUT",c,{query:t,item:s}).then(d=>{if(s.archived)return l(o);i(d)})})},COMPLETE_LOAD_ITEM:({item:s,data:i})=>{const{success:l,source:o}=i,c=t("GET_ITEM_INSERT_LOCATION");if(vt(c)&&o&&Cs(n,c),e("DID_LOAD_ITEM",{id:s.id,error:null,serverFileReference:s.origin===Ce.INPUT?null:o}),l(He(s)),s.origin===Ce.LOCAL){e("DID_LOAD_LOCAL_ITEM",{id:s.id});return}if(s.origin===Ce.LIMBO){e("DID_COMPLETE_ITEM_PROCESSING",{id:s.id,error:null,serverFileReference:o}),e("DID_DEFINE_VALUE",{id:s.id,value:s.serverId||o});return}t("IS_ASYNC")&&n.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:s.id})},RETRY_ITEM_LOAD:Xe(n,s=>{s.retryLoad()}),REQUEST_ITEM_PREPARE:Xe(n,(s,i,l)=>{e("REQUEST_PREPARE_OUTPUT",{query:s.id,item:s,success:o=>{e("DID_PREPARE_OUTPUT",{id:s.id,file:o}),i({file:s,output:o})},failure:l},!0)}),REQUEST_ITEM_PROCESSING:Xe(n,(s,i,l)=>{if(!(s.status===W.IDLE||s.status===W.PROCESSING_ERROR)){const c=()=>e("REQUEST_ITEM_PROCESSING",{query:s,success:i,failure:l}),d=()=>document.hidden?c():setTimeout(c,32);s.status===W.PROCESSING_COMPLETE||s.status===W.PROCESSING_REVERT_ERROR?s.revert(nn(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(d).catch(()=>{}):s.status===W.PROCESSING&&s.abortProcessing().then(d);return}s.status!==W.PROCESSING_QUEUED&&(s.requestProcessing(),e("DID_REQUEST_ITEM_PROCESSING",{id:s.id}),e("PROCESS_ITEM",{query:s,success:i,failure:l},!0))}),PROCESS_ITEM:Xe(n,(s,i,l)=>{const o=t("GET_MAX_PARALLEL_UPLOADS");if(t("GET_ITEMS_BY_STATUS",W.PROCESSING).length===o){n.processingQueue.push({id:s.id,success:i,failure:l});return}if(s.status===W.PROCESSING)return;const d=()=>{const p=n.processingQueue.shift();if(!p)return;const{id:b,success:I,failure:y}=p,f=Rt(n.items,b);if(!f||f.archived){d();return}e("PROCESS_ITEM",{query:b,success:I,failure:y},!0)};s.onOnce("process-complete",()=>{i(He(s)),d();const p=n.options.server;if(n.options.instantUpload&&s.origin===Ce.LOCAL&&vt(p.remove)){const y=()=>{};s.origin=Ce.LIMBO,n.options.server.remove(s.source,y,y)}t("GET_ITEMS_BY_STATUS",W.PROCESSING_COMPLETE).length===n.items.length&&e("DID_COMPLETE_ITEM_PROCESSING_ALL")}),s.onOnce("process-error",p=>{l({error:p,file:He(s)}),d()});const m=n.options;s.process(Tu(bu(m.server.url,m.server.process,m.name,{chunkTransferId:s.transferId,chunkServer:m.server.patch,chunkUploads:m.chunkUploads,chunkForce:m.chunkForce,chunkSize:m.chunkSize,chunkRetryDelays:m.chunkRetryDelays}),{allowMinimumUploadDuration:t("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),(p,b,I)=>{et("PREPARE_OUTPUT",p,{query:t,item:s}).then(y=>{e("DID_PREPARE_OUTPUT",{id:s.id,file:y}),b(y)}).catch(I)})}),RETRY_ITEM_PROCESSING:Xe(n,s=>{e("REQUEST_ITEM_PROCESSING",{query:s})}),REQUEST_REMOVE_ITEM:Xe(n,s=>{Ai(t("GET_BEFORE_REMOVE_FILE"),He(s)).then(i=>{i&&e("REMOVE_ITEM",{query:s})})}),RELEASE_ITEM:Xe(n,s=>{s.release()}),REMOVE_ITEM:Xe(n,(s,i,l,o)=>{const c=()=>{const m=s.id;Ri(n.items,m).archive(),e("DID_REMOVE_ITEM",{error:null,id:m,item:s}),Ns(e,n),i(He(s))},d=n.options.server;s.origin===Ce.LOCAL&&d&&vt(d.remove)&&o.remove!==!1?(e("DID_START_ITEM_REMOVE",{id:s.id}),d.remove(s.source,()=>c(),m=>{e("DID_THROW_ITEM_REMOVE_ERROR",{id:s.id,error:ye("error",0,m,null),status:{main:wn(n.options.labelFileRemoveError)(m),sub:n.options.labelTapToRetry}})})):((o.revert&&s.origin!==Ce.LOCAL&&s.serverId!==null||n.options.chunkUploads&&s.file.size>n.options.chunkSize||n.options.chunkUploads&&n.options.chunkForce)&&s.revert(nn(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")),c())}),ABORT_ITEM_LOAD:Xe(n,s=>{s.abortLoad()}),ABORT_ITEM_PROCESSING:Xe(n,s=>{if(s.serverId){e("REVERT_ITEM_PROCESSING",{id:s.id});return}s.abortProcessing().then(()=>{n.options.instantUpload&&e("REMOVE_ITEM",{query:s.id})})}),REQUEST_REVERT_ITEM_PROCESSING:Xe(n,s=>{if(!n.options.instantUpload){e("REVERT_ITEM_PROCESSING",{query:s});return}const i=c=>{c&&e("REVERT_ITEM_PROCESSING",{query:s})},l=t("GET_BEFORE_REMOVE_FILE");if(!l)return i(!0);const o=l(He(s));if(o==null)return i(!0);if(typeof o=="boolean")return i(o);typeof o.then=="function"&&o.then(i)}),REVERT_ITEM_PROCESSING:Xe(n,s=>{s.revert(nn(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(()=>{(n.options.instantUpload||wu(s))&&e("REMOVE_ITEM",{query:s.id})}).catch(()=>{})}),SET_OPTIONS:({options:s})=>{const i=Object.keys(s),l=Nu.filter(c=>i.includes(c));[...l,...Object.keys(s).filter(c=>!l.includes(c))].forEach(c=>{e(`SET_${$n(c,"_").toUpperCase()}`,{value:s[c]})})}}),Nu=["server"],ir=e=>e,ct=e=>document.createElement(e),Te=(e,t)=>{let n=e.childNodes[0];n?t!==n.nodeValue&&(n.nodeValue=t):(n=document.createTextNode(t),e.appendChild(n))},Ni=(e,t,n,s)=>{const i=(s%360-90)*Math.PI/180;return{x:e+n*Math.cos(i),y:t+n*Math.sin(i)}},Cu=(e,t,n,s,i,l)=>{const o=Ni(e,t,n,i),c=Ni(e,t,n,s);return["M",o.x,o.y,"A",n,n,0,l,0,c.x,c.y].join(" ")},xu=(e,t,n,s,i)=>{let l=1;return i>s&&i-s<=.5&&(l=0),s>i&&s-i>=.5&&(l=0),Cu(e,t,n,Math.min(.9999,s)*360,Math.min(.9999,i)*360,l)},Ou=({root:e,props:t})=>{t.spin=!1,t.progress=0,t.opacity=0;const n=Gn("svg");e.ref.path=Gn("path",{"stroke-width":2,"stroke-linecap":"round"}),n.appendChild(e.ref.path),e.ref.svg=n,e.appendChild(n)},Pu=({root:e,props:t})=>{if(t.opacity===0)return;t.align&&(e.element.dataset.align=t.align);const n=parseInt(we(e.ref.path,"stroke-width"),10),s=e.rect.element.width*.5;let i=0,l=0;t.spin?(i=0,l=.5):(i=0,l=t.progress);const o=xu(s,s,s-n,i,l);we(e.ref.path,"d",o),we(e.ref.path,"stroke-opacity",t.spin||t.progress>0?1:0)},Ci=Re({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:Ou,write:Pu,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),Lu=({root:e,props:t})=>{e.element.innerHTML=(t.icon||"")+`<span>${t.label}</span>`,t.isDisabled=!1},Du=({root:e,props:t})=>{const{isDisabled:n}=t,s=e.query("GET_DISABLED")||t.opacity===0;s&&!n?(t.isDisabled=!0,we(e.element,"disabled","disabled")):!s&&n&&(t.isDisabled=!1,e.element.removeAttribute("disabled"))},Ca=Re({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:Lu,write:Du}),xa=(e,t=".",n=1e3,s={})=>{const{labelBytes:i="bytes",labelKilobytes:l="KB",labelMegabytes:o="MB",labelGigabytes:c="GB"}=s;e=Math.round(Math.abs(e));const d=n,m=n*n,p=n*n*n;return e<d?`${e} ${i}`:e<m?`${Math.floor(e/d)} ${l}`:e<p?`${xi(e/m,1,t)} ${o}`:`${xi(e/p,2,t)} ${c}`},xi=(e,t,n)=>e.toFixed(t).split(".").filter(s=>s!=="0").join(n),Mu=({root:e,props:t})=>{const n=ct("span");n.className="filepond--file-info-main",we(n,"aria-hidden","true"),e.appendChild(n),e.ref.fileName=n;const s=ct("span");s.className="filepond--file-info-sub",e.appendChild(s),e.ref.fileSize=s,Te(s,e.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),Te(n,ir(e.query("GET_ITEM_NAME",t.id)))},Fs=({root:e,props:t})=>{Te(e.ref.fileSize,xa(e.query("GET_ITEM_SIZE",t.id),".",e.query("GET_FILE_SIZE_BASE"),e.query("GET_FILE_SIZE_LABELS",e.query))),Te(e.ref.fileName,ir(e.query("GET_ITEM_NAME",t.id)))},Oi=({root:e,props:t})=>{if(Yt(e.query("GET_ITEM_SIZE",t.id))){Fs({root:e,props:t});return}Te(e.ref.fileSize,e.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},ku=Re({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:Fe({DID_LOAD_ITEM:Fs,DID_UPDATE_ITEM_META:Fs,DID_THROW_ITEM_LOAD_ERROR:Oi,DID_THROW_ITEM_INVALID:Oi}),didCreateView:e=>{Ct("CREATE_VIEW",{...e,view:e})},create:Mu,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),Oa=e=>Math.round(e*100),Uu=({root:e})=>{const t=ct("span");t.className="filepond--file-status-main",e.appendChild(t),e.ref.main=t;const n=ct("span");n.className="filepond--file-status-sub",e.appendChild(n),e.ref.sub=n,Pa({root:e,action:{progress:null}})},Pa=({root:e,action:t})=>{const n=t.progress===null?e.query("GET_LABEL_FILE_LOADING"):`${e.query("GET_LABEL_FILE_LOADING")} ${Oa(t.progress)}%`;Te(e.ref.main,n),Te(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},Bu=({root:e,action:t})=>{const n=t.progress===null?e.query("GET_LABEL_FILE_PROCESSING"):`${e.query("GET_LABEL_FILE_PROCESSING")} ${Oa(t.progress)}%`;Te(e.ref.main,n),Te(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},Fu=({root:e})=>{Te(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING")),Te(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},Gu=({root:e})=>{Te(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_ABORTED")),Te(e.ref.sub,e.query("GET_LABEL_TAP_TO_RETRY"))},Vu=({root:e})=>{Te(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),Te(e.ref.sub,e.query("GET_LABEL_TAP_TO_UNDO"))},Pi=({root:e})=>{Te(e.ref.main,""),Te(e.ref.sub,"")},sn=({root:e,action:t})=>{Te(e.ref.main,t.status.main),Te(e.ref.sub,t.status.sub)},Hu=Re({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:Fe({DID_LOAD_ITEM:Pi,DID_REVERT_ITEM_PROCESSING:Pi,DID_REQUEST_ITEM_PROCESSING:Fu,DID_ABORT_ITEM_PROCESSING:Gu,DID_COMPLETE_ITEM_PROCESSING:Vu,DID_UPDATE_ITEM_PROCESS_PROGRESS:Bu,DID_UPDATE_ITEM_LOAD_PROGRESS:Pa,DID_THROW_ITEM_LOAD_ERROR:sn,DID_THROW_ITEM_INVALID:sn,DID_THROW_ITEM_PROCESSING_ERROR:sn,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:sn,DID_THROW_ITEM_REMOVE_ERROR:sn}),didCreateView:e=>{Ct("CREATE_VIEW",{...e,view:e})},create:Uu,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),Gs={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},Vs=[];ge(Gs,e=>{Vs.push(e)});const qe=e=>{if(Hs(e)==="right")return 0;const t=e.ref.buttonRemoveItem.rect.element;return t.hidden?null:t.width+t.left},ju=e=>e.ref.buttonAbortItemLoad.rect.element.width,An=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.height/4),qu=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.left/2),Yu=e=>e.query("GET_STYLE_LOAD_INDICATOR_POSITION"),zu=e=>e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION"),Hs=e=>e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION"),$u={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:Yu},processProgressIndicator:{opacity:0,align:zu},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},Li={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:qe},status:{translateX:qe}},xs={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},Ht={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:qe},status:{translateX:qe,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:qe},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:Hs},info:{translateX:qe},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:Hs},buttonRemoveItem:{opacity:1},info:{translateX:qe},status:{opacity:1,translateX:qe}},DID_LOAD_ITEM:Li,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:qe},status:{translateX:qe}},DID_START_ITEM_PROCESSING:xs,DID_REQUEST_ITEM_PROCESSING:xs,DID_UPDATE_ITEM_PROCESS_PROGRESS:xs,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:qe}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:qe},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:Li},Wu=Re({create:({root:e})=>{e.element.innerHTML=e.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),Ku=({root:e,props:t})=>{const n=Object.keys(Gs).reduce((f,v)=>(f[v]={...Gs[v]},f),{}),{id:s}=t,i=e.query("GET_ALLOW_REVERT"),l=e.query("GET_ALLOW_REMOVE"),o=e.query("GET_ALLOW_PROCESS"),c=e.query("GET_INSTANT_UPLOAD"),d=e.query("IS_ASYNC"),m=e.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");let p;d?o&&!i?p=f=>!/RevertItemProcessing/.test(f):!o&&i?p=f=>!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(f):!o&&!i&&(p=f=>!/Process/.test(f)):p=f=>!/Process/.test(f);const b=p?Vs.filter(p):Vs.concat();if(c&&i&&(n.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",n.RevertItemProcessing.icon="GET_ICON_REMOVE"),d&&!i){const f=Ht.DID_COMPLETE_ITEM_PROCESSING;f.info.translateX=qu,f.info.translateY=An,f.status.translateY=An,f.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(d&&!o&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach(f=>{Ht[f].status.translateY=An}),Ht.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=ju),m&&i){n.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";const f=Ht.DID_COMPLETE_ITEM_PROCESSING;f.info.translateX=qe,f.status.translateY=An,f.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}l||(n.RemoveItem.disabled=!0),ge(n,(f,v)=>{const O=e.createChildView(Ca,{label:e.query(v.label),icon:e.query(v.icon),opacity:0});b.includes(f)&&e.appendChildView(O),v.disabled&&(O.element.setAttribute("disabled","disabled"),O.element.setAttribute("hidden","hidden")),O.element.dataset.align=e.query(`GET_STYLE_${v.align}`),O.element.classList.add(v.className),O.on("click",_=>{_.stopPropagation(),!v.disabled&&e.dispatch(v.action,{query:s})}),e.ref[`button${f}`]=O}),e.ref.processingCompleteIndicator=e.appendChildView(e.createChildView(Wu)),e.ref.processingCompleteIndicator.element.dataset.align=e.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),e.ref.info=e.appendChildView(e.createChildView(ku,{id:s})),e.ref.status=e.appendChildView(e.createChildView(Hu,{id:s}));const I=e.appendChildView(e.createChildView(Ci,{opacity:0,align:e.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));I.element.classList.add("filepond--load-indicator"),e.ref.loadProgressIndicator=I;const y=e.appendChildView(e.createChildView(Ci,{opacity:0,align:e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));y.element.classList.add("filepond--process-indicator"),e.ref.processProgressIndicator=y,e.ref.activeStyles=[]},Xu=({root:e,actions:t,props:n})=>{Qu({root:e,actions:t,props:n});let s=t.concat().filter(i=>/^DID_/.test(i.type)).reverse().find(i=>Ht[i.type]);if(s){e.ref.activeStyles=[];const i=Ht[s.type];ge($u,(l,o)=>{const c=e.ref[l];ge(o,(d,m)=>{const p=i[l]&&typeof i[l][d]<"u"?i[l][d]:m;e.ref.activeStyles.push({control:c,key:d,value:p})})})}e.ref.activeStyles.forEach(({control:i,key:l,value:o})=>{i[l]=typeof o=="function"?o(e):o})},Qu=Fe({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:({root:e,action:t})=>{e.ref.buttonAbortItemProcessing.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:({root:e,action:t})=>{e.ref.buttonAbortItemLoad.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:({root:e,action:t})=>{e.ref.buttonAbortItemRemoval.label=t.value},DID_REQUEST_ITEM_PROCESSING:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:({root:e})=>{e.ref.loadProgressIndicator.spin=!0,e.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:({root:e,action:t})=>{e.ref.loadProgressIndicator.spin=!1,e.ref.loadProgressIndicator.progress=t.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:({root:e,action:t})=>{e.ref.processProgressIndicator.spin=!1,e.ref.processProgressIndicator.progress=t.progress}}),Zu=Re({create:Ku,write:Xu,didCreateView:e=>{Ct("CREATE_VIEW",{...e,view:e})},name:"file"}),Ju=({root:e,props:t})=>{e.ref.fileName=ct("legend"),e.appendChild(e.ref.fileName),e.ref.file=e.appendChildView(e.createChildView(Zu,{id:t.id})),e.ref.data=!1},ep=({root:e,props:t})=>{Te(e.ref.fileName,ir(e.query("GET_ITEM_NAME",t.id)))},tp=Re({create:Ju,ignoreRect:!0,write:Fe({DID_LOAD_ITEM:ep}),didCreateView:e=>{Ct("CREATE_VIEW",{...e,view:e})},tag:"fieldset",name:"file-wrapper"}),Di={type:"spring",damping:.6,mass:7},np=({root:e,props:t})=>{[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:Di},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:Di},styles:["translateY"]}}].forEach(n=>{sp(e,n,t.name)}),e.element.classList.add(`filepond--${t.name}`),e.ref.scalable=null},sp=(e,t,n)=>{const s=Re({name:`panel-${t.name} filepond--${n}`,mixins:t.mixins,ignoreRectUpdate:!0}),i=e.createChildView(s,t.props);e.ref[t.name]=e.appendChildView(i)},rp=({root:e,props:t})=>{if((e.ref.scalable===null||t.scalable!==e.ref.scalable)&&(e.ref.scalable=fa(t.scalable)?t.scalable:!0,e.element.dataset.scalable=e.ref.scalable),!t.height)return;const n=e.ref.top.rect.element,s=e.ref.bottom.rect.element,i=Math.max(n.height+s.height,t.height);e.ref.center.translateY=n.height,e.ref.center.scaleY=(i-n.height-s.height)/100,e.ref.bottom.translateY=i-s.height},La=Re({name:"panel",read:({root:e,props:t})=>t.heightCurrent=e.ref.bottom.translateY,write:rp,create:np,ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),ip=e=>{const t=e.map(s=>s.id);let n;return{setIndex:s=>{n=s},getIndex:()=>n,getItemIndex:s=>t.indexOf(s.id)}},Mi={type:"spring",stiffness:.75,damping:.45,mass:10},ki="spring",Ui={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},ap=({root:e,props:t})=>{if(e.ref.handleClick=s=>e.dispatch("DID_ACTIVATE_ITEM",{id:t.id}),e.element.id=`filepond--item-${t.id}`,e.element.addEventListener("click",e.ref.handleClick),e.ref.container=e.appendChildView(e.createChildView(tp,{id:t.id})),e.ref.panel=e.appendChildView(e.createChildView(La,{name:"item-panel"})),e.ref.panel.height=null,t.markedForRemoval=!1,!e.query("GET_ALLOW_REORDER"))return;e.element.dataset.dragState="idle";const n=s=>{if(!s.isPrimary)return;let i=!1;const l={x:s.pageX,y:s.pageY};t.dragOrigin={x:e.translateX,y:e.translateY},t.dragCenter={x:s.offsetX,y:s.offsetY};const o=ip(e.query("GET_ACTIVE_ITEMS"));e.dispatch("DID_GRAB_ITEM",{id:t.id,dragState:o});const c=b=>{if(!b.isPrimary)return;b.stopPropagation(),b.preventDefault(),t.dragOffset={x:b.pageX-l.x,y:b.pageY-l.y},t.dragOffset.x*t.dragOffset.x+t.dragOffset.y*t.dragOffset.y>16&&!i&&(i=!0,e.element.removeEventListener("click",e.ref.handleClick)),e.dispatch("DID_DRAG_ITEM",{id:t.id,dragState:o})},d=b=>{b.isPrimary&&(t.dragOffset={x:b.pageX-l.x,y:b.pageY-l.y},p())},m=()=>{p()},p=()=>{document.removeEventListener("pointercancel",m),document.removeEventListener("pointermove",c),document.removeEventListener("pointerup",d),e.dispatch("DID_DROP_ITEM",{id:t.id,dragState:o}),i&&setTimeout(()=>e.element.addEventListener("click",e.ref.handleClick),0)};document.addEventListener("pointercancel",m),document.addEventListener("pointermove",c),document.addEventListener("pointerup",d)};e.element.addEventListener("pointerdown",n)},op=Fe({DID_UPDATE_PANEL_HEIGHT:({root:e,action:t})=>{e.height=t.height}}),lp=Fe({DID_GRAB_ITEM:({root:e,props:t})=>{t.dragOrigin={x:e.translateX,y:e.translateY}},DID_DRAG_ITEM:({root:e})=>{e.element.dataset.dragState="drag"},DID_DROP_ITEM:({root:e,props:t})=>{t.dragOffset=null,t.dragOrigin=null,e.element.dataset.dragState="drop"}},({root:e,actions:t,props:n,shouldOptimize:s})=>{e.element.dataset.dragState==="drop"&&e.scaleX<=1&&(e.element.dataset.dragState="idle");let i=t.concat().filter(o=>/^DID_/.test(o.type)).reverse().find(o=>Ui[o.type]);i&&i.type!==n.currentState&&(n.currentState=i.type,e.element.dataset.filepondItemState=Ui[n.currentState]||"");const l=e.query("GET_ITEM_PANEL_ASPECT_RATIO")||e.query("GET_PANEL_ASPECT_RATIO");l?s||(e.height=e.rect.element.width*l):(op({root:e,actions:t,props:n}),!e.height&&e.ref.container.rect.element.height>0&&(e.height=e.ref.container.rect.element.height)),s&&(e.ref.panel.height=null),e.ref.panel.height=e.height}),cp=Re({create:ap,write:lp,destroy:({root:e,props:t})=>{e.element.removeEventListener("click",e.ref.handleClick),e.dispatch("RELEASE_ITEM",{query:t.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:ki,scaleY:ki,translateX:Mi,translateY:Mi,opacity:{type:"tween",duration:150}}}});var ar=(e,t)=>Math.max(1,Math.floor((e+1)/t));const or=(e,t,n)=>{if(!n)return;const s=e.rect.element.width,i=t.length;let l=null;if(i===0||n.top<t[0].rect.element.top)return-1;const c=t[0].rect.element,d=c.marginLeft+c.marginRight,m=c.width+d,p=ar(s,m);if(p===1){for(let y=0;y<i;y++){const f=t[y],v=f.rect.outer.top+f.rect.element.height*.5;if(n.top<v)return y}return i}const b=c.marginTop+c.marginBottom,I=c.height+b;for(let y=0;y<i;y++){const f=y%p,v=Math.floor(y/p),O=f*m,_=v*I,L=_-c.marginTop,D=O+m,U=_+I+c.marginBottom;if(n.top<U&&n.top>L){if(n.left<D)return y;y!==i-1?l=y:l=null}}return l!==null?l:i},Nn={height:0,width:0,get getHeight(){return this.height},set setHeight(e){(this.height===0||e===0)&&(this.height=e)},get getWidth(){return this.width},set setWidth(e){(this.width===0||e===0)&&(this.width=e)},setDimensions:function(e,t){(this.height===0||e===0)&&(this.height=e),(this.width===0||t===0)&&(this.width=t)}},dp=({root:e})=>{we(e.element,"role","list"),e.ref.lastItemSpanwDate=Date.now()},up=({root:e,action:t})=>{const{id:n,index:s,interactionMethod:i}=t;e.ref.addIndex=s;const l=Date.now();let o=l,c=1;if(i!==Ze.NONE){c=0;const d=e.query("GET_ITEM_INSERT_INTERVAL"),m=l-e.ref.lastItemSpanwDate;o=m<d?l+(d-m):l}e.ref.lastItemSpanwDate=o,e.appendChildView(e.createChildView(cp,{spawnDate:o,id:n,opacity:c,interactionMethod:i}),s)},Bi=(e,t,n,s=0,i=1)=>{e.dragOffset?(e.translateX=null,e.translateY=null,e.translateX=e.dragOrigin.x+e.dragOffset.x,e.translateY=e.dragOrigin.y+e.dragOffset.y,e.scaleX=1.025,e.scaleY=1.025):(e.translateX=t,e.translateY=n,Date.now()>e.spawnDate&&(e.opacity===0&&pp(e,t,n,s,i),e.scaleX=1,e.scaleY=1,e.opacity=1))},pp=(e,t,n,s,i)=>{e.interactionMethod===Ze.NONE?(e.translateX=null,e.translateX=t,e.translateY=null,e.translateY=n):e.interactionMethod===Ze.DROP?(e.translateX=null,e.translateX=t-s*20,e.translateY=null,e.translateY=n-i*10,e.scaleX=.8,e.scaleY=.8):e.interactionMethod===Ze.BROWSE?(e.translateY=null,e.translateY=n-30):e.interactionMethod===Ze.API&&(e.translateX=null,e.translateX=t-30,e.translateY=null)},hp=({root:e,action:t})=>{const{id:n}=t,s=e.childViews.find(i=>i.id===n);s&&(s.scaleX=.9,s.scaleY=.9,s.opacity=0,s.markedForRemoval=!0)},Os=e=>e.rect.element.height+e.rect.element.marginBottom*.5+e.rect.element.marginTop*.5,fp=e=>e.rect.element.width+e.rect.element.marginLeft*.5+e.rect.element.marginRight*.5,mp=({root:e,action:t})=>{const{id:n,dragState:s}=t,i=e.query("GET_ITEM",{id:n}),l=e.childViews.find(O=>O.id===n),o=e.childViews.length,c=s.getItemIndex(i);if(!l)return;const d={x:l.dragOrigin.x+l.dragOffset.x+l.dragCenter.x,y:l.dragOrigin.y+l.dragOffset.y+l.dragCenter.y},m=Os(l),p=fp(l);let b=Math.floor(e.rect.outer.width/p);b>o&&(b=o);const I=Math.floor(o/b+1);Nn.setHeight=m*I,Nn.setWidth=p*b;var y={y:Math.floor(d.y/m),x:Math.floor(d.x/p),getGridIndex:function(){return d.y>Nn.getHeight||d.y<0||d.x>Nn.getWidth||d.x<0?c:this.y*b+this.x},getColIndex:function(){const _=e.query("GET_ACTIVE_ITEMS"),L=e.childViews.filter(w=>w.rect.element.height),D=_.map(w=>L.find(z=>z.id===w.id)),U=D.findIndex(w=>w===l),k=Os(l),V=D.length;let te=V,M=0,Y=0,X=0;for(let w=0;w<V;w++)if(M=Os(D[w]),X=Y,Y=X+M,d.y<Y){if(U>w){if(d.y<X+k){te=w;break}continue}te=w;break}return te}};const f=b>1?y.getGridIndex():y.getColIndex();e.dispatch("MOVE_ITEM",{query:l,index:f});const v=s.getIndex();if(v===void 0||v!==f){if(s.setIndex(f),v===void 0)return;e.dispatch("DID_REORDER_ITEMS",{items:e.query("GET_ACTIVE_ITEMS"),origin:c,target:f})}},_p=Fe({DID_ADD_ITEM:up,DID_REMOVE_ITEM:hp,DID_DRAG_ITEM:mp}),gp=({root:e,props:t,actions:n,shouldOptimize:s})=>{_p({root:e,props:t,actions:n});const{dragCoordinates:i}=t,l=e.rect.element.width,o=e.childViews.filter(D=>D.rect.element.height),c=e.query("GET_ACTIVE_ITEMS").map(D=>o.find(U=>U.id===D.id)).filter(D=>D),d=i?or(e,c,i):null,m=e.ref.addIndex||null;e.ref.addIndex=null;let p=0,b=0,I=0;if(c.length===0)return;const y=c[0].rect.element,f=y.marginTop+y.marginBottom,v=y.marginLeft+y.marginRight,O=y.width+v,_=y.height+f,L=ar(l,O);if(L===1){let D=0,U=0;c.forEach((k,V)=>{if(d){let Y=V-d;Y===-2?U=-f*.25:Y===-1?U=-f*.75:Y===0?U=f*.75:Y===1?U=f*.25:U=0}s&&(k.translateX=null,k.translateY=null),k.markedForRemoval||Bi(k,0,D+U);let M=(k.rect.element.height+f)*(k.markedForRemoval?k.opacity:1);D+=M})}else{let D=0,U=0;c.forEach((k,V)=>{V===d&&(p=1),V===m&&(I+=1),k.markedForRemoval&&k.opacity<.5&&(b-=1);const te=V+I+p+b,M=te%L,Y=Math.floor(te/L),X=M*O,w=Y*_,z=Math.sign(X-D),Ee=Math.sign(w-U);D=X,U=w,!k.markedForRemoval&&(s&&(k.translateX=null,k.translateY=null),Bi(k,X,w,z,Ee))})}},Ep=(e,t)=>t.filter(n=>n.data&&n.data.id?e.id===n.data.id:!0),bp=Re({create:dp,write:gp,tag:"ul",name:"list",didWriteView:({root:e})=>{e.childViews.filter(t=>t.markedForRemoval&&t.opacity===0&&t.resting).forEach(t=>{t._destroy(),e.removeChildView(t)})},filterFrameActionsForChild:Ep,mixins:{apis:["dragCoordinates"]}}),yp=({root:e,props:t})=>{e.ref.list=e.appendChildView(e.createChildView(bp)),t.dragCoordinates=null,t.overflowing=!1},Tp=({root:e,props:t,action:n})=>{e.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(t.dragCoordinates={left:n.position.scopeLeft-e.ref.list.rect.element.left,top:n.position.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},Ip=({props:e})=>{e.dragCoordinates=null},vp=Fe({DID_DRAG:Tp,DID_END_DRAG:Ip}),Rp=({root:e,props:t,actions:n})=>{if(vp({root:e,props:t,actions:n}),e.ref.list.dragCoordinates=t.dragCoordinates,t.overflowing&&!t.overflow&&(t.overflowing=!1,e.element.dataset.state="",e.height=null),t.overflow){const s=Math.round(t.overflow);s!==e.height&&(t.overflowing=!0,e.element.dataset.state="overflow",e.height=s)}},Sp=Re({create:yp,write:Rp,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),st=(e,t,n,s="")=>{n?we(e,t,s):e.removeAttribute(t)},wp=e=>{if(!(!e||e.value==="")){try{e.value=""}catch{}if(e.value){const t=ct("form"),n=e.parentNode,s=e.nextSibling;t.appendChild(e),t.reset(),s?n.insertBefore(e,s):n.appendChild(e)}}},Ap=({root:e,props:t})=>{e.element.id=`filepond--browser-${t.id}`,we(e.element,"name",e.query("GET_NAME")),we(e.element,"aria-controls",`filepond--assistant-${t.id}`),we(e.element,"aria-labelledby",`filepond--drop-label-${t.id}`),Da({root:e,action:{value:e.query("GET_ACCEPTED_FILE_TYPES")}}),Ma({root:e,action:{value:e.query("GET_ALLOW_MULTIPLE")}}),ka({root:e,action:{value:e.query("GET_ALLOW_DIRECTORIES_ONLY")}}),js({root:e}),Ua({root:e,action:{value:e.query("GET_REQUIRED")}}),Ba({root:e,action:{value:e.query("GET_CAPTURE_METHOD")}}),e.ref.handleChange=n=>{if(!e.element.value)return;const s=Array.from(e.element.files).map(i=>(i._relativePath=i.webkitRelativePath,i));setTimeout(()=>{t.onload(s),wp(e.element)},250)},e.element.addEventListener("change",e.ref.handleChange)},Da=({root:e,action:t})=>{e.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&st(e.element,"accept",!!t.value,t.value?t.value.join(","):"")},Ma=({root:e,action:t})=>{st(e.element,"multiple",t.value)},ka=({root:e,action:t})=>{st(e.element,"webkitdirectory",t.value)},js=({root:e})=>{const t=e.query("GET_DISABLED"),n=e.query("GET_ALLOW_BROWSE"),s=t||!n;st(e.element,"disabled",s)},Ua=({root:e,action:t})=>{t.value?e.query("GET_TOTAL_ITEMS")===0&&st(e.element,"required",!0):st(e.element,"required",!1)},Ba=({root:e,action:t})=>{st(e.element,"capture",!!t.value,t.value===!0?"":t.value)},Fi=({root:e})=>{const{element:t}=e;e.query("GET_TOTAL_ITEMS")>0?(st(t,"required",!1),st(t,"name",!1)):(st(t,"name",!0,e.query("GET_NAME")),e.query("GET_CHECK_VALIDITY")&&t.setCustomValidity(""),e.query("GET_REQUIRED")&&st(t,"required",!0))},Np=({root:e})=>{e.query("GET_CHECK_VALIDITY")&&e.element.setCustomValidity(e.query("GET_LABEL_INVALID_FIELD"))},Cp=Re({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:Ap,destroy:({root:e})=>{e.element.removeEventListener("change",e.ref.handleChange)},write:Fe({DID_LOAD_ITEM:Fi,DID_REMOVE_ITEM:Fi,DID_THROW_ITEM_INVALID:Np,DID_SET_DISABLED:js,DID_SET_ALLOW_BROWSE:js,DID_SET_ALLOW_DIRECTORIES_ONLY:ka,DID_SET_ALLOW_MULTIPLE:Ma,DID_SET_ACCEPTED_FILE_TYPES:Da,DID_SET_CAPTURE_METHOD:Ba,DID_SET_REQUIRED:Ua})}),Gi={ENTER:13,SPACE:32},xp=({root:e,props:t})=>{const n=ct("label");we(n,"for",`filepond--browser-${t.id}`),we(n,"id",`filepond--drop-label-${t.id}`),e.ref.handleKeyDown=s=>{(s.keyCode===Gi.ENTER||s.keyCode===Gi.SPACE)&&(s.preventDefault(),e.ref.label.click())},e.ref.handleClick=s=>{s.target===n||n.contains(s.target)||e.ref.label.click()},n.addEventListener("keydown",e.ref.handleKeyDown),e.element.addEventListener("click",e.ref.handleClick),Fa(n,t.caption),e.appendChild(n),e.ref.label=n},Fa=(e,t)=>{e.innerHTML=t;const n=e.querySelector(".filepond--label-action");return n&&we(n,"tabindex","0"),t},Op=Re({name:"drop-label",ignoreRect:!0,create:xp,destroy:({root:e})=>{e.ref.label.addEventListener("keydown",e.ref.handleKeyDown),e.element.removeEventListener("click",e.ref.handleClick)},write:Fe({DID_SET_LABEL_IDLE:({root:e,action:t})=>{Fa(e.ref.label,t.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),Pp=Re({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),Lp=({root:e})=>{const t=e.rect.element.width*.5,n=e.rect.element.height*.5;e.ref.blob=e.appendChildView(e.createChildView(Pp,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:t,translateY:n}))},Dp=({root:e,action:t})=>{if(!e.ref.blob){Lp({root:e});return}e.ref.blob.translateX=t.position.scopeLeft,e.ref.blob.translateY=t.position.scopeTop,e.ref.blob.scaleX=1,e.ref.blob.scaleY=1,e.ref.blob.opacity=1},Mp=({root:e})=>{e.ref.blob&&(e.ref.blob.opacity=0)},kp=({root:e})=>{e.ref.blob&&(e.ref.blob.scaleX=2.5,e.ref.blob.scaleY=2.5,e.ref.blob.opacity=0)},Up=({root:e,props:t,actions:n})=>{Bp({root:e,props:t,actions:n});const{blob:s}=e.ref;n.length===0&&s&&s.opacity===0&&(e.removeChildView(s),e.ref.blob=null)},Bp=Fe({DID_DRAG:Dp,DID_DROP:kp,DID_END_DRAG:Mp}),Fp=Re({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:Up}),Ga=(e,t)=>{try{const n=new DataTransfer;t.forEach(s=>{s instanceof File?n.items.add(s):n.items.add(new File([s],s.name,{type:s.type}))}),e.files=n.files}catch{return!1}return!0},Gp=({root:e})=>e.ref.fields={},Xn=(e,t)=>e.ref.fields[t],lr=e=>{e.query("GET_ACTIVE_ITEMS").forEach(t=>{e.ref.fields[t.id]&&e.element.appendChild(e.ref.fields[t.id])})},Vi=({root:e})=>lr(e),Vp=({root:e,action:t})=>{const i=!(e.query("GET_ITEM",t.id).origin===Ce.LOCAL)&&e.query("SHOULD_UPDATE_FILE_INPUT"),l=ct("input");l.type=i?"file":"hidden",l.name=e.query("GET_NAME"),e.ref.fields[t.id]=l,lr(e)},Hp=({root:e,action:t})=>{const n=Xn(e,t.id);if(!n||(t.serverFileReference!==null&&(n.value=t.serverFileReference),!e.query("SHOULD_UPDATE_FILE_INPUT")))return;const s=e.query("GET_ITEM",t.id);Ga(n,[s.file])},jp=({root:e,action:t})=>{e.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout(()=>{const n=Xn(e,t.id);n&&Ga(n,[t.file])},0)},qp=({root:e})=>{e.element.disabled=e.query("GET_DISABLED")},Yp=({root:e,action:t})=>{const n=Xn(e,t.id);n&&(n.parentNode&&n.parentNode.removeChild(n),delete e.ref.fields[t.id])},zp=({root:e,action:t})=>{const n=Xn(e,t.id);n&&(t.value===null?n.removeAttribute("value"):n.type!="file"&&(n.value=t.value),lr(e))},$p=Fe({DID_SET_DISABLED:qp,DID_ADD_ITEM:Vp,DID_LOAD_ITEM:Hp,DID_REMOVE_ITEM:Yp,DID_DEFINE_VALUE:zp,DID_PREPARE_OUTPUT:jp,DID_REORDER_ITEMS:Vi,DID_SORT_ITEMS:Vi}),Wp=Re({tag:"fieldset",name:"data",create:Gp,write:$p,ignoreRect:!0}),Kp=e=>"getRootNode"in e?e.getRootNode():document,Xp=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],Qp=["css","csv","html","txt"],Zp={zip:"zip|compressed",epub:"application/epub+zip"},Va=(e="")=>(e=e.toLowerCase(),Xp.includes(e)?"image/"+(e==="jpg"?"jpeg":e==="svg"?"svg+xml":e):Qp.includes(e)?"text/"+e:Zp[e]||""),cr=e=>new Promise((t,n)=>{const s=ah(e);if(s.length&&!Jp(e))return t(s);eh(e).then(t)}),Jp=e=>e.files?e.files.length>0:!1,eh=e=>new Promise((t,n)=>{const s=(e.items?Array.from(e.items):[]).filter(i=>th(i)).map(i=>nh(i));if(!s.length){t(e.files?Array.from(e.files):[]);return}Promise.all(s).then(i=>{const l=[];i.forEach(o=>{l.push.apply(l,o)}),t(l.filter(o=>o).map(o=>(o._relativePath||(o._relativePath=o.webkitRelativePath),o)))}).catch(console.error)}),th=e=>{if(Ha(e)){const t=dr(e);if(t)return t.isFile||t.isDirectory}return e.kind==="file"},nh=e=>new Promise((t,n)=>{if(ih(e)){sh(dr(e)).then(t).catch(n);return}t([e.getAsFile()])}),sh=e=>new Promise((t,n)=>{const s=[];let i=0,l=0;const o=()=>{l===0&&i===0&&t(s)},c=d=>{i++;const m=d.createReader(),p=()=>{m.readEntries(b=>{if(b.length===0){i--,o();return}b.forEach(I=>{I.isDirectory?c(I):(l++,I.file(y=>{const f=rh(y);I.fullPath&&(f._relativePath=I.fullPath),s.push(f),l--,o()}))}),p()},n)};p()};c(e)}),rh=e=>{if(e.type.length)return e;const t=e.lastModifiedDate,n=e.name,s=Va(Kn(e.name));return s.length&&(e=e.slice(0,e.size,s),e.name=n,e.lastModifiedDate=t),e},ih=e=>Ha(e)&&(dr(e)||{}).isDirectory,Ha=e=>"webkitGetAsEntry"in e,dr=e=>e.webkitGetAsEntry(),ah=e=>{let t=[];try{if(t=lh(e),t.length)return t;t=oh(e)}catch{}return t},oh=e=>{let t=e.getData("url");return typeof t=="string"&&t.length?[t]:[]},lh=e=>{let t=e.getData("text/html");if(typeof t=="string"&&t.length){const n=t.match(/src\s*=\s*"(.+?)"/);if(n)return[n[1]]}return[]},Hn=[],Nt=e=>({pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}),ch=(e,t,n)=>{const s=dh(t),i={element:e,filterElement:n,state:null,ondrop:()=>{},onenter:()=>{},ondrag:()=>{},onexit:()=>{},onload:()=>{},allowdrop:()=>{}};return i.destroy=s.addListener(i),i},dh=e=>{const t=Hn.find(s=>s.element===e);if(t)return t;const n=uh(e);return Hn.push(n),n},uh=e=>{const t=[],n={dragenter:hh,dragover:fh,dragleave:_h,drop:mh},s={};ge(n,(l,o)=>{s[l]=o(e,t),e.addEventListener(l,s[l],!1)});const i={element:e,addListener:l=>(t.push(l),()=>{t.splice(t.indexOf(l),1),t.length===0&&(Hn.splice(Hn.indexOf(i),1),ge(n,o=>{e.removeEventListener(o,s[o],!1)}))})};return i},ph=(e,t)=>("elementFromPoint"in e||(e=document),e.elementFromPoint(t.x,t.y)),ur=(e,t)=>{const n=Kp(t),s=ph(n,{x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset});return s===t||t.contains(s)};let ja=null;const Cn=(e,t)=>{try{e.dropEffect=t}catch{}},hh=(e,t)=>n=>{n.preventDefault(),ja=n.target,t.forEach(s=>{const{element:i,onenter:l}=s;ur(n,i)&&(s.state="enter",l(Nt(n)))})},fh=(e,t)=>n=>{n.preventDefault();const s=n.dataTransfer;cr(s).then(i=>{let l=!1;t.some(o=>{const{filterElement:c,element:d,onenter:m,onexit:p,ondrag:b,allowdrop:I}=o;Cn(s,"copy");const y=I(i);if(!y){Cn(s,"none");return}if(ur(n,d)){if(l=!0,o.state===null){o.state="enter",m(Nt(n));return}if(o.state="over",c&&!y){Cn(s,"none");return}b(Nt(n))}else c&&!l&&Cn(s,"none"),o.state&&(o.state=null,p(Nt(n)))})})},mh=(e,t)=>n=>{n.preventDefault();const s=n.dataTransfer;cr(s).then(i=>{t.forEach(l=>{const{filterElement:o,element:c,ondrop:d,onexit:m,allowdrop:p}=l;if(l.state=null,!(o&&!ur(n,c))){if(!p(i))return m(Nt(n));d(Nt(n),i)}})})},_h=(e,t)=>n=>{ja===n.target&&t.forEach(s=>{const{onexit:i}=s;s.state=null,i(Nt(n))})},gh=(e,t,n)=>{e.classList.add("filepond--hopper");const{catchesDropsOnPage:s,requiresDropOnElement:i,filterItems:l=p=>p}=n,o=ch(e,s?document.documentElement:e,i);let c="",d="";o.allowdrop=p=>t(l(p)),o.ondrop=(p,b)=>{const I=l(b);if(!t(I)){m.ondragend(p);return}d="drag-drop",m.onload(I,p)},o.ondrag=p=>{m.ondrag(p)},o.onenter=p=>{d="drag-over",m.ondragstart(p)},o.onexit=p=>{d="drag-exit",m.ondragend(p)};const m={updateHopperState:()=>{c!==d&&(e.dataset.hopperState=d,c=d)},onload:()=>{},ondragstart:()=>{},ondrag:()=>{},ondragend:()=>{},destroy:()=>{o.destroy()}};return m};let qs=!1;const jt=[],qa=e=>{const t=document.activeElement;if(t&&/textarea|input/i.test(t.nodeName)){let n=!1,s=t;for(;s!==document.body;){if(s.classList.contains("filepond--root")){n=!0;break}s=s.parentNode}if(!n)return}cr(e.clipboardData).then(n=>{n.length&&jt.forEach(s=>s(n))})},Eh=e=>{jt.includes(e)||(jt.push(e),!qs&&(qs=!0,document.addEventListener("paste",qa)))},bh=e=>{nr(jt,jt.indexOf(e)),jt.length===0&&(document.removeEventListener("paste",qa),qs=!1)},yh=()=>{const e=n=>{t.onload(n)},t={destroy:()=>{bh(e)},onload:()=>{}};return Eh(e),t},Th=({root:e,props:t})=>{e.element.id=`filepond--assistant-${t.id}`,we(e.element,"role","status"),we(e.element,"aria-live","polite"),we(e.element,"aria-relevant","additions")};let Hi=null,ji=null;const Ps=[],Qn=(e,t)=>{e.element.textContent=t},Ih=e=>{e.element.textContent=""},Ya=(e,t,n)=>{const s=e.query("GET_TOTAL_ITEMS");Qn(e,`${n} ${t}, ${s} ${s===1?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL")}`),clearTimeout(ji),ji=setTimeout(()=>{Ih(e)},1500)},za=e=>e.element.parentNode.contains(document.activeElement),vh=({root:e,action:t})=>{if(!za(e))return;e.element.textContent="";const n=e.query("GET_ITEM",t.id);Ps.push(n.filename),clearTimeout(Hi),Hi=setTimeout(()=>{Ya(e,Ps.join(", "),e.query("GET_LABEL_FILE_ADDED")),Ps.length=0},750)},Rh=({root:e,action:t})=>{if(!za(e))return;const n=t.item;Ya(e,n.filename,e.query("GET_LABEL_FILE_REMOVED"))},Sh=({root:e,action:t})=>{const s=e.query("GET_ITEM",t.id).filename,i=e.query("GET_LABEL_FILE_PROCESSING_COMPLETE");Qn(e,`${s} ${i}`)},qi=({root:e,action:t})=>{const s=e.query("GET_ITEM",t.id).filename,i=e.query("GET_LABEL_FILE_PROCESSING_ABORTED");Qn(e,`${s} ${i}`)},xn=({root:e,action:t})=>{const s=e.query("GET_ITEM",t.id).filename;Qn(e,`${t.status.main} ${s} ${t.status.sub}`)},wh=Re({create:Th,ignoreRect:!0,ignoreRectUpdate:!0,write:Fe({DID_LOAD_ITEM:vh,DID_REMOVE_ITEM:Rh,DID_COMPLETE_ITEM_PROCESSING:Sh,DID_ABORT_ITEM_PROCESSING:qi,DID_REVERT_ITEM_PROCESSING:qi,DID_THROW_ITEM_REMOVE_ERROR:xn,DID_THROW_ITEM_LOAD_ERROR:xn,DID_THROW_ITEM_INVALID:xn,DID_THROW_ITEM_PROCESSING_ERROR:xn}),tag:"span",name:"assistant"}),$a=(e,t="-")=>e.replace(new RegExp(`${t}.`,"g"),n=>n.charAt(1).toUpperCase()),Wa=(e,t=16,n=!0)=>{let s=Date.now(),i=null;return(...l)=>{clearTimeout(i);const o=Date.now()-s,c=()=>{s=Date.now(),e(...l)};o<t?n||(i=setTimeout(c,t-o)):c()}},Ah=1e6,jn=e=>e.preventDefault(),Nh=({root:e,props:t})=>{const n=e.query("GET_ID");n&&(e.element.id=n);const s=e.query("GET_CLASS_NAME");s&&s.split(" ").filter(d=>d.length).forEach(d=>{e.element.classList.add(d)}),e.ref.label=e.appendChildView(e.createChildView(Op,{...t,translateY:null,caption:e.query("GET_LABEL_IDLE")})),e.ref.list=e.appendChildView(e.createChildView(Sp,{translateY:null})),e.ref.panel=e.appendChildView(e.createChildView(La,{name:"panel-root"})),e.ref.assistant=e.appendChildView(e.createChildView(wh,{...t})),e.ref.data=e.appendChildView(e.createChildView(Wp,{...t})),e.ref.measure=ct("div"),e.ref.measure.style.height="100%",e.element.appendChild(e.ref.measure),e.ref.bounds=null,e.query("GET_STYLES").filter(d=>!lt(d.value)).map(({name:d,value:m})=>{e.element.dataset[d]=m}),e.ref.widthPrevious=null,e.ref.widthUpdated=Wa(()=>{e.ref.updateHistory=[],e.dispatch("DID_RESIZE_ROOT")},250),e.ref.previousAspectRatio=null,e.ref.updateHistory=[];const i=window.matchMedia("(pointer: fine) and (hover: hover)").matches,l="PointerEvent"in window;e.query("GET_ALLOW_REORDER")&&l&&!i&&(e.element.addEventListener("touchmove",jn,{passive:!1}),e.element.addEventListener("gesturestart",jn));const o=e.query("GET_CREDITS");if(o.length===2){const d=document.createElement("a");d.className="filepond--credits",d.href=o[0],d.tabIndex=-1,d.target="_blank",d.rel="noopener noreferrer",d.textContent=o[1],e.element.appendChild(d),e.ref.credits=d}},Ch=({root:e,props:t,actions:n})=>{if(Dh({root:e,props:t,actions:n}),n.filter(V=>/^DID_SET_STYLE_/.test(V.type)).filter(V=>!lt(V.data.value)).map(({type:V,data:te})=>{const M=$a(V.substring(8).toLowerCase(),"_");e.element.dataset[M]=te.value,e.invalidateLayout()}),e.rect.element.hidden)return;e.rect.element.width!==e.ref.widthPrevious&&(e.ref.widthPrevious=e.rect.element.width,e.ref.widthUpdated());let s=e.ref.bounds;s||(s=e.ref.bounds=Ph(e),e.element.removeChild(e.ref.measure),e.ref.measure=null);const{hopper:i,label:l,list:o,panel:c}=e.ref;i&&i.updateHopperState();const d=e.query("GET_PANEL_ASPECT_RATIO"),m=e.query("GET_ALLOW_MULTIPLE"),p=e.query("GET_TOTAL_ITEMS"),b=m?e.query("GET_MAX_FILES")||Ah:1,I=p===b,y=n.find(V=>V.type==="DID_ADD_ITEM");if(I&&y){const V=y.data.interactionMethod;l.opacity=0,m?l.translateY=-40:V===Ze.API?l.translateX=40:V===Ze.BROWSE?l.translateY=40:l.translateY=30}else I||(l.opacity=1,l.translateX=0,l.translateY=0);const f=xh(e),v=Oh(e),O=l.rect.element.height,_=!m||I?0:O,L=I?o.rect.element.marginTop:0,D=p===0?0:o.rect.element.marginBottom,U=_+L+v.visual+D,k=_+L+v.bounds+D;if(o.translateY=Math.max(0,_-o.rect.element.marginTop)-f.top,d){const V=e.rect.element.width,te=V*d;d!==e.ref.previousAspectRatio&&(e.ref.previousAspectRatio=d,e.ref.updateHistory=[]);const M=e.ref.updateHistory;M.push(V);const Y=2;if(M.length>Y*2){const w=M.length,z=w-10;let Ee=0;for(let P=w;P>=z;P--)if(M[P]===M[P-2]&&Ee++,Ee>=Y)return}c.scalable=!1,c.height=te;const X=te-_-(D-f.bottom)-(I?L:0);v.visual>X?o.overflow=X:o.overflow=null,e.height=te}else if(s.fixedHeight){c.scalable=!1;const V=s.fixedHeight-_-(D-f.bottom)-(I?L:0);v.visual>V?o.overflow=V:o.overflow=null}else if(s.cappedHeight){const V=U>=s.cappedHeight,te=Math.min(s.cappedHeight,U);c.scalable=!0,c.height=V?te:te-f.top-f.bottom;const M=te-_-(D-f.bottom)-(I?L:0);U>s.cappedHeight&&v.visual>M?o.overflow=M:o.overflow=null,e.height=Math.min(s.cappedHeight,k-f.top-f.bottom)}else{const V=p>0?f.top+f.bottom:0;c.scalable=!0,c.height=Math.max(O,U-V),e.height=Math.max(O,k-V)}e.ref.credits&&c.heightCurrent&&(e.ref.credits.style.transform=`translateY(${c.heightCurrent}px)`)},xh=e=>{const t=e.ref.list.childViews[0].childViews[0];return t?{top:t.rect.element.marginTop,bottom:t.rect.element.marginBottom}:{top:0,bottom:0}},Oh=e=>{let t=0,n=0;const s=e.ref.list,i=s.childViews[0],l=i.childViews.filter(L=>L.rect.element.height),o=e.query("GET_ACTIVE_ITEMS").map(L=>l.find(D=>D.id===L.id)).filter(L=>L);if(o.length===0)return{visual:t,bounds:n};const c=i.rect.element.width,d=or(i,o,s.dragCoordinates),m=o[0].rect.element,p=m.marginTop+m.marginBottom,b=m.marginLeft+m.marginRight,I=m.width+b,y=m.height+p,f=typeof d<"u"&&d>=0?1:0,v=o.find(L=>L.markedForRemoval&&L.opacity<.45)?-1:0,O=o.length+f+v,_=ar(c,I);return _===1?o.forEach(L=>{const D=L.rect.element.height+p;n+=D,t+=D*L.opacity}):(n=Math.ceil(O/_)*y,t=n),{visual:t,bounds:n}},Ph=e=>{const t=e.ref.measureHeight||null;return{cappedHeight:parseInt(e.style.maxHeight,10)||null,fixedHeight:t===0?null:t}},pr=(e,t)=>{const n=e.query("GET_ALLOW_REPLACE"),s=e.query("GET_ALLOW_MULTIPLE"),i=e.query("GET_TOTAL_ITEMS");let l=e.query("GET_MAX_FILES");const o=t.length;return!s&&o>1?(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:ye("warning",0,"Max files")}),!0):(l=s?l:1,!s&&n?!1:Yt(l)&&i+o>l?(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:ye("warning",0,"Max files")}),!0):!1)},Lh=(e,t,n)=>{const s=e.childViews[0];return or(s,t,{left:n.scopeLeft-s.rect.element.left,top:n.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},Yi=e=>{const t=e.query("GET_ALLOW_DROP"),n=e.query("GET_DISABLED"),s=t&&!n;if(s&&!e.ref.hopper){const i=gh(e.element,l=>{const o=e.query("GET_BEFORE_DROP_FILE")||(()=>!0);return e.query("GET_DROP_VALIDATION")?l.every(d=>Ct("ALLOW_HOPPER_ITEM",d,{query:e.query}).every(m=>m===!0)&&o(d)):!0},{filterItems:l=>{const o=e.query("GET_IGNORED_FILES");return l.filter(c=>At(c)?!o.includes(c.name.toLowerCase()):!0)},catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});i.onload=(l,o)=>{const d=e.ref.list.childViews[0].childViews.filter(p=>p.rect.element.height),m=e.query("GET_ACTIVE_ITEMS").map(p=>d.find(b=>b.id===p.id)).filter(p=>p);et("ADD_ITEMS",l,{dispatch:e.dispatch}).then(p=>{if(pr(e,p))return!1;e.dispatch("ADD_ITEMS",{items:p,index:Lh(e.ref.list,m,o),interactionMethod:Ze.DROP})}),e.dispatch("DID_DROP",{position:o}),e.dispatch("DID_END_DRAG",{position:o})},i.ondragstart=l=>{e.dispatch("DID_START_DRAG",{position:l})},i.ondrag=Wa(l=>{e.dispatch("DID_DRAG",{position:l})}),i.ondragend=l=>{e.dispatch("DID_END_DRAG",{position:l})},e.ref.hopper=i,e.ref.drip=e.appendChildView(e.createChildView(Fp))}else!s&&e.ref.hopper&&(e.ref.hopper.destroy(),e.ref.hopper=null,e.removeChildView(e.ref.drip))},zi=(e,t)=>{const n=e.query("GET_ALLOW_BROWSE"),s=e.query("GET_DISABLED"),i=n&&!s;i&&!e.ref.browser?e.ref.browser=e.appendChildView(e.createChildView(Cp,{...t,onload:l=>{et("ADD_ITEMS",l,{dispatch:e.dispatch}).then(o=>{if(pr(e,o))return!1;e.dispatch("ADD_ITEMS",{items:o,index:-1,interactionMethod:Ze.BROWSE})})}}),0):!i&&e.ref.browser&&(e.removeChildView(e.ref.browser),e.ref.browser=null)},$i=e=>{const t=e.query("GET_ALLOW_PASTE"),n=e.query("GET_DISABLED"),s=t&&!n;s&&!e.ref.paster?(e.ref.paster=yh(),e.ref.paster.onload=i=>{et("ADD_ITEMS",i,{dispatch:e.dispatch}).then(l=>{if(pr(e,l))return!1;e.dispatch("ADD_ITEMS",{items:l,index:-1,interactionMethod:Ze.PASTE})})}):!s&&e.ref.paster&&(e.ref.paster.destroy(),e.ref.paster=null)},Dh=Fe({DID_SET_ALLOW_BROWSE:({root:e,props:t})=>{zi(e,t)},DID_SET_ALLOW_DROP:({root:e})=>{Yi(e)},DID_SET_ALLOW_PASTE:({root:e})=>{$i(e)},DID_SET_DISABLED:({root:e,props:t})=>{Yi(e),$i(e),zi(e,t),e.query("GET_DISABLED")?e.element.dataset.disabled="disabled":e.element.removeAttribute("data-disabled")}}),Mh=Re({name:"root",read:({root:e})=>{e.ref.measure&&(e.ref.measureHeight=e.ref.measure.offsetHeight)},create:Nh,write:Ch,destroy:({root:e})=>{e.ref.paster&&e.ref.paster.destroy(),e.ref.hopper&&e.ref.hopper.destroy(),e.element.removeEventListener("touchmove",jn),e.element.removeEventListener("gesturestart",jn)},mixins:{styles:["height"]}}),kh=(e={})=>{let t=null;const n=Vn(),s=Zc(Ud(n),[nu,Gd(n)],[Au,Fd(n)]);s.dispatch("SET_OPTIONS",{options:e});const i=()=>{document.hidden||s.dispatch("KICK")};document.addEventListener("visibilitychange",i);let l=null,o=!1,c=!1,d=null,m=null;const p=()=>{o||(o=!0),clearTimeout(l),l=setTimeout(()=>{o=!1,d=null,m=null,c&&(c=!1,s.dispatch("DID_STOP_RESIZE"))},500)};window.addEventListener("resize",p);const b=Mh(s,{id:tr()});let I=!1,y=!1;const f={_read:()=>{o&&(m=window.innerWidth,d||(d=m),!c&&m!==d&&(s.dispatch("DID_START_RESIZE"),c=!0)),y&&I&&(I=b.element.offsetParent===null),!I&&(b._read(),y=b.rect.element.hidden)},_write:N=>{const C=s.processActionQueue().filter(B=>!/^SET_/.test(B.type));I&&!C.length||(L(C),I=b._write(N,C,c),jd(s.query("GET_ITEMS")),I&&s.processDispatchQueue())}},v=N=>C=>{const B={type:N};if(!C)return B;if(C.hasOwnProperty("error")&&(B.error=C.error?{...C.error}:null),C.status&&(B.status={...C.status}),C.file&&(B.output=C.file),C.source)B.file=C.source;else if(C.item||C.id){const F=C.item?C.item:s.query("GET_ITEM",C.id);B.file=F?He(F):null}return C.items&&(B.items=C.items.map(He)),/progress/.test(N)&&(B.progress=C.progress),C.hasOwnProperty("origin")&&C.hasOwnProperty("target")&&(B.origin=C.origin,B.target=C.target),B},O={DID_DESTROY:v("destroy"),DID_INIT:v("init"),DID_THROW_MAX_FILES:v("warning"),DID_INIT_ITEM:v("initfile"),DID_START_ITEM_LOAD:v("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:v("addfileprogress"),DID_LOAD_ITEM:v("addfile"),DID_THROW_ITEM_INVALID:[v("error"),v("addfile")],DID_THROW_ITEM_LOAD_ERROR:[v("error"),v("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[v("error"),v("removefile")],DID_PREPARE_OUTPUT:v("preparefile"),DID_START_ITEM_PROCESSING:v("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:v("processfileprogress"),DID_ABORT_ITEM_PROCESSING:v("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:v("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:v("processfiles"),DID_REVERT_ITEM_PROCESSING:v("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[v("error"),v("processfile")],DID_REMOVE_ITEM:v("removefile"),DID_UPDATE_ITEMS:v("updatefiles"),DID_ACTIVATE_ITEM:v("activatefile"),DID_REORDER_ITEMS:v("reorderfiles")},_=N=>{const C={pond:Z,...N};delete C.type,b.element.dispatchEvent(new CustomEvent(`FilePond:${N.type}`,{detail:C,bubbles:!0,cancelable:!0,composed:!0}));const B=[];N.hasOwnProperty("error")&&B.push(N.error),N.hasOwnProperty("file")&&B.push(N.file);const F=["type","error","file"];Object.keys(N).filter(S=>!F.includes(S)).forEach(S=>B.push(N[S])),Z.fire(N.type,...B);const J=s.query(`GET_ON${N.type.toUpperCase()}`);J&&J(...B)},L=N=>{N.length&&N.filter(C=>O[C.type]).forEach(C=>{const B=O[C.type];(Array.isArray(B)?B:[B]).forEach(F=>{C.type==="DID_INIT_ITEM"?_(F(C.data)):setTimeout(()=>{_(F(C.data))},0)})})},D=N=>s.dispatch("SET_OPTIONS",{options:N}),U=N=>s.query("GET_ACTIVE_ITEM",N),k=N=>new Promise((C,B)=>{s.dispatch("REQUEST_ITEM_PREPARE",{query:N,success:F=>{C(F)},failure:F=>{B(F)}})}),V=(N,C={})=>new Promise((B,F)=>{Y([{source:N,options:C}],{index:C.index}).then(J=>B(J&&J[0])).catch(F)}),te=N=>N.file&&N.id,M=(N,C)=>(typeof N=="object"&&!te(N)&&!C&&(C=N,N=void 0),s.dispatch("REMOVE_ITEM",{...C,query:N}),s.query("GET_ACTIVE_ITEM",N)===null),Y=(...N)=>new Promise((C,B)=>{const F=[],J={};if(Yn(N[0]))F.push.apply(F,N[0]),Object.assign(J,N[1]||{});else{const S=N[N.length-1];typeof S=="object"&&!(S instanceof Blob)&&Object.assign(J,N.pop()),F.push(...N)}s.dispatch("ADD_ITEMS",{items:F,index:J.index,interactionMethod:Ze.API,success:C,failure:B})}),X=()=>s.query("GET_ACTIVE_ITEMS"),w=N=>new Promise((C,B)=>{s.dispatch("REQUEST_ITEM_PROCESSING",{query:N,success:F=>{C(F)},failure:F=>{B(F)}})}),z=(...N)=>{const C=Array.isArray(N[0])?N[0]:N,B=C.length?C:X();return Promise.all(B.map(k))},Ee=(...N)=>{const C=Array.isArray(N[0])?N[0]:N;if(!C.length){const B=X().filter(F=>!(F.status===W.IDLE&&F.origin===Ce.LOCAL)&&F.status!==W.PROCESSING&&F.status!==W.PROCESSING_COMPLETE&&F.status!==W.PROCESSING_REVERT_ERROR);return Promise.all(B.map(w))}return Promise.all(C.map(w))},P=(...N)=>{const C=Array.isArray(N[0])?N[0]:N;let B;typeof C[C.length-1]=="object"?B=C.pop():Array.isArray(N[0])&&(B=N[1]);const F=X();return C.length?C.map(S=>It(S)?F[S]?F[S].id:null:S).filter(S=>S).map(S=>M(S,B)):Promise.all(F.map(S=>M(S,B)))},Z={...Wn(),...f,...Bd(s,n),setOptions:D,addFile:V,addFiles:Y,getFile:U,processFile:w,prepareFile:k,removeFile:M,moveFile:(N,C)=>s.dispatch("MOVE_ITEM",{query:N,index:C}),getFiles:X,processFiles:Ee,removeFiles:P,prepareFiles:z,sort:N=>s.dispatch("SORT",{compare:N}),browse:()=>{var N=b.element.querySelector("input[type=file]");N&&N.click()},destroy:()=>{Z.fire("destroy",b.element),s.dispatch("ABORT_ALL"),b._destroy(),window.removeEventListener("resize",p),document.removeEventListener("visibilitychange",i),s.dispatch("DID_DESTROY")},insertBefore:N=>_i(b.element,N),insertAfter:N=>gi(b.element,N),appendTo:N=>N.appendChild(b.element),replaceElement:N=>{_i(b.element,N),N.parentNode.removeChild(N),t=N},restoreElement:()=>{t&&(gi(t,b.element),b.element.parentNode.removeChild(b.element),t=null)},isAttachedTo:N=>b.element===N||t===N,element:{get:()=>b.element},status:{get:()=>s.query("GET_STATUS")}};return s.dispatch("DID_INIT"),_t(Z)},Ka=(e={})=>{const t={};return ge(Vn(),(s,i)=>{t[s]=i[0]}),kh({...t,...e})},Uh=e=>e.charAt(0).toLowerCase()+e.slice(1),Bh=e=>$a(e.replace(/^data-/,"")),Xa=(e,t)=>{ge(t,(n,s)=>{ge(e,(i,l)=>{const o=new RegExp(n);if(!o.test(i)||(delete e[i],s===!1))return;if(Be(s)){e[s]=l;return}const d=s.group;xe(s)&&!e[d]&&(e[d]={}),e[d][Uh(i.replace(o,""))]=l}),s.mapping&&Xa(e[s.group],s.mapping)})},Fh=(e,t={})=>{const n=[];ge(e.attributes,i=>{n.push(e.attributes[i])});const s=n.filter(i=>i.name).reduce((i,l)=>{const o=we(e,l.name);return i[Bh(l.name)]=o===l.name?!0:o,i},{});return Xa(s,t),s},Gh=(e,t={})=>{const n={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};Ct("SET_ATTRIBUTE_TO_OPTION_MAP",n);const s={...t},i=Fh(e.nodeName==="FIELDSET"?e.querySelector("input[type=file]"):e,n);Object.keys(i).forEach(o=>{xe(i[o])?(xe(s[o])||(s[o]={}),Object.assign(s[o],i[o])):s[o]=i[o]}),s.files=(t.files||[]).concat(Array.from(e.querySelectorAll("input:not([type=file])")).map(o=>({source:o.value,options:{type:o.dataset.type}})));const l=Ka(s);return e.files&&Array.from(e.files).forEach(o=>{l.addFile(o)}),l.replaceElement(e),l},Vh=(...e)=>Qc(e[0])?Gh(...e):Ka(...e),Hh=["fire","_read","_write"],Wi=e=>{const t={};return Ea(e,t,Hh),t},jh=(e,t)=>e.replace(/(?:{([a-zA-Z]+)})/g,(n,s)=>t[s]),qh=e=>{const t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(t),s=new Worker(n);return{transfer:(i,l)=>{},post:(i,l,o)=>{const c=tr();s.onmessage=d=>{d.data.id===c&&l(d.data.message)},s.postMessage({id:c,message:i},o)},terminate:()=>{s.terminate(),URL.revokeObjectURL(n)}}},Yh=e=>new Promise((t,n)=>{const s=new Image;s.onload=()=>{t(s)},s.onerror=i=>{n(i)},s.src=e}),Qa=(e,t)=>{const n=e.slice(0,e.size,e.type);return n.lastModifiedDate=e.lastModifiedDate,n.name=t,n},zh=e=>Qa(e,e.name),Ki=[],$h=e=>{if(Ki.includes(e))return;Ki.push(e);const t=e({addFilter:Yd,utils:{Type:A,forin:ge,isString:Be,isFile:At,toNaturalFileSize:xa,replaceInString:jh,getExtensionFromFilename:Kn,getFilenameWithoutExtension:Aa,guesstimateMimeType:Va,getFileFromBlob:qt,getFilenameFromURL:un,createRoute:Fe,createWorker:qh,createView:Re,createItemAPI:He,loadImage:Yh,copyFile:zh,renameFile:Qa,createBlob:Ra,applyFilterChain:et,text:Te,getNumericAspectRatioFromString:Ta},views:{fileActionButton:Ca}});zd(t.options)},Wh=()=>Object.prototype.toString.call(window.operamini)==="[object OperaMini]",Kh=()=>"Promise"in window,Xh=()=>"slice"in Blob.prototype,Qh=()=>"URL"in window&&"createObjectURL"in window.URL,Zh=()=>"visibilityState"in document,Jh=()=>"performance"in window,ef=()=>"supports"in(window.CSS||{}),tf=()=>/MSIE|Trident/.test(window.navigator.userAgent),Ys=(()=>{const e=pa()&&!Wh()&&Zh()&&Kh()&&Xh()&&Qh()&&Jh()&&(ef()||tf());return()=>e})(),mt={apps:[]},nf="filepond",xt=()=>{};let Xi={},Mn=xt,Ls=xt,Qi=xt,Zi=xt,qn=xt,Ji=xt,ea=xt;if(Ys()){vd(()=>{mt.apps.forEach(n=>n._read())},n=>{mt.apps.forEach(s=>s._write(n))});const e=()=>{document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:Ys,create:Mn,destroy:Ls,parse:Qi,find:Zi,registerPlugin:qn,setOptions:ea}})),document.removeEventListener("DOMContentLoaded",e)};document.readyState!=="loading"?setTimeout(()=>e(),0):document.addEventListener("DOMContentLoaded",e);const t=()=>ge(Vn(),(n,s)=>{Xi[n]=s[1]});Xi={},t(),Mn=(...n)=>{const s=Vh(...n);return s.on("destroy",Ls),mt.apps.push(s),Wi(s)},Ls=n=>{const s=mt.apps.findIndex(i=>i.isAttachedTo(n));return s>=0?(mt.apps.splice(s,1)[0].restoreElement(),!0):!1},Qi=n=>Array.from(n.querySelectorAll(`.${nf}`)).filter(l=>!mt.apps.find(o=>o.isAttachedTo(l))).map(l=>Mn(l)),Zi=n=>{const s=mt.apps.find(i=>i.isAttachedTo(n));return s?Wi(s):null},qn=(...n)=>{n.forEach($h),t()},Ji=()=>{const n={};return ge(Vn(),(s,i)=>{n[s]=i[0]}),n},ea=n=>(xe(n)&&(mt.apps.forEach(s=>{s.setOptions(n)}),$d(n)),Ji())}/*!
 * react-filepond v7.1.2
 * A handy FilePond adapter component for React
 * 
 * Copyright (c) 2022 PQINA
 * https://pqina.nl/filepond
 * 
 * Licensed under the MIT license.
 */const sf=Ys(),rf=["setOptions","on","off","onOnce","appendTo","insertAfter","insertBefore","isAttachedTo","replaceElement","restoreElement","destroy"];class af extends j.Component{constructor(t){super(t),this.allowFilesSync=!0}componentDidMount(){if(this._input=this._element.querySelector('input[type="file"]'),this._inputClone=this._input.cloneNode(),!sf)return;const t=Object.assign({},this.props);if(t.onupdatefiles){const n=t.onupdatefiles;t.onupdatefiles=s=>{this.allowFilesSync=!1,n(s)}}this._pond=Mn(this._input,t),Object.keys(this._pond).filter(n=>!rf.includes(n)).forEach(n=>{this[n]=this._pond[n]})}componentWillUnmount(){if(!this._pond)return;const t=document.createElement("div");t.append(this._pond.element),t.id="foo",this._pond.destroy(),this._pond=void 0,this._element.append(this._inputClone)}shouldComponentUpdate(){return this.allowFilesSync?!0:(this.allowFilesSync=!0,!1)}componentDidUpdate(){if(!this._pond)return;const t=Object.assign({},this.props);delete t.onupdatefiles,this._pond.setOptions(t)}render(){const{id:t,name:n,className:s,allowMultiple:i,required:l,captureMethod:o,acceptedFileTypes:c}=this.props;return R.createElement("div",{className:"filepond--wrapper",ref:d=>this._element=d},R.createElement("input",{type:"file",name:n,id:t,accept:c,multiple:i,required:l,className:s,capture:o}))}}/*!
 * FilePondPluginFileValidateType 1.2.9
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Za=({addFilter:e,utils:t})=>{const{Type:n,isString:s,replaceInString:i,guesstimateMimeType:l,getExtensionFromFilename:o,getFilenameFromURL:c}=t,d=(y,f)=>{const v=(/^[^/]+/.exec(y)||[]).pop(),O=f.slice(0,-2);return v===O},m=(y,f)=>y.some(v=>/\*$/.test(v)?d(f,v):v===f),p=y=>{let f="";if(s(y)){const v=c(y),O=o(v);O&&(f=l(O))}else f=y.type;return f},b=(y,f,v)=>{if(f.length===0)return!0;const O=p(y);return v?new Promise((_,L)=>{v(y,O).then(D=>{m(f,D)?_():L()}).catch(L)}):m(f,O)},I=y=>f=>y[f]===null?!1:y[f]||f;return e("SET_ATTRIBUTE_TO_OPTION_MAP",y=>Object.assign(y,{accept:"acceptedFileTypes"})),e("ALLOW_HOPPER_ITEM",(y,{query:f})=>f("GET_ALLOW_FILE_TYPE_VALIDATION")?b(y,f("GET_ACCEPTED_FILE_TYPES")):!0),e("LOAD_FILE",(y,{query:f})=>new Promise((v,O)=>{if(!f("GET_ALLOW_FILE_TYPE_VALIDATION")){v(y);return}const _=f("GET_ACCEPTED_FILE_TYPES"),L=f("GET_FILE_VALIDATE_TYPE_DETECT_TYPE"),D=b(y,_,L),U=()=>{const k=_.map(I(f("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"))).filter(te=>te!==!1),V=k.filter((te,M)=>k.indexOf(te)===M);O({status:{main:f("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:i(f("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:V.join(", "),allButLastType:V.slice(0,-1).join(", "),lastType:V[V.length-1]})}})};if(typeof D=="boolean")return D?v(y):U();D.then(()=>{v(y)}).catch(U)})),{options:{allowFileTypeValidation:[!0,n.BOOLEAN],acceptedFileTypes:[[],n.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",n.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",n.STRING],fileValidateTypeLabelExpectedTypesMap:[{},n.OBJECT],fileValidateTypeDetectType:[null,n.FUNCTION]}}},of=typeof window<"u"&&typeof window.document<"u";of&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Za}));/*!
 * FilePondPluginFileValidateSize 2.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Ja=({addFilter:e,utils:t})=>{const{Type:n,replaceInString:s,toNaturalFileSize:i}=t;return e("ALLOW_HOPPER_ITEM",(l,{query:o})=>{if(!o("GET_ALLOW_FILE_SIZE_VALIDATION"))return!0;const c=o("GET_MAX_FILE_SIZE");if(c!==null&&l.size>c)return!1;const d=o("GET_MIN_FILE_SIZE");return!(d!==null&&l.size<d)}),e("LOAD_FILE",(l,{query:o})=>new Promise((c,d)=>{if(!o("GET_ALLOW_FILE_SIZE_VALIDATION"))return c(l);const m=o("GET_FILE_VALIDATE_SIZE_FILTER");if(m&&!m(l))return c(l);const p=o("GET_MAX_FILE_SIZE");if(p!==null&&l.size>p){d({status:{main:o("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:s(o("GET_LABEL_MAX_FILE_SIZE"),{filesize:i(p,".",o("GET_FILE_SIZE_BASE"),o("GET_FILE_SIZE_LABELS",o))})}});return}const b=o("GET_MIN_FILE_SIZE");if(b!==null&&l.size<b){d({status:{main:o("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:s(o("GET_LABEL_MIN_FILE_SIZE"),{filesize:i(b,".",o("GET_FILE_SIZE_BASE"),o("GET_FILE_SIZE_LABELS",o))})}});return}const I=o("GET_MAX_TOTAL_FILE_SIZE");if(I!==null&&o("GET_ACTIVE_ITEMS").reduce((f,v)=>f+v.fileSize,0)>I){d({status:{main:o("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:s(o("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:i(I,".",o("GET_FILE_SIZE_BASE"),o("GET_FILE_SIZE_LABELS",o))})}});return}c(l)})),{options:{allowFileSizeValidation:[!0,n.BOOLEAN],maxFileSize:[null,n.INT],minFileSize:[null,n.INT],maxTotalFileSize:[null,n.INT],fileValidateSizeFilter:[null,n.FUNCTION],labelMinFileSizeExceeded:["File is too small",n.STRING],labelMinFileSize:["Minimum file size is {filesize}",n.STRING],labelMaxFileSizeExceeded:["File is too large",n.STRING],labelMaxFileSize:["Maximum file size is {filesize}",n.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",n.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",n.STRING]}}},lf=typeof window<"u"&&typeof window.document<"u";lf&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Ja}));var zs=new Map,On=new WeakMap,ta=0,cf=void 0;function df(e){return e?(On.has(e)||(ta+=1,On.set(e,ta.toString())),On.get(e)):"0"}function uf(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?df(e.root):e[t]}`).toString()}function pf(e){const t=uf(e);let n=zs.get(t);if(!n){const s=new Map;let i;const l=new IntersectionObserver(o=>{o.forEach(c=>{var d;const m=c.isIntersecting&&i.some(p=>c.intersectionRatio>=p);e.trackVisibility&&typeof c.isVisible>"u"&&(c.isVisible=m),(d=s.get(c.target))==null||d.forEach(p=>{p(m,c)})})},e);i=l.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:l,elements:s},zs.set(t,n)}return n}function hf(e,t,n={},s=cf){if(typeof window.IntersectionObserver>"u"&&s!==void 0){const d=e.getBoundingClientRect();return t(s,{isIntersecting:s,target:e,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:i,observer:l,elements:o}=pf(n),c=o.get(e)||[];return o.has(e)||o.set(e,c),c.push(t),l.observe(e),function(){c.splice(c.indexOf(t),1),c.length===0&&(o.delete(e),l.unobserve(e)),o.size===0&&(l.disconnect(),zs.delete(i))}}function ff({threshold:e,delay:t,trackVisibility:n,rootMargin:s,root:i,triggerOnce:l,skip:o,initialInView:c,fallbackInView:d,onChange:m}={}){var p;const[b,I]=R.useState(null),y=R.useRef(),[f,v]=R.useState({inView:!!c,entry:void 0});y.current=m,R.useEffect(()=>{if(o||!b)return;let D;return D=hf(b,(U,k)=>{v({inView:U,entry:k}),y.current&&y.current(U,k),k.isIntersecting&&l&&D&&(D(),D=void 0)},{root:i,rootMargin:s,threshold:e,trackVisibility:n,delay:t},d),()=>{D&&D()}},[Array.isArray(e)?e.toString():e,b,i,s,l,o,n,d,t]);const O=(p=f.entry)==null?void 0:p.target,_=R.useRef();!b&&O&&!l&&!o&&_.current!==O&&(_.current=O,v({inView:!!c,entry:void 0}));const L=[I,f.inView,f.entry];return L.ref=L[0],L.inView=L[1],L.entry=L[2],L}const at=Object.create(null);at.open="0";at.close="1";at.ping="2";at.pong="3";at.message="4";at.upgrade="5";at.noop="6";const kn=Object.create(null);Object.keys(at).forEach(e=>{kn[at[e]]=e});const $s={type:"error",data:"parser error"},eo=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",to=typeof ArrayBuffer=="function",no=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,hr=({type:e,data:t},n,s)=>eo&&t instanceof Blob?n?s(t):na(t,s):to&&(t instanceof ArrayBuffer||no(t))?n?s(t):na(new Blob([t]),s):s(at[e]+(t||"")),na=(e,t)=>{const n=new FileReader;return n.onload=function(){const s=n.result.split(",")[1];t("b"+(s||""))},n.readAsDataURL(e)};function sa(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Ds;function mf(e,t){if(eo&&e.data instanceof Blob)return e.data.arrayBuffer().then(sa).then(t);if(to&&(e.data instanceof ArrayBuffer||no(e.data)))return t(sa(e.data));hr(e,!1,n=>{Ds||(Ds=new TextEncoder),t(Ds.encode(n))})}const ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ln=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<ra.length;e++)ln[ra.charCodeAt(e)]=e;const _f=e=>{let t=e.length*.75,n=e.length,s,i=0,l,o,c,d;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const m=new ArrayBuffer(t),p=new Uint8Array(m);for(s=0;s<n;s+=4)l=ln[e.charCodeAt(s)],o=ln[e.charCodeAt(s+1)],c=ln[e.charCodeAt(s+2)],d=ln[e.charCodeAt(s+3)],p[i++]=l<<2|o>>4,p[i++]=(o&15)<<4|c>>2,p[i++]=(c&3)<<6|d&63;return m},gf=typeof ArrayBuffer=="function",fr=(e,t)=>{if(typeof e!="string")return{type:"message",data:so(e,t)};const n=e.charAt(0);return n==="b"?{type:"message",data:Ef(e.substring(1),t)}:kn[n]?e.length>1?{type:kn[n],data:e.substring(1)}:{type:kn[n]}:$s},Ef=(e,t)=>{if(gf){const n=_f(e);return so(n,t)}else return{base64:!0,data:e}},so=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},ro=String.fromCharCode(30),bf=(e,t)=>{const n=e.length,s=new Array(n);let i=0;e.forEach((l,o)=>{hr(l,!1,c=>{s[o]=c,++i===n&&t(s.join(ro))})})},yf=(e,t)=>{const n=e.split(ro),s=[];for(let i=0;i<n.length;i++){const l=fr(n[i],t);if(s.push(l),l.type==="error")break}return s};function Tf(){return new TransformStream({transform(e,t){mf(e,n=>{const s=n.length;let i;if(s<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s);else if(s<65536){i=new Uint8Array(3);const l=new DataView(i.buffer);l.setUint8(0,126),l.setUint16(1,s)}else{i=new Uint8Array(9);const l=new DataView(i.buffer);l.setUint8(0,127),l.setBigUint64(1,BigInt(s))}e.data&&typeof e.data!="string"&&(i[0]|=128),t.enqueue(i),t.enqueue(n)})}})}let Ms;function Pn(e){return e.reduce((t,n)=>t+n.length,0)}function Ln(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let s=0;for(let i=0;i<t;i++)n[i]=e[0][s++],s===e[0].length&&(e.shift(),s=0);return e.length&&s<e[0].length&&(e[0]=e[0].slice(s)),n}function If(e,t){Ms||(Ms=new TextDecoder);const n=[];let s=0,i=-1,l=!1;return new TransformStream({transform(o,c){for(n.push(o);;){if(s===0){if(Pn(n)<1)break;const d=Ln(n,1);l=(d[0]&128)===128,i=d[0]&127,i<126?s=3:i===126?s=1:s=2}else if(s===1){if(Pn(n)<2)break;const d=Ln(n,2);i=new DataView(d.buffer,d.byteOffset,d.length).getUint16(0),s=3}else if(s===2){if(Pn(n)<8)break;const d=Ln(n,8),m=new DataView(d.buffer,d.byteOffset,d.length),p=m.getUint32(0);if(p>Math.pow(2,53-32)-1){c.enqueue($s);break}i=p*Math.pow(2,32)+m.getUint32(4),s=3}else{if(Pn(n)<i)break;const d=Ln(n,i);c.enqueue(fr(l?d:Ms.decode(d),t)),s=0}if(i===0||i>e){c.enqueue($s);break}}}})}const io=4;function ve(e){if(e)return vf(e)}function vf(e){for(var t in ve.prototype)e[t]=ve.prototype[t];return e}ve.prototype.on=ve.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};ve.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this};ve.prototype.off=ve.prototype.removeListener=ve.prototype.removeAllListeners=ve.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var s,i=0;i<n.length;i++)if(s=n[i],s===t||s.fn===t){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+e],this};ve.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(n){n=n.slice(0);for(var s=0,i=n.length;s<i;++s)n[s].apply(this,t)}return this};ve.prototype.emitReserved=ve.prototype.emit;ve.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};ve.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Zn=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0))(),Qe=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())(),Rf="arraybuffer";function ao(e,...t){return t.reduce((n,s)=>(e.hasOwnProperty(s)&&(n[s]=e[s]),n),{})}const Sf=Qe.setTimeout,wf=Qe.clearTimeout;function Jn(e,t){t.useNativeTimers?(e.setTimeoutFn=Sf.bind(Qe),e.clearTimeoutFn=wf.bind(Qe)):(e.setTimeoutFn=Qe.setTimeout.bind(Qe),e.clearTimeoutFn=Qe.clearTimeout.bind(Qe))}const Af=1.33;function Nf(e){return typeof e=="string"?Cf(e):Math.ceil((e.byteLength||e.size)*Af)}function Cf(e){let t=0,n=0;for(let s=0,i=e.length;s<i;s++)t=e.charCodeAt(s),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(s++,n+=4);return n}function oo(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function xf(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function Of(e){let t={},n=e.split("&");for(let s=0,i=n.length;s<i;s++){let l=n[s].split("=");t[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return t}class Pf extends Error{constructor(t,n,s){super(t),this.description=n,this.context=s,this.type="TransportError"}}class mr extends ve{constructor(t){super(),this.writable=!1,Jn(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,s){return super.emitReserved("error",new Pf(t,n,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=fr(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=xf(t);return n.length?"?"+n:""}}class Lf extends mr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||n()})),this.writable||(s++,this.once("drain",function(){--s||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};yf(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,bf(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=oo()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let lo=!1;try{lo=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Df=lo;function Mf(){}class kf extends Lf{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let s=location.port;s||(s=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,n){const s=this.request({method:"POST",data:t});s.on("success",n),s.on("error",(i,l)=>{this.onError("xhr post error",i,l)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,s)=>{this.onError("xhr poll error",n,s)}),this.pollXhr=t}}class it extends ve{constructor(t,n,s){super(),this.createRequest=t,Jn(this,s),this._opts=s,this._method=s.method||"GET",this._uri=n,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const n=ao(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(n);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&s.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var i;s.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=it.requestsCount++,it.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Mf,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete it.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}it.requestsCount=0;it.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ia);else if(typeof addEventListener=="function"){const e="onpagehide"in Qe?"pagehide":"unload";addEventListener(e,ia,!1)}}function ia(){for(let e in it.requests)it.requests.hasOwnProperty(e)&&it.requests[e].abort()}const Uf=function(){const e=co({xdomain:!1});return e&&e.responseType!==null}();class Bf extends kf{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=Uf&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new it(co,this.uri(),t)}}function co(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Df))return new XMLHttpRequest}catch{}if(!t)try{return new Qe[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const uo=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Ff extends mr{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,s=uo?{}:ao(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,s)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const s=t[n],i=n===t.length-1;hr(s,this.supportsBinary,l=>{try{this.doWrite(s,l)}catch{}i&&Zn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=oo()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const ks=Qe.WebSocket||Qe.MozWebSocket;class Gf extends Ff{createSocket(t,n,s){return uo?new ks(t,n,s):n?new ks(t,n):new ks(t)}doWrite(t,n){this.ws.send(n)}}class Vf extends mr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=If(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(n).getReader(),i=Tf();i.readable.pipeTo(t.writable),this._writer=i.writable.getWriter();const l=()=>{s.read().then(({done:c,value:d})=>{c||(this.onPacket(d),l())}).catch(c=>{})};l();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const s=t[n],i=n===t.length-1;this._writer.write(s).then(()=>{i&&Zn(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const Hf={websocket:Gf,webtransport:Vf,polling:Bf},jf=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,qf=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ws(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),s=e.indexOf("]");n!=-1&&s!=-1&&(e=e.substring(0,n)+e.substring(n,s).replace(/:/g,";")+e.substring(s,e.length));let i=jf.exec(e||""),l={},o=14;for(;o--;)l[qf[o]]=i[o]||"";return n!=-1&&s!=-1&&(l.source=t,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=Yf(l,l.path),l.queryKey=zf(l,l.query),l}function Yf(e,t){const n=/\/{2,9}/g,s=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function zf(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,i,l){i&&(n[i]=l)}),n}const Ks=typeof addEventListener=="function"&&typeof removeEventListener=="function",Un=[];Ks&&addEventListener("offline",()=>{Un.forEach(e=>e())},!1);class gt extends ve{constructor(t,n){if(super(),this.binaryType=Rf,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const s=Ws(t);n.hostname=s.host,n.secure=s.protocol==="https"||s.protocol==="wss",n.port=s.port,s.query&&(n.query=s.query)}else n.host&&(n.hostname=Ws(n.host).host);Jn(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(s=>{const i=s.prototype.name;this.transports.push(i),this._transportsByName[i]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Of(this.opts.query)),Ks&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Un.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=io,n.transport=t,this.id&&(n.sid=this.id);const s=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&gt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",gt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(n+=Nf(i)),s>0&&n>this._maxPayload)return this.writeBuffer.slice(0,s);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Zn(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,s){return this._sendPacket("message",t,n,s),this}send(t,n,s){return this._sendPacket("message",t,n,s),this}_sendPacket(t,n,s,i){if(typeof n=="function"&&(i=n,n=void 0),typeof s=="function"&&(i=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const l={type:t,data:n,options:s};this.emitReserved("packetCreate",l),this.writeBuffer.push(l),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},s=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(gt.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ks&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Un.indexOf(this._offlineEventListener);s!==-1&&Un.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}gt.protocol=io;class $f extends gt{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),s=!1;gt.priorWebsocketSuccess=!1;const i=()=>{s||(n.send([{type:"ping",data:"probe"}]),n.once("packet",b=>{if(!s)if(b.type==="pong"&&b.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;gt.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(p(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const I=new Error("probe error");I.transport=n.name,this.emitReserved("upgradeError",I)}}))};function l(){s||(s=!0,p(),n.close(),n=null)}const o=b=>{const I=new Error("probe error: "+b);I.transport=n.name,l(),this.emitReserved("upgradeError",I)};function c(){o("transport closed")}function d(){o("socket closed")}function m(b){n&&b.name!==n.name&&l()}const p=()=>{n.removeListener("open",i),n.removeListener("error",o),n.removeListener("close",c),this.off("close",d),this.off("upgrading",m)};n.once("open",i),n.once("error",o),n.once("close",c),this.once("close",d),this.once("upgrading",m),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&n.push(t[s]);return n}}let Wf=class extends $f{constructor(t,n={}){const s=typeof t=="object"?t:n;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(i=>Hf[i]).filter(i=>!!i)),super(t,s)}};function Kf(e,t="",n){let s=e;n=n||typeof location<"u"&&location,e==null&&(e=n.protocol+"//"+n.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=n.protocol+e:e=n.host+e),/^(https?|wss?):\/\//.test(e)||(typeof n<"u"?e=n.protocol+"//"+e:e="https://"+e),s=Ws(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const l=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+l+":"+s.port+t,s.href=s.protocol+"://"+l+(n&&n.port===s.port?"":":"+s.port),s}const Xf=typeof ArrayBuffer=="function",Qf=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,po=Object.prototype.toString,Zf=typeof Blob=="function"||typeof Blob<"u"&&po.call(Blob)==="[object BlobConstructor]",Jf=typeof File=="function"||typeof File<"u"&&po.call(File)==="[object FileConstructor]";function _r(e){return Xf&&(e instanceof ArrayBuffer||Qf(e))||Zf&&e instanceof Blob||Jf&&e instanceof File}function Bn(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let n=0,s=e.length;n<s;n++)if(Bn(e[n]))return!0;return!1}if(_r(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Bn(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&Bn(e[n]))return!0;return!1}function em(e){const t=[],n=e.data,s=e;return s.data=Xs(n,t),s.attachments=t.length,{packet:s,buffers:t}}function Xs(e,t){if(!e)return e;if(_r(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}else if(Array.isArray(e)){const n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=Xs(e[s],t);return n}else if(typeof e=="object"&&!(e instanceof Date)){const n={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=Xs(e[s],t));return n}return e}function tm(e,t){return e.data=Qs(e.data,t),delete e.attachments,e}function Qs(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=Qs(e[n],t);else if(typeof e=="object")for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Qs(e[n],t));return e}const nm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],sm=5;var ee;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(ee||(ee={}));class rm{constructor(t){this.replacer=t}encode(t){return(t.type===ee.EVENT||t.type===ee.ACK)&&Bn(t)?this.encodeAsBinary({type:t.type===ee.EVENT?ee.BINARY_EVENT:ee.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===ee.BINARY_EVENT||t.type===ee.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=em(t),s=this.encodeAsString(n.packet),i=n.buffers;return i.unshift(s),i}}function aa(e){return Object.prototype.toString.call(e)==="[object Object]"}class gr extends ve{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const s=n.type===ee.BINARY_EVENT;s||n.type===ee.BINARY_ACK?(n.type=s?ee.EVENT:ee.ACK,this.reconstructor=new im(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(_r(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const s={type:Number(t.charAt(0))};if(ee[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===ee.BINARY_EVENT||s.type===ee.BINARY_ACK){const l=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const o=t.substring(l,n);if(o!=Number(o)||t.charAt(n)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(n+1)==="/"){const l=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););s.nsp=t.substring(l,n)}else s.nsp="/";const i=t.charAt(n+1);if(i!==""&&Number(i)==i){const l=n+1;for(;++n;){const o=t.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===t.length)break}s.id=Number(t.substring(l,n+1))}if(t.charAt(++n)){const l=this.tryParse(t.substr(n));if(gr.isPayloadValid(s.type,l))s.data=l;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case ee.CONNECT:return aa(n);case ee.DISCONNECT:return n===void 0;case ee.CONNECT_ERROR:return typeof n=="string"||aa(n);case ee.EVENT:case ee.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&nm.indexOf(n[0])===-1);case ee.ACK:case ee.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class im{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=tm(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const am=Object.freeze(Object.defineProperty({__proto__:null,Decoder:gr,Encoder:rm,get PacketType(){return ee},protocol:sm},Symbol.toStringTag,{value:"Module"}));function tt(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const om=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ho extends ve{constructor(t,n,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[tt(t,"open",this.onopen.bind(this)),tt(t,"packet",this.onpacket.bind(this)),tt(t,"error",this.onerror.bind(this)),tt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var s,i,l;if(om.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:ee.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const p=this.ids++,b=n.pop();this._registerAckCallback(p,b),o.id=p}const c=(i=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||i===void 0?void 0:i.writable,d=this.connected&&!(!((l=this.io.engine)===null||l===void 0)&&l._hasPingExpired());return this.flags.volatile&&!c||(d?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,n){var s;const i=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(i===void 0){this.acks[t]=n;return}const l=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},i),o=(...c)=>{this.io.clearTimeoutFn(l),n.apply(this,c)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...n){return new Promise((s,i)=>{const l=(o,c)=>o?i(o):s(c);l.withError=!0,n.push(l),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...l)=>s!==this._queue[0]?void 0:(i!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(i)):(this._queue.shift(),n&&n(null,...l)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ee.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ee.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ee.EVENT:case ee.BINARY_EVENT:this.onevent(t);break;case ee.ACK:case ee.BINARY_ACK:this.onack(t);break;case ee.DISCONNECT:this.ondisconnect();break;case ee.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const s of n)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let s=!1;return function(...i){s||(s=!0,n.packet({type:ee.ACK,id:t,data:i}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ee.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let s=0;s<n.length;s++)if(t===n[s])return n.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let s=0;s<n.length;s++)if(t===n[s])return n.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const s of n)s.apply(this,t.data)}}}function zt(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}zt.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+n:e-n}return Math.min(e,this.max)|0};zt.prototype.reset=function(){this.attempts=0};zt.prototype.setMin=function(e){this.ms=e};zt.prototype.setMax=function(e){this.max=e};zt.prototype.setJitter=function(e){this.jitter=e};class Zs extends ve{constructor(t,n){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Jn(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((s=n.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new zt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const i=n.parser||am;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Wf(this.uri,this.opts);const n=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=tt(n,"open",function(){s.onopen(),t&&t()}),l=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),t?t(c):this.maybeReconnectOnOpen()},o=tt(n,"error",l);if(this._timeout!==!1){const c=this._timeout,d=this.setTimeoutFn(()=>{i(),l(new Error("timeout")),n.close()},c);this.opts.autoUnref&&d.unref(),this.subs.push(()=>{this.clearTimeoutFn(d)})}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(tt(t,"ping",this.onping.bind(this)),tt(t,"data",this.ondata.bind(this)),tt(t,"error",this.onerror.bind(this)),tt(t,"close",this.onclose.bind(this)),tt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){Zn(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new ho(this,t,n),this.nsps[t]=s),s}_destroy(t){const n=Object.keys(this.nsps);for(const s of n)if(this.nsps[s].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let s=0;s<n.length;s++)this.engine.write(n[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},n);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const rn={};function Fn(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const n=Kf(e,t.path||"/socket.io"),s=n.source,i=n.id,l=n.path,o=rn[i]&&l in rn[i].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let d;return c?d=new Zs(s,t):(rn[i]||(rn[i]=new Zs(s,t)),d=rn[i]),n.query&&!t.query&&(t.query=n.queryKey),d.socket(n.path,t)}Object.assign(Fn,{Manager:Zs,Socket:ho,io:Fn,connect:Fn});const lm="admin",cm=({id_contract:e})=>{const t=R.useRef(null),n="https://chat-dev.tplus.co.th",s=localStorage.getItem(lm),i=s?JSON.parse(s??"{}").role:null,l=s?JSON.parse(s).access_token:null,[o,c]=R.useState("");R.useState("shop");const[d,m]=R.useState(!1),[p,b]=R.useState(""),[I,y]=R.useState([]),[f,v]=R.useState(i),[O,_]=R.useState(""),[L,D]=R.useState(!1),[U,k]=R.useState(!1),V=R.useRef(null);R.useEffect(()=>{C({data:{id_contract:e.toString(),client_id:""}}),Y({data:{contract_list:[e]}})},[o]);const[te,M]=R.useState(!1),{mutate:Y}=Tn("/chat/check-unread",{onSuccess:H=>{var he;((he=H==null?void 0:H.data[0])==null?void 0:he.unread)>0?(M(!0),m(!0),X({data:{id_contract:e.toString()}})):(M(!1),m(!1))}}),{mutate:X}=Tn("/chat/update-read",{onSuccess:H=>{M(!1)}});R.useEffect(()=>{try{t.current=Fn(n,{transports:["websocket"],forceNew:!0,query:{id_contract:e.toString()}}),t.current.on("connect",()=>{t.current&&c(t.current.id)}),t.current.on("connect_error",H=>{console.error("WebSocket connection error:",H)}),t.current.on("newMessage",H=>{y(he=>[...he,H])}),t.current.on("typing",H=>{})}catch(H){console.warn(H)}return()=>{t.current&&t.current.disconnect()}},[n,l]);const w=R.useRef(null),z=()=>{m(!d),X({data:{id_contract:e.toString()}})},Ee=H=>{b(H.target.value)},P=H=>{H.key==="Enter"&&!H.shiftKey&&B()},Z=H=>{X({data:{id_contract:e.toString()}})},{mutate:N}=Tn("/chat/message/",{onSuccess:()=>{}}),{mutate:C}=Tn("/chat/chatroom/",{onSuccess:H=>{var he;y(((he=H==null?void 0:H.data)==null?void 0:he.messages)??[])}}),B=()=>{p.trim()&&(N({data:{id_contract:e.toString(),content:p,type:"text",client_id:o}}),b(""),t.current)},{mutateAsync:F,isLoading:J}=da({onSuccess:H=>{},onError:H=>{}}),S=async H=>{var he;if(H.target.files&&H.target.files.length>0){const Ot=H.target.files[0],K=Ot.type.startsWith("image")?"image":"video";try{k(!0);const fe=await F({data:{file:Ot,type:"chat"}});fe!=null&&fe.data&&(N({data:{id_contract:e.toString(),content:(he=fe==null?void 0:fe.data)==null?void 0:he.file_name,type:K,client_id:o}}),k(!1))}catch(q){k(!1),console.error("Error uploading file:",q)}}},Ye=H=>H=="business_unit"&&f=="admin"||H=="admin"&&f=="business_unit"?!0:f===H;return R.useEffect(()=>{V.current&&(V.current.scrollTop=V.current.scrollHeight)},[I,d]),h("div",{className:"fixed bottom-4 right-16",style:{zIndex:1},children:[U&&a(ua,{}),L&&a(Js,{mainSrc:O,onCloseRequest:()=>D(!1)}),te&&a("div",{className:"pointer flex items-center space-x-2 absolute",children:a("span",{className:"w-3 h-3 rounded-full bg-red-500"})}),a("button",{onClick:z,className:"bg-blue-500 text-white p-4 rounded-full shadow-lg flex items-center justify-center",children:d?a(Ft,{className:"text-xl"}):a(di,{className:"text-2xl"})}),d&&h("div",{className:"bg-white w-96 h-96 shadow-lg rounded-lg mt-4 p-4 flex flex-col",children:[a(yc,{className:"flex-grow overflow-y-auto mb-4",options:{suppressScrollX:!0,wheelPropagation:!1},containerRef:H=>V.current=H,children:I.map(H=>h("div",{className:`flex items-start gap-3 mb-4 ${Ye(H.sender)?"justify-end":"justify-start"}`,children:[a(di,{className:"w-6 h-6"}),h("div",{className:`${Ye(H.sender)?"text-right":""}`,children:[H.type==="text"&&a("div",{className:`p-3 rounded-lg flex items-center justify-center gap-2 max-w-[200px] ${Ye(H.sender)?"bg-blue-100":"bg-gray-100"}`,children:a("p",{className:"break-all text-left",style:{whiteSpace:"pre-wrap"},children:H.content})}),H.type==="image"&&a("div",{className:"rounded-lg overflow-hidden",children:a("img",{src:H.content,alt:"sent content",className:"w-48 h-auto rounded-lg",onClick:()=>{_(H.content),D(!0)}})}),H.type==="video"&&a("div",{className:"rounded-lg overflow-hidden",children:h("video",{controls:!0,className:"w-48 h-auto rounded-lg",children:[a("source",{src:H.content,type:"video/mp4"}),"Your browser does not support the video tag."]})}),a("p",{className:"text-xs text-gray-500 mt-1",children:H.created_at}),f!="shop"||H.sender=="shop"&&h("p",{className:"text-xs text-gray-500 mt-1",children:[":",H.sender_name]})]})]},H.message_id))}),h("div",{className:"border-t border-gray-200 pt-4 flex items-center gap-2",children:[a("textarea",{value:p,onChange:Ee,onKeyDown:P,onFocus:Z,className:"flex-grow p-2 border rounded-lg resize-none",placeholder:"Type a message",rows:1}),a("button",{onClick:()=>{var H;return(H=w.current)==null?void 0:H.click()},className:"text-gray-500 hover:text-primary",children:a(Yc,{})})," *",a("input",{type:"file",ref:w,style:{display:"none"},accept:"image/*",onChange:S}),a("button",{onClick:B,className:"text-primary hover:text-primary-dark",children:a(qc,{})})]})]})]})};var Se=function(){return Se=Object.assign||function(t){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},Se.apply(this,arguments)};function es(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]]);return n}function oa(e){if(e){var t=e.textContent,n=/[\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC]/;e.style.direction=t&&n.test(t[0])?"rtl":"ltr"}}function fo(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(Boolean).join(" ")}function dm(){if(document.selection)return document.selection.createRange().parentElement();var e=window.getSelection();if(e&&e.rangeCount>0)return e.getRangeAt(0).startContainer.parentNode||void 0}function la(e){return typeof e=="string"?e.replace(/&nbsp;|\u202F|\u00A0/g," ").replace(/<br \/>/g,"<br>"):String(e)}function um(e){var t=document.createTextNode("");e.appendChild(t);var n=document.activeElement===e;if(t!==null&&t.nodeValue!==null&&n){var s=window.getSelection();if(s!==null){var i=document.createRange();i.setStart(t,t.nodeValue.length),i.collapse(!0),s.removeAllRanges(),s.addRange(i)}e instanceof HTMLElement&&e.focus()}}function mo(e,t){typeof t=="function"?t(e):typeof t=="object"&&t&&(t.current=e)}var pm=j.memo(j.forwardRef(function(t,n){var s=t.className,i=t.disabled,l=t.tagName,o=t.value,c=o===void 0?"":o,d=t.placeholder,m=es(t,["className","disabled","tagName","value","placeholder"]),p=j.useRef(null),b=j.useRef(c),I=j.useRef(m);return j.useEffect(function(){I.current=m;var y=p.current;y&&la(b.current)!==la(c)&&(b.current=c,y.innerHTML=c,um(y))}),j.useMemo(function(){function y(O){p.current=O,oa(O),mo(O,n)}function f(O){var _,L,D=p.current;if(D){var U=D.innerHTML;U!==b.current&&((L=(_=I.current).onChange)===null||L===void 0||L.call(_,Se(Se({},O),{target:{value:U,name:m.name}}))),oa(D),b.current=U}}var v=fo("rsw-ce",s);return j.createElement(l||"div",Se(Se({},m),{className:v,contentEditable:!i,dangerouslySetInnerHTML:{__html:c},onBlur:function(O){return(I.current.onBlur||f)(O)},onInput:f,onKeyDown:function(O){return(I.current.onKeyDown||f)(O)},onKeyUp:function(O){return(I.current.onKeyUp||f)(O)},placeholder:d,ref:y}))},[s,i,d,l])})),_o=j.createContext(void 0);function go(e){var t=e.children,n=j.useState({htmlMode:!1,update:l}),s=n[0],i=n[1];function l(o){i(function(c){return Se(Se({},c),o)})}return j.createElement(_o.Provider,{value:s},t)}function pn(){var e=j.useContext(_o);if(!e)throw new Error("You should wrap your component by EditorProvider");return e}var ca=[],an=[];function hm(e,t){if(e&&typeof document<"u"){var n,s=t.prepend===!0?"prepend":"append",i=t.singleTag===!0,l=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var o=ca.indexOf(l);o===-1&&(o=ca.push(l)-1,an[o]={}),n=an[o]&&an[o][s]?an[o][s]:an[o][s]=c()}else n=c();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function c(){var d=document.createElement("style");if(d.setAttribute("type","text/css"),t.attributes)for(var m=Object.keys(t.attributes),p=0;p<m.length;p++)d.setAttribute(m[p],t.attributes[m[p]]);var b=s==="prepend"?"afterbegin":"beforeend";return l.insertAdjacentElement(b,d),d}}var fm=".rsw-editor{border:1px solid #ddd;border-radius:.375rem;display:flex;flex-direction:column;min-height:100px;overflow:hidden}.rsw-ce{flex:1 1 auto;overflow:auto;padding:.5rem}.rsw-ce:focus{outline:1px solid #668}.rsw-ce[contentEditable=true]:empty:not(:focus):before{color:grey;content:attr(placeholder);pointer-events:none}.rsw-html{background:transparent;border:none;font-family:monospace,Courier New}.rsw-separator{align-self:stretch;border-right:1px solid #ddd;display:flex;margin:0 3px}.rsw-dd{box-sizing:border-box;outline:none}.rsw-btn{background:transparent;border:0;color:#222;cursor:pointer;font-size:1em;height:2em;outline:none;padding:0;width:2em}.rsw-btn:hover{background:#eaeaea}.rsw-btn[data-active=true]{background:#e0e0e0}.rsw-toolbar{align-items:center;background-color:#f5f5f5;border-bottom:1px solid #ddd;display:flex}";hm(fm,{});var Eo=j.forwardRef(function(t,n){var s=t.autoFocus,i=t.children,l=t.containerProps,o=t.onSelect,c=es(t,["autoFocus","children","containerProps","onSelect"]),d=pn();j.useEffect(function(){return document.addEventListener("click",m),function(){return document.removeEventListener("click",m)}});function m(y){var f;y.target!==d.$el&&(!((f=d.$el)===null||f===void 0)&&f.contains(y.target)||d.update({$selection:void 0}))}function p(y){o==null||o(y),d.update({$selection:dm()})}function b(y){d.update({$el:y}),mo(y,n),s&&y&&d.$el===void 0&&y.focus()}var I=fo("rsw-editor",l==null?void 0:l.className);return d.htmlMode?j.createElement("div",Se({},l,{className:I}),i,j.createElement("textarea",Se({},c,{className:"rsw-ce rsw-html"}))):j.createElement("div",Se({},l,{className:I}),i,j.createElement(pm,Se({},c,{ref:b,onSelect:p})))});function mm(){return j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",style:{verticalAlign:"text-top"}},j.createElement("path",{fill:"currentColor",d:"M6.99938 12.998v-2H20.9994v2H6.99938zm0 6.0001v-2H20.9994v2H6.99938zm0-12.00001v-2H20.9994v2H6.99938zm-4 1v-3h-1v-1h2v4h-1zm-1 9.00001v-1h3v4h-3v-1h2v-.5h-1v-1h1v-.5h-2zM4.25 10c.41421 0 .75.3358.75.75 0 .2024-.08017.3861-.2105.521L3.11983 13H5v1H2v-.9218L4 11H2v-1h2.25z"}))}function _m(){return j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",style:{verticalAlign:"text-top"}},j.createElement("path",{fill:"currentColor",d:"M7 5h14v2H7V5zm0 8v-2h14v2H7zM4 4.50001c.83 0 1.5.66992 1.5 1.5 0 .83007-.67 1.5-1.5 1.5s-1.5-.66993-1.5-1.5c0-.83008.67-1.5 1.5-1.5zM4 10.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zM7 19v-2h14v2H7zm-3-2.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5z"}))}var bo=ot("Bold","","bold"),gm=ot("Bullet list",j.createElement(_m,null),"insertUnorderedList"),Em=ot("Clear formatting","T","removeFormat"),bm=ot("Italic","","italic"),ym=ot("Strike through",j.createElement("s",null,"ab"),"strikeThrough"),Tm=ot("Link","",function(e){var t=e.$selection;(t==null?void 0:t.nodeName)==="A"?document.execCommand("unlink"):document.execCommand("createLink",!1,prompt("URL","")||void 0)}),Im=ot("Numbered list",j.createElement(mm,null),"insertOrderedList"),yo=ot("Redo","","redo"),To=ot("Underline",j.createElement("span",{style:{textDecoration:"underline"}},""),"underline"),Io=ot("Undo","","undo");function ot(e,t,n){return s.displayName=e.replace(/\s/g,""),s;function s(i){var l=pn(),o=l.$el,c=function(){return!!(o!=null&&o.contains(document.activeElement))},d=!1;typeof n=="string"&&(d=c()&&document.queryCommandState(n));function m(p){p.preventDefault(),c()||o==null||o.focus(),typeof n=="function"?n(l):document.execCommand(n)}return l.htmlMode?null:j.createElement("button",Se({className:"rsw-btn","data-active":d,onMouseDown:m,tabIndex:-1,title:e,type:"button"},i),t)}}var vm=Rm("Styles",[["Normal","formatBlock","DIV"],[" ","formatBlock","H1"],["Header 2","formatBlock","H2"],["","formatBlock","PRE"]]);function Rm(e,t){return n.displayName=e,n;function n(s){var i=pn(),l=i.$el,o=i.$selection,c=i.htmlMode;if(c)return null;var d=t.findIndex(function(p){return p[1]==="formatBlock"&&(o==null?void 0:o.nodeName)===p[2]});return j.createElement(Sm,Se({},s,{items:t,onChange:m,selected:d,tabIndex:-1,title:e}));function m(p){var b=p.target,I=b.value,y=parseInt(I,10),f=t[y]||[],v=f[1],O=f[2];p.preventDefault(),document.activeElement!==l&&(l==null||l.focus()),typeof v=="function"?v(i):v&&document.execCommand(v,!1,O),setTimeout(function(){return b.value=I},10)}}}function Sm(e){var t=e.items,n=e.selected,s=es(e,["items","selected"]);return j.createElement("select",Se({className:"rsw-dd"},s,{value:n}),j.createElement("option",{hidden:!0},s.title),t.map(function(i,l){return j.createElement("option",{key:i[2],value:l},i[0])}))}function wm(e){var t=es(e,[]),n=pn();function s(){n.update({htmlMode:!n.htmlMode})}return j.createElement("button",Se({className:"rsw-btn","data-active":n.htmlMode,onClick:s,tabIndex:-1,title:"HTML mode",type:"button"},t),"</>")}function cn(e){var t=pn();return t.htmlMode?null:j.createElement("div",Se({className:"rsw-separator"},e))}function vo(e){return j.createElement("div",Se({className:"rsw-toolbar"},e))}j.forwardRef(function(t,n){return j.createElement(go,null,j.createElement(Eo,Se({},t,{ref:n}),t.children||j.createElement(vo,null,j.createElement(Io,null),j.createElement(yo,null),j.createElement(cn,null),j.createElement(bo,null),j.createElement(bm,null),j.createElement(To,null),j.createElement(ym,null),j.createElement(cn,null),j.createElement(Im,null),j.createElement(gm,null),j.createElement(cn,null),j.createElement(Tm,null),j.createElement(Em,null),j.createElement(wm,null),j.createElement(cn,null),j.createElement(vm,null))))});const Am=e=>({label:t,name:n,placeholder:s,require:i=!1,hidden:l=!1,row:o,...c})=>{var I,y;const[d,m]=Ac(n),p=m.touched&&m.error,b=()=>{const f=d.value;f&&(navigator.clipboard.writeText(f),Gt("copy ","success"))};return h("div",{className:`${l?"hidden":"input-container"} ${o?"flex flex-row items-center gap-3":""}`,children:[h("label",{htmlFor:n,className:`${o?"mb-0":null}`,children:[t,i&&a("span",{className:"text-rose-600",children:" * "})]}),h("div",{className:p?"relative has-error":"relative text-white-dark",children:[h("div",{className:`${c.disabled?"bg-[#eee]":"hover:border-[#5f68af]"} relative form-input w-full h-10 flex gap-0 pl-0 pr-16 py-0 items-center justify-start border rounded-lg mb-0 overflow-hidden`,children:[h("button",{type:"button",onClick:c.showStatus?void 0:c.onGenerate,className:`rounded-l-lg h-full outline-none min-w-32 text-sm text-primary  ${c.showStatus?"bg-gray-300 cursor-default":"bg-dark  hover:underline"}  text-white h-full`,children:[c.loading&&a("span",{className:"animate-spin border-2 border-white border-l-transparent rounded-full w-5 h-5 ltr:mr-4 rtl:ml-4 inline-block align-middle"}),""]}),a("span",{className:"pl-2 text-black overflow-hidden whitespace-nowrap",title:typeof d.value=="string"?d.value:void 0,children:d.value?((y=(I=d.value[0])==null?void 0:I.file)==null?void 0:y.name)||d.value:"-"})]}),c.showStatus&&d.value?a(Tt,{className:"text-green-500 absolute right-10 top-1/2 -translate-y-1/2"}):d.value?a(Kc,{className:"text-red-500 absolute right-10 top-1/2 -translate-y-1/2"}):void 0,c.copy&&a("span",{onClick:b,children:a(Wc,{className:"absolute right-3 top-1/2 -translate-y-1/2 cursor-pointer hover:text-primary"})}),a(Nc,{name:n,component:"div",className:"text-danger mt-1"})]})]})},Nm=Am();qn(Za);qn(Ja);const on="admin",Cm=(e,t)=>{switch(t.type){case"change":return{status:t.status,link:t.link};case"change-signed":return{...e,link:t.link};case"change-status":return{...e,status:t.status};default:return e}},M_=()=>{var $r,Wr;const{ref:e,inView:t}=ff({threshold:.1}),n=Qr(r=>r.themeConfig.rtlClass)==="rtl",{id:s,uuid:i}=Tc(),l=Qr(r=>r.dataStore.credit_level),o=s?Number(s):void 0,c=i||void 0,d=ce.mixin(Cc),m=Ic(),p=vc(),b=localStorage.getItem(on),I=b?JSON.parse(b).id:null,y=b?JSON.parse(b).role:null,f=y==="admin"||y==="business_unit",v=!rt.isUndefined(c),O=[{to:"/apps/contract/list",label:""},{label:v?"":"",isCurrent:!0}],[_,L]=R.useState(0),[D,U]=R.useState([]),[k,V]=R.useState([]),[te,M]=R.useState([]),[Y,X]=R.useState([]),[w,z]=R.useState({}),[Ee,P]=R.useState([]),[Z,N]=R.useState([]);R.useState([]);const[C,B]=R.useState({}),[F,J]=R.useState([]),[S,Ye]=R.useState({}),[H,he]=R.useState([]),[Ot,K]=R.useState([]),[q,fe]=R.useState({}),[Ge,Ae]=R.useState(null),[Et,ts]=R.useState(!1),[Ro,So]=R.useState([]),[hn,wo]=R.useState([]),[dt,ns]=R.useState(null),[ss,rs]=R.useState([]),[fn,Er]=R.useState([]),[is,as]=R.useState(null),[Ao,os]=R.useState(!1),[No,br]=R.useState(""),[yr,Tr]=R.useState(!1),[Ir,ls]=R.useState(!1),[vr,cs]=R.useState(!1),[Rr,$t]=R.useState(!1),[ie,xm]=R.useState({}),[ut,me]=R.useState(!1);R.useState(!1),R.useState(!1);const[Co,xo]=R.useState([]),[Sr,Oo]=R.useState([]),[Po,Lo]=R.useState([]),[ds,Do]=R.useState("none"),[wr,Mo]=R.useState(!1),[de,ko]=R.useState(!1),[us,Uo]=R.useState([]),[Bo,Fo]=R.useState([]),[Go,Vo]=R.useState(null),[Ar,Ho]=R.useState(!1),[Om,jo]=R.useState(null),[ps,Nr]=R.useState(""),[E,mn]=R.useState({contract_date:Bt(Ne().toISOString(!0))+"T00:00:00.000Z",contract_no:"",id_shop:"",id_shop_group:0,id_business_unit:"",id_customer:"",id_asset:"",price:0,down_payment:0,down_payment_rate:null,down_payment_type:"percent",principle:0,ins_amount:0,ins_period:null,ins_pay_day:Ne().date()!=31?Ne().date():30,ins_period_unit:"month",ins_due_at:Bt(Ne().add(1,"M").toISOString(!0))+"T00:00:00.000Z",id_employee:1,contract_ref_link:"",is_active:!0,rate_name:"rate",rate_per_month:null,status_id:1,contract_type_id:null,insurance_type_id:null,memo:"",commission:0,commission_type:1,commission_price:0,penalty_fee:0,penalty_fee_limit:0,unlock_fee:0,tracking_fee:0,preliminary_credit_assessment:0,fee:0,is_locked:!1,condition_contract:"",price_total:0,benefit:0,has_advance_installments:!1,prev_contract_count:null,contract_process_text:"",refinance_ref:"",customer_signature_at:""}),[Cr,qo]=R.useState(null),[Yo,hs]=R.useState(!1),[bt,zo]=R.useState({}),[$o,Wo]=R.useState({note:"",contentStatus:null}),[_n,Ko]=R.useState({isLockedStatus:!1,provider_applock_id:"",history:[]}),[Xo,xr]=R.useState(!1),[Wt,pt]=R.useState("contract");R.useState(!1);const[fs,ms]=R.useReducer(Cm,{status:!1,link:""}),Or=r=>{open("/apps/contract/"+r,"_blank")},Pr=r=>{let u=0;return(r==null?void 0:r.commission_type)==1?u=r.commission/100*r.principle:(r==null?void 0:r.commission_type)==2&&(u=r.commission/100*r.price),parseFloat(u.toFixed(2))},[gn,Lr]=R.useState(!1),Qo=()=>Lr(!0),Dr=()=>Lr(!1),Zo=()=>{var r;return(r=ht.current)==null?void 0:r.clear()},ht=R.useRef(null),[Mr,Jo]=R.useState(null),{mutate:el,isLoading:tl}=oe(Q.contractShopRCSign,{onSuccess:r=>{r.statusCode===200||r.code===200?(d.fire({icon:"success",title:"",padding:"10px 20px"}),location.reload()):d.fire({icon:"error",title:r.message,padding:"10px 20px"})},onError:r=>{}}),nl=async()=>{if(!ht.current||ht.current.isEmpty()){ce.fire("","","warning");return}ce.fire({title:"",text:"?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3b3f5c",cancelButtonColor:"#e7515a",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0}).then(async r=>{var u;if(r.isConfirmed)try{let T=function(Oe,be){const ae=Oe.split(","),Pe=ae[0].match(/:(.*?)/)[1],Le=atob(ae[1]);let De=Le.length;const je=new Uint8Array(De);for(;De--;)je[De]=Le.charCodeAt(De);return new File([je],be,{type:Pe})};const g=ht.current.getCanvas().toDataURL("image/png"),G=T(g,"signature_shop.png"),$=await ys({data:{file:G,type:"contract"}});$!=null&&$.data&&el({data:{id_contract:c,file_name:(u=$==null?void 0:$.data)==null?void 0:u.file_name}})}catch(T){console.error(":",T),ce.fire("",T.message||"","error")}})};R.useEffect(()=>(gn&&window.addEventListener("resize",_s),()=>{window.removeEventListener("resize",_s)}),[gn]);const _s=()=>{var r;if(ht.current){const u=ht.current.getCanvas(),T=Math.max(window.devicePixelRatio||1,1);u.width=u.offsetWidth*T,u.height=u.offsetHeight*T,(r=u.getContext("2d"))==null||r.scale(T,T),ht.current.clear()}},{mutate:sl,isLoading:rl}=ft(Q.contractShopRC+c,{onSuccess:r=>{if(r.statusCode===400||r.code===400)ce.fire({icon:"error",title:r.message,padding:"10px 20px"});else{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u);Jo(T)}},onError:r=>{console.log("error",r)}}),{mutate:ze,isLoading:il}=oe(Q.contractFindData+`${c}/?tab=${Wt}`,{onSuccess(r){var u,T,g,G,re,$,Oe,be,ae,Pe,Le,De,je,x,ne,se,ue,$e,Xt,Qt;switch(Wt){case"contract":L(r.data.status_id),mn({...r.data}),B(r.data.business_unit),Ye(r.data.customer),fe(r.data.asset),z(r.data.shop),Do(r.data.refinance),Mo(r.data.is_refinance),qo(((u=r==null?void 0:r.data)==null?void 0:u.refinance_ref_link)??null),!r.data.is_refinance&&["complete","on_process"].includes(r.data.refinance)&&ko(!0);const _c=[{value:r.data.shop.id,label:r.data.shop.name,data:r.data.shop}];X(_c);const gc=[{value:r.data.business_unit.id,label:r.data.business_unit.name,data:r.data.business_unit}];P(gc);const Ec=[{value:r.data.customer.id,label:r.data.customer.name,data:r.data.customer}];J(Ec);const Kr=[{value:r.data.asset.id,label:r.data.asset.name,data:r.data.asset}],bc=(g=(T=r.data)==null?void 0:T.shop_groups)==null?void 0:g.map(We=>({value:We.id,label:We.name,data:We}));N(bc),he(Kr),K(Kr),Ae(r.data.rate_per_month),ts(!0),Kt({data:{id_shop:r.data.shop.id,id_business_unit:r.data.business_unit.id,id_shop_group:r.data.id_shop_group,...c&&{id_contract:c}}});break;case"additional":if(mn(We=>({...We,contract_images:r.data.contract_images,contract_pdf_url:r.data.contract_pdf_url,e_contract_status:r.data.e_contract_status,e_contract_link:r.data.e_contract_link,contract_key:r.data.contract_key})),(G=r.data)!=null&&G.contract_pdf_url&&ns((re=r.data)==null?void 0:re.contract_pdf_url),(($=r.data)==null?void 0:$.contract_images.length)>0){const We=[];(Oe=r.data)==null||Oe.contract_images.forEach(async Mt=>{Mt.type==="image"?We.push({dataURL:Mt.image_url,name:Mt.name,id:Mt.id}):as({url:Mt.image_url,type:Mt.type})}),rs(We)}break;case"history":So(r.data||[]);break;case"installment":wo(r.data);case"credit":Wo({contentStatus:(ae=(be=r.data)==null?void 0:be.credit)!=null&&ae.code?(Le=(Pe=r.data)==null?void 0:Pe.credit)==null?void 0:Le.code:null,note:(je=(De=r.data)==null?void 0:De.credit)!=null&&je.note?(ne=(x=r.data)==null?void 0:x.credit)==null?void 0:ne.note:null}),Uo((se=r.data)==null?void 0:se.credit_histories);break;case"note-event":xo(r.data);break;case"device-lock":Ko({isLockedStatus:!((ue=r.data)!=null&&ue.is_locked),history:($e=r.data)==null?void 0:$e.history,provider_applock_id:(Xt=r.data)==null?void 0:Xt.provider_applock_id}),Fo(((Qt=r.data)==null?void 0:Qt.provider_applock.map(We=>({value:We.id,label:We.title||We.service_provider})))||[]);break}}}),{mutate:al}=ft(Q.contractCleanPDF+c,{onSuccess:r=>{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u),g=document.createElement("a");g.href=T,g.download=`${E==null?void 0:E.reference}_${Ne().utc().format("DD-MM-yyyy")}.pdf`,g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g),setTimeout(()=>{window.URL.revokeObjectURL(T)},100),me(!1)},onError:r=>{me(!1)}}),{mutate:ol}=ft(Q.contractRC+c,{onSuccess:r=>{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u),g=document.createElement("a");g.href=T,g.download=`${E==null?void 0:E.reference}_rc_${Ne().utc().format("DD-MM-yyyy")}.pdf`,g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g),setTimeout(()=>{window.URL.revokeObjectURL(T)},100),me(!1)},onError:r=>{me(!1)}}),{mutate:ll}=ft(Q.contractPDPA+c,{onSuccess:r=>{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u),g=document.createElement("a");g.href=T,g.download=`${E==null?void 0:E.reference}_pdpa_${Ne().utc().format("DD-MM-yyyy")}.pdf`,g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g),setTimeout(()=>{window.URL.revokeObjectURL(T)},100),me(!1)},onError:r=>{me(!1)}}),{mutate:cl}=ft(Q.contractGoodsReceiptPDF+c,{onSuccess:r=>{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u),g=document.createElement("a");g.href=T,g.download=`${E==null?void 0:E.reference}_goods_receipt_${Ne().utc().format("DD-MM-yyyy")}.pdf`,g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g),setTimeout(()=>{window.URL.revokeObjectURL(T)},100),me(!1)},onError:r=>{me(!1)}}),{mutate:dl,isLoading:ul}=oe(Q.contractRequestToPayDATA+c,{onSuccess:r=>{r!=null&&r.data&&(Nr(r==null?void 0:r.data.content),ls(!0))},onError:r=>{me(!1)}}),{mutate:pl}=ft(Q.contractRequestToPayPDF+c,{onSuccess:r=>{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u),g=document.createElement("a");g.href=T,g.download=`${E==null?void 0:E.reference}_request_to_pay_${Ne().utc().format("DD-MM-yyyy")}.pdf`,g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g),setTimeout(()=>{window.URL.revokeObjectURL(T)},100),me(!1)},onError:r=>{me(!1)}}),{mutate:hl}=ft(Q.contractCloseToPDF+c,{onSuccess:r=>{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u),g=document.createElement("a");g.href=T,g.download=`${E==null?void 0:E.reference}_close_contract/_${Ne().utc().format("DD-MM-yyyy")}.pdf`,g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g),setTimeout(()=>{window.URL.revokeObjectURL(T)},100),me(!1)},onError:r=>{me(!1)}}),{mutate:fl,isLoading:ml}=oe(Q.contractRequestToPayDATA+c,{onSuccess:r=>{var u,T,g,G,re;r!=null&&r.data&&(jo(r==null?void 0:r.data),Pt(Lt({down_payment:((u=r==null?void 0:r.data)==null?void 0:u.down_payment)??"",ins_amount:((T=r==null?void 0:r.data)==null?void 0:T.ins_period)??"",penalty_fee:((g=r==null?void 0:r.data)==null?void 0:g.penalty_fee)??"",unlock_fee:((G=r==null?void 0:r.data)==null?void 0:G.unlock_fee)??"",other_fee:((re=r==null?void 0:r.data)==null?void 0:re.other_fee)??""}))),cs(!0),me(!1)},onError:r=>{me(!1)}}),_l=R.useCallback(async r=>{El({data:{down_payment:r!=null&&r.down_payment&&(r==null?void 0:r.down_payment)!==""?r==null?void 0:r.down_payment:0,ins_amount:r!=null&&r.ins_amount&&(r==null?void 0:r.ins_amount)!==""?r==null?void 0:r.ins_amount:0,penalty_fee:r!=null&&r.penalty_fee&&(r==null?void 0:r.penalty_fee)!==""?r==null?void 0:r.penalty_fee:0,unlock_fee:r!=null&&r.unlock_fee&&(r==null?void 0:r.unlock_fee)!==""?r==null?void 0:r.unlock_fee:0,other_fee:r!=null&&r.other_fee&&(r==null?void 0:r.other_fee)!==""?r==null?void 0:r.other_fee:0,deduct_down_payment:r!=null&&r.deduct_down_payment&&(r==null?void 0:r.deduct_down_payment)!==""?r==null?void 0:r.deduct_down_payment:0,total:r!=null&&r.total&&(r==null?void 0:r.total)!==""?r==null?void 0:r.total:0}})},[]),[kr,Pt]=R.useState({down_payment:"",ins_amount:"",penalty_fee:"",unlock_fee:"",other_fee:"",deduct_down_payment:"",total:""}),gl=()=>{fl({data:{only_data:!0}})},Lt=r=>{let u=0,T=Math.ceil(((r==null?void 0:r.down_payment)??0)*(50/100));return r!=null&&r.down_payment&&(r==null?void 0:r.down_payment)!==""&&(r==null?void 0:r.down_payment)>0&&(u=u!==0?u-(r==null?void 0:r.down_payment):r==null?void 0:r.down_payment),r!=null&&r.ins_amount&&(r==null?void 0:r.ins_amount)!==""&&(r==null?void 0:r.ins_amount)>0&&(u=u!==0?u-(r==null?void 0:r.ins_amount):r==null?void 0:r.ins_amount),r!=null&&r.penalty_fee&&(r==null?void 0:r.penalty_fee)!==""&&(r==null?void 0:r.penalty_fee)>0&&(u=u!==0?u-(r==null?void 0:r.penalty_fee):r==null?void 0:r.penalty_fee),r!=null&&r.unlock_fee&&(r==null?void 0:r.unlock_fee)!==""&&(r==null?void 0:r.unlock_fee)>0&&(u=u!==0?u-(r==null?void 0:r.unlock_fee):r==null?void 0:r.unlock_fee),r!=null&&r.other_fee&&(r==null?void 0:r.other_fee)!==""&&(r==null?void 0:r.other_fee)>0&&(u=u!==0?u-(r==null?void 0:r.other_fee):r==null?void 0:r.other_fee),r!=null&&r.down_payment&&(r==null?void 0:r.down_payment)!==""&&(r==null?void 0:r.down_payment)>0&&(u=u-T),{down_payment:(r==null?void 0:r.down_payment)??"",ins_amount:(r==null?void 0:r.ins_amount)??"",penalty_fee:(r==null?void 0:r.penalty_fee)??"",unlock_fee:(r==null?void 0:r.unlock_fee)??"",other_fee:(r==null?void 0:r.other_fee)??"",deduct_down_payment:T??"",total:u??""}};R.useEffect(()=>{},[kr]);const{mutate:El,isLoading:bl}=ft(Q.contractReturnReceiptToPDF+c,{onSuccess:r=>{const u=new Blob([r],{type:"application/pdf"}),T=window.URL.createObjectURL(u),g=document.createElement("a");g.href=T,g.download=`${E==null?void 0:E.reference}_return_receipt/_${Ne().utc().format("DD-MM-yyyy")}.pdf`,g.target="_blank",document.body.appendChild(g),g.click(),document.body.removeChild(g),setTimeout(()=>{window.URL.revokeObjectURL(T)},100)},onError:r=>{}}),{mutate:yl}=oe(Q.contractPayload,{onSuccess:r=>{var u,T,g,G,re;V((u=r.data.contract_type)==null?void 0:u.map($=>({value:$.id,label:$.name,data:$}))),U((T=r.data.contract_status)==null?void 0:T.map($=>({value:$.id,label:$.name,data:$}))),M((g=r.data.insurance_type)==null?void 0:g.map($=>({value:$.id,label:$.name,data:$}))),Oo((G=r.data.credit_status)==null?void 0:G.map($=>({value:$.code,label:$.code+" - "+$.name,data:$}))),Lo((re=r.data.credit_status)==null?void 0:re.filter($=>$.code!=40).map($=>({value:$.code,label:$.code+" - "+$.name,data:$})))}}),{mutate:gs}=oe(Q.contractGetShop,{onSuccess:r=>{if(I){const u=r.data.find(g=>g.id===I);z(u);const T=[{value:u.id,label:u.name,data:u}];X(T),mn(g=>({...g,id_shop:u.id})),P(u.business_units.map(g=>({value:g.id,label:g.name,data:g}))),En({data:{query:"",id_shop:u.id,page:1,pageSize:10}}),bn({data:{query:"",id_shop:u.id,page:1,pageSize:10}})}else X(r.data.map(u=>({value:u.id,label:u.name,data:u})))},onError:()=>{console.error("Failed to fetch dashboard data")}});oe(Q.contractGetShop,{onSuccess:r=>{I?r.data.find(u=>u.id===I):r.data.find(u=>u.id===(w==null?void 0:w.id))},onError:()=>{console.error("Failed to fetch dashboard data")}});const{mutate:Es,isLoading:Tl}=oe(Q.contractSearchContains,{onSuccess:r=>{var u,T,g,G,re;if((u=r==null?void 0:r.data)!=null&&u.reference)if(!((T=r==null?void 0:r.data)!=null&&T.contract_date))lc((g=r==null?void 0:r.data)==null?void 0:g.reference,w==null?void 0:w.id);else{Ho(!0);const{id:$,uuid:Oe,asset:be,customer:ae,insurance_type:Pe,shop:Le,credit:De,is_closed:je,...x}=r.data;mn({...x,ins_pay_day:Ne().date()!=31?Ne().date():30,ins_due_at:Bt(Ne().add(1,"month").toISOString(!0))+"T00:00:00.000Z",reference:"",status_id:1,contract_date:Bt(Ne().toISOString(!0))+"T00:00:00.000Z",id_shop:bt.id_shop,contract_type_id:bt==null?void 0:bt.contract_type_id,insurance_type_id:bt==null?void 0:bt.insurance_type_id,is_refinance:!0,refinance_ref:r.data.reference,down_payment_type:"percent",has_advance_installments:!1}),B(r.data.business_unit),Ye(r.data.customer),fe(r.data.asset);const ne=[{value:r.data.business_unit.id,label:r.data.business_unit.name,data:r.data.business_unit}];P(ne);const se=[{value:r.data.customer.id,label:r.data.customer.name,data:r.data.customer}];J(se);const ue=[{value:r.data.asset.id,label:r.data.asset.name,data:r.data.asset}];N((re=(G=r.data)==null?void 0:G.shop_groups)==null?void 0:re.map($e=>({value:$e.id,label:$e.name,data:$e}))),he(ue),K(ue),ts(!0),Kt({data:{id_shop:r.data.id_shop,id_business_unit:r.data.business_unit.id,id_contract:r.data.uuid}}),hs(!1)}else hs(!1),d.fire({icon:"error",title:(r==null?void 0:r.message)??"",padding:"10px 20px"})},onError:()=>{hs(!1),d.fire({icon:"error",title:"",padding:"10px 20px"})}}),{mutate:Il}=oe(Q.shopFind,{onSuccess:r=>{gs({data:{query:r.data.name,page:1,pageSize:1}})},onError:()=>{console.error("Failed to fetch dashboard data")}}),{mutate:En}=oe(Q.customerSearchContains,{onSuccess:r=>{J(r.data.map(u=>({value:u.id,label:u.name,data:u})))}}),{mutate:bn}=oe(Q.assetSearchContains,{onSuccess:r=>{K([...H,...r.data.map(u=>({value:u.id,label:u.name,data:u}))])}}),{mutate:Kt}=oe(Q.contractGetRate,{onSuccess:(r,u)=>{var T,g;ts(!0),r.statusCode===200||r.code===200?(Ae(r.data),u.props&&(u.props.setFieldValue("id_shop_group",r.data.id_shop_group),((g=(T=u.props)==null?void 0:T.values)==null?void 0:g.is_refinance)==!0?(u.props.setFieldValue("ins_period",6),u.props.setFieldValue("rate_per_month",r.data.inr_6)):u.props.setFieldValue("rate_per_month",r.data.inr_3))):(d.fire({icon:"warning",title:r.message,padding:"10px 20px"}),Ae(null))}}),{mutate:Ur,isLoading:vl}=oe(Q.contractCreate,{onSuccess:r=>{r.statusCode===200||r.code===200?(d.fire({icon:"success",title:"",padding:"10px 20px"}),m("/apps/contract/"+r.data.id+"/"+r.data.uuid),location.reload()):d.fire({icon:"error",title:r.message,padding:"10px 20px"})},onError:r=>{}}),{mutate:bs,isLoading:Rl}=oe(Q.contractUpdate,{onSuccess:r=>{r.statusCode===200||r.code===200?(d.fire({icon:"success",title:"",padding:"10px 20px"}),ze({})):d.fire({icon:"error",title:r.message,padding:"10px 20px"})},onError:r=>{}}),{mutate:Sl,isLoading:wl}=oe(Q.contractUpdateStatus,{onSuccess:r=>{r.statusCode!==400?(d.fire({icon:"success",title:"",padding:"10px 20px"}),ze({})):d.fire({icon:"error",title:r.message,padding:"10px 20px"})}}),{mutateAsync:Al,isLoading:Nl}=oe(Q.contractUpdateStatus,{onSuccess:r=>{r.statusCode!==400?(d.fire({icon:"success",title:"",padding:"10px 20px"}),pt("contract"),ze({})):d.fire({icon:"error",title:r.message,padding:"10px 20px"})}}),{mutate:Cl,isLoading:xl}=oe(Q.contractPostComplete,{onSuccess:r=>{r.statusCode===200&&r.code===200?(d.fire({icon:"success",title:"",padding:"10px 20px"}),ze({})):d.fire({icon:"error",title:r.message,padding:"10px 20px"})}}),{mutate:Ol,isLoading:Pm}=oe(Q.cancelContract,{onSuccess:r=>{r.statusCode!==400?(d.fire({icon:"success",title:"",padding:"10px 20px"}),ze({})):d.fire({icon:"error",title:r.message,padding:"10px 20px"})}}),{mutate:Br}=oe(Q.contractUpdateCredit,{onSuccess:r=>{r.statusCode!==400?(d.fire({icon:"success",title:"",padding:"10px 20px"}),ze({})):d.fire({icon:"error",title:r.message,padding:"10px 20px"})},onError:()=>{console.error("Failed to fetch dashboard data")}}),{mutate:Fr}=oe(Q.updateLockDevice,{onSuccess:r=>{r.statusCode!==400?(d.fire({icon:"success",title:"",padding:"10px 20px"}),xr(!0),setTimeout(()=>{xr(!1),ze({})},5e3)):d.fire({icon:"error",title:r.message,padding:"10px 20px"})},onError:()=>{console.error("Failed to fetch dashboard data")}}),{mutateAsync:ys,isLoading:Pl}=da({onSuccess:r=>{},onError:r=>{}}),[yn,Ts]=R.useState(0),Ll=async r=>{const u=localStorage.getItem(on),T=u?JSON.parse(u):null;let g=new FormData;return g.append("file",r.data.file),g.append("type",r.data.type),await Rs.post("https://dev-tms-admin.gsrental.cn:7443/api/v1"+Q.uploadfile,g,{method:"post",maxBodyLength:1/0,headers:{Authorization:`Bearer ${T==null?void 0:T.access_token}`},onUploadProgress:G=>{const re=Math.round(G.loaded*100/G.total);Ts(re)}}).then(G=>(Ts(0),G.data)).catch(G=>{Ts(0),console.error("Error uploading file:",G)})},{mutate:Dl,isLoading:Ml}=oe(Q.contractUpDocV2,{onSuccess:r=>{r.statusCode===200||r.code===200?d.fire({icon:"success",title:"",padding:"10px 20px"}):d.fire({icon:"error",title:r.message,padding:"10px 20px"})}}),{mutate:Gr,isLoading:kl}=oe(Q.contractAddMessage,{onSuccess:()=>{ze({})}}),{mutate:Ul,isLoading:Bl}=oe(Q.contractAppvRestart,{onSuccess:r=>{r.statusCode===200||r.code===200?(d.fire({icon:"success",title:"",padding:"10px 20px"}),setTimeout(()=>{location.reload()},2e3)):d.fire({icon:"error",title:r==null?void 0:r.message,padding:"10px 20px"})},onError:r=>{d.fire({icon:"warning",title:r.message,padding:"10px 20px"})}}),{mutateAsync:Vr}=oe(Q.contractAddImage),{mutateAsync:Is}=oe(Q.contractRemoveImage);R.useEffect(()=>{E!=null&&E.contract_key&&(E!=null&&E.e_contract_status)?hc():E!=null&&E.e_contract_link&&!(E!=null&&E.e_contract_status)&&Wt=="additional"&&pc()},[E]),R.useEffect(()=>{E.is_completed?p(In(["contract","/apps/contract/list-complete"])):_===5?p(In(["contract","/apps/contract/list-credit"])):_>5?p(In(["contract","/apps/contract/list-cancel"])):p(In(["contract","/apps/contract/list"]))},[_]),R.useEffect(()=>{p(Rc("")),yl({}),I&&(c||Il({id:I}))},[]),R.useEffect(()=>{c&&(ze({}),Wt=="additional"&&sl({}))},[Wt]);const Hr=(r,u)=>{Sl({data:{id_contract:c,status_id:u,memo:r.values.memo}})},jr=(r,u,T)=>{Ol({data:{id_contract:c,status_id:T,reason_cancel:r,password:u}})},Fl=r=>{const u=r.target.files[0];ns(u)},Gl=async r=>{const u=await Mc(r);rs(u)},qr=async()=>{var g,G,re,$,Oe,be,ae,Pe,Le,De,je;let r={};const u=[],T=[];if(dt?dt.toString().includes("http")?T.push(Promise.resolve({})):T.push(ys({data:{file:dt,type:"contract"}})):(T.push(Promise.resolve({})),r.contract_pdf_url=null),fn.length>0?fn.toString().includes("http")?T.push(Promise.resolve({})):(T.push(Ll({data:{file:fn[0],type:"contract"}})),E==null||E.contract_images.forEach(x=>{x.type==="video"&&u.push(Is({data:{id_image:x.id,id_contract:o}}))})):(is===null&&(E==null||E.contract_images.forEach(x=>{x.type==="video"&&u.push(Is({data:{id_image:x.id,id_contract:o}}))})),T.push(Promise.resolve({}))),u.length>0&&await Promise.all(u),ss.forEach(x=>{rt.isUndefined(x==null?void 0:x.id)&&T.push(ys({data:{file:x.file,type:"contract"}}))}),T.length>0){const x=await Promise.all(T);(G=(g=x[0])==null?void 0:g.data)!=null&&G.file_name&&(r.contract_pdf_url=($=(re=x[0])==null?void 0:re.data)==null?void 0:$.file_name);const ne=[];(Oe=x[1].data)!=null&&Oe.file_name&&ne.push(Vr({data:{id_contract:o,name:(ae=(be=x[1])==null?void 0:be.data)==null?void 0:ae.file_name,image_url:(Le=(Pe=x[1])==null?void 0:Pe.data)==null?void 0:Le.file_name,extension:"extension",size:(je=(De=x[1])==null?void 0:De.data)==null?void 0:je.size,type:"video"}})),x.filter((se,ue)=>ue!==0&&ue!==1).forEach(se=>{(se==null?void 0:se.code)!=="error"?ne.push(Vr({data:{id_contract:o,name:se.data.file_name,image_url:se.data.file_name,extension:"extension",size:se.data.size}})):d.fire({icon:"error",title:"",padding:"10px 20px"})}),ne.length>0&&await Promise.all(ne)}r!=null&&r.contract_pdf_url&&Dl({data:{id_contract:c,...r}}),_==5?d.fire({icon:"success",title:"",padding:"10px 20px"}):await Al({data:{id_contract:c,status_id:4,memo:E.memo}})},Vl=(r,u)=>{switch(r){case"complete":return"btn-success";default:return _<5||E.is_closed?"btn-dark":u?"btn-danger":"btn-dark"}},Hl=r=>r.split(" ")[0]==""?" px-3 py-1 rounded-[8px] text-white bg-green-500":r.split(" ")[0]==""?" px-3 py-1 rounded-[8px] text-white bg-danger":void 0,jl=(r,u,T)=>{switch(r){case"complete":return T=="close_contract"?" ()":"";default:return _<5?"":E.is_closed?"":u?"":""}},ql=r=>{let u;if(_<5)return"";if(r.ins_no<=1)u=!0;else{const T=hn.find(g=>g.ins_no===r.ins_no-1);u=(T==null?void 0:T.status)==="complete"}switch(r.status){case"complete":return a("button",{type:"button",className:"btn btn-sm btn-outline-success",style:{display:"block",margin:"auto"},onClick:()=>Yr(r),children:""});default:return!E.is_closed&&_===5&&!de?a("button",{type:"button",className:`btn btn-sm ${u?"btn-outline-primary":"btn-outline-secondary"}`,style:{display:"block",margin:"auto",color:u?"":"gray"},onClick:()=>u&&Yr(r),disabled:!u||E.on_payment_process==="close_contract",children:E.on_payment_process=="pay_installment"?"":""}):"-"}},Yr=r=>{r.invoice_type=="close_contract"&&r.status=="complete"?m("/apps/contract/close-contract/"+o+"/"+c):m("/apps/contract/payment/"+o+"/"+c+"/"+r.id)},Yl=()=>{me(!0),console.log(ps),ut||pl({data:{content:ps??null}})},zl=R.useCallback(async r=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0}).then(u=>{if(u.isConfirmed){const T={...r,price:+r.price,down_payment:+r.down_payment,price_total:r.ins_amount*r.ins_period+parseInt(r.down_payment)},{contract_process_text:g,contract_pdf_url:G,contract_ref_link:re,created_at:$,prev_contract_count:Oe,prev_contract_time:be,reason_cancel:ae,approved_by:Pe,approved_time:Le,is_closed:De,is_completed:je,business_unit:x,asset:ne,customer:se,insurance_type:ue,shop:$e,credit:Xt,...Qt}=T;v?bs({data:Qt,id:c}):Ur({data:Qt})}})},[Ur,v]),$l=R.useCallback(async r=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0}).then(u=>{var T;if(u.isConfirmed){const g=Sr.find(G=>G.value===r.contentStatus);Br({data:{id_contract:c,credit_id:(T=g==null?void 0:g.data)==null?void 0:T.id,note:r.note}})}})},[Br,c,Sr]),Wl=R.useCallback(async r=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0,html:`<label for="password" style="display: block text-align: left font-size: 1rem margin-top: 10px color: #000000 color: #000000">:</label>
          <input id="password" type="password" type="text" class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000" placeholder=" /">`,preConfirm:()=>{var T;const u=(T=document==null?void 0:document.getElementById("password"))==null?void 0:T.value;return u?{password:u}:(ce.showValidationMessage(""),!1)}}).then(u=>{if(u.isConfirmed){const{password:T}=u.value;Fr({data:{id_contract:c,is_locked:r.isLockedStatus,provider_applock_id:r.provider_applock_id,password:T}})}})},[Fr,c]),Kl=async r=>{bs({data:{...r.values,status_id:2},id:c})},Xl=async r=>{bs({data:{...r.values,status_id:3},id:c})},zr=R.useCallback(async r=>{Gr({data:{message:r.message,id_contract:c}})},[Gr,c]),Dt=(r,u,T)=>{var g,G,re,$;switch(T){case"id_shop":z(u.data),P(u.data.business_units.map(be=>({value:be.id,label:be.name,data:be}))),B({}),J([]),Ye({}),K([]),fe({}),En({data:{query:"",id_shop:u.data.id,page:1,pageSize:10}}),bn({data:{query:"",id_shop:u.data.id,page:1,pageSize:10}});break;case"id_business_unit":B(u.data);let Oe=0;((g=u.data)==null?void 0:g.shop_groups.length)>0&&(Oe=(G=u.data)==null?void 0:G.shop_groups[0].id),N(($=(re=u.data)==null?void 0:re.shop_groups)==null?void 0:$.map(be=>({value:be.id,label:be.name,data:be}))),E!=null&&E.is_refinance?(r.setFieldValue("commission",u.data.commission||0),r.setFieldValue("penalty_fee",u.data.penalty_fee||0),r.setFieldValue("penalty_fee_limit",u.data.penalty_fee_limit||0),r.setFieldValue("unlock_fee",u.data.unlock_fee||0),r.setFieldValue("tracking_fee",u.data.tracking_fee||0),r.setFieldValue("preliminary_credit_assessment",u.data.preliminary_credit_assessment||0),r.setFieldValue("benefit",u.data.benefit),r.setFieldValue("fee",u.data.fee||0),r.setFieldValue("condition_contract",u.data.condition_contract),r.setFieldValue("commission_type",u.data.commission_type),r.setFieldValue("down_payment_rate",.2),Kt({data:{id_shop:r.values.id_shop,id_business_unit:u.value,...c&&{id_contract:c}},props:r})):(K([]),E!=null&&E.id||(fe({}),r.setFieldValue("price",0),r.setFieldValue("down_payment",0),r.setFieldValue("principle",0),r.setFieldValue("ins_period",null),r.setFieldValue("ins_pay_day",Ne().date()),r.setFieldValue("down_payment_rate",.2),r.setFieldValue("id_shop_group",Oe),r.setFieldValue("commission",u.data.commission||0),r.setFieldValue("penalty_fee",u.data.penalty_fee||0),r.setFieldValue("penalty_fee_limit",u.data.penalty_fee_limit||0),r.setFieldValue("unlock_fee",u.data.unlock_fee||0),r.setFieldValue("tracking_fee",u.data.tracking_fee||0),r.setFieldValue("preliminary_credit_assessment",u.data.preliminary_credit_assessment||0),r.setFieldValue("benefit",u.data.benefit),r.setFieldValue("fee",u.data.fee||0),r.setFieldValue("condition_contract",u.data.condition_contract),r.setFieldValue("commission_type",u.data.commission_type)),Kt({data:{id_shop:r.values.id_shop,id_business_unit:u.value,id_shop_group:Oe,...c&&{id_contract:c}},props:r}));break;case"id_customer":Ye(u.data);break;case"id_asset":fe(u.data),r.setFieldValue("price",u.data.price||0),r.setFieldValue("principle",u.data.price||0);break;case"ins_period":Ge&&r.setFieldValue("rate_per_month",Ge[u.ref]);break;case"id_shop_group":Kt({data:{id_shop:r.values.id_shop,id_business_unit:r.values.id_business_unit,id_shop_group:u.value,...c&&{id_contract:c}},props:r});break}},vs=(r,u,T)=>{var g;switch(T){case"id_shop":gs({data:{query:u,page:1,pageSize:10,contract_type_id:((g=r.values)==null?void 0:g.contract_type_id)??0}});break;case"id_customer":En({data:{query:u,id_shop:w.id,page:1,pageSize:10}});break;case"id_asset":bn({data:{query:u,id_shop:w.id,page:1,pageSize:10}});break}},Ql=()=>{d.fire({icon:"error",title:" 15 ",padding:"10px 20px"})},Zl=r=>{const u=r.match(/\.(jpg|jpeg|png|gif|pdf|jfif)(\?.*)?$/);if(u){const T=u[1].toLowerCase();if(["jpg","jpeg","png","gif"].includes(T))return"image";if(T==="pdf")return"pdf"}return"unknown"},Jl=async()=>{E.on_payment_process=="close_contract"?m("/apps/contract/close-contract/"+o+"/"+c):ce.fire({title:"",text:"",showCancelButton:!0,confirmButtonText:"",cancelButtonText:"",reverseButtons:!0,didOpen:()=>{const r=ce.getConfirmButton(),u=ce.getCancelButton();r.style.backgroundColor=pe.color.themePrimary,r.style.color="white",u.style.backgroundColor="#2196F3",u.style.color="white"}}).then(r=>{r.isConfirmed&&m("/apps/contract/close-contract/"+o+"/"+c)})},ec=()=>{var u;const r=Zl(JSON.stringify(dt));return h(Ve,{children:[a("div",{className:"upload-container",children:h("div",{className:"custom-file-container","data-upload-id":"contractDoc",children:[h("div",{className:"label-container",children:[a("p",{children:"1.   pdf   "}),(_===3||_===4&&f)&&a("button",{type:"button",className:"custom-file-container__image-clear",title:"Clear Image",onClick:()=>{ns(null)},children:"x"})]}),a("p",{className:"custom-file-container__custom-file hidden"}),(_===3||_===4&&f)&&a("input",{type:"file",className:"",onChange:Fl}),r==="pdf"?a("div",{className:"pdf-viewer-container",children:h("iframe",{src:dt,width:"800px",height:"600px",className:"block mx-auto my-8",style:{maxWidth:"100%"},children:["This browser does not support PDFs. Please download the PDF to view it:",a("a",{href:dt,children:"Download PDF"})]})}):r==="image"?a("img",{src:dt,alt:"img",className:"m-auto pointer",onClick:()=>{br(dt),os(!0)}}):""]})}),a("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6 w-full"}),a("div",{className:"flex flex-row mt-6 gap-4",children:a("div",{className:"upload-container w-full",children:h("div",{className:"custom-file-container","data-upload-id":"firstImage",children:[h("div",{className:"label-container",children:[a("p",{children:"2.  "}),(_===3||_===4&&f)&&a("button",{type:"button",className:"custom-file-container__image-clear",title:"Clear Image",onClick:()=>{rs([])},children:""})]}),a("div",{}),a("input",{type:"file",className:"custom-file-container__custom-file__custom-file-input hidden",accept:"image/*"}),a("input",{type:"hidden",name:"MAX_FILE_SIZE1",value:"10485760"}),h("div",{children:[_!==3&&y==="shop"&&a(ws,{items:ss.map(T=>({image_url:T.dataURL}))}),(_===3||_===4&&f||_===5&&f)&&a(Dc,{multiple:!0,value:ss,onChange:Gl,onError:Ql,maxNumber:15,children:({imageList:T,onImageUpload:g,onImageRemoveAll:G,onImageUpdate:re,onImageRemove:$,isDragging:Oe,dragProps:be})=>h("div",{className:"upload__image-wrapper",children:[a("button",{className:"custom-file-container__custom-file__custom-file-control",onClick:g,type:"button",children:"..."}),a("div",{className:"grid gap-4 sm:grid-cols-3 grid-cols-1 pt-[70px]",children:T.map((ae,Pe)=>h("div",{className:"custom-file-container__image-preview relative",children:[(_===3&&(ae==null?void 0:ae.id)===void 0||_===4&&(ae==null?void 0:ae.id)===void 0||_===5&&(ae==null?void 0:ae.id)===void 0)&&a("button",{type:"button",className:"custom-file-container__image-clear bg-dark-light dark:bg-dark dark:text-white-dark rounded-full block w-fit p-1 absolute top-0 left-0 z-10",title:"Clear Image",onClick:()=>{$(Pe)},children:""}),(_===3||_===4&&f)&&a("button",{type:"button",className:"custom-file-container__image-clear bg-dark-light dark:bg-dark dark:text-white-dark rounded-full block w-fit p-1 absolute top-0 left-0 z-10",title:"Clear Image",onClick:()=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0}).then(async Le=>{Le.isConfirmed&&(await Is({data:{id_image:ae.id,id_contract:o}}),$(Pe))})},children:""}),a("div",{className:"custom-file-container__image-preview relative",children:a("img",{src:ae.dataURL,alt:"img",className:"m-auto pointer",onClick:()=>{br(ae.dataURL),os(!0)}})},Pe)]},Pe))})]})})]})]})})}),a("hr",{className:"border-white-light dark:border-[#1b2e4b] my-6 w-full"}),a("div",{className:"flex flex-col mt-6 gap-4",children:a("div",{className:"upload-container w-full",children:h("div",{className:"custom-file-container",children:[h("div",{className:"label-container",children:[a("p",{children:"3. "}),(_===3||_===4&&f)&&a("button",{type:"button",className:"custom-file-container__image-clear",title:"Clear Video",onClick:()=>{Er([]),as(null)},children:""})]}),yn>0&&a("div",{className:"progress-bar-container",children:a("div",{className:"progress-bar",style:{width:`${yn}%`},children:h("p",{children:[": ",yn,"%"]})})}),(_===3||_===4&&f)&&a(af,{files:fn,onupdatefiles:T=>{Er(T.map(g=>g.file))},onaddfile:()=>{as(null)},allowMultiple:!1,acceptedFileTypes:["video/*"],labelFileTypeNotAllowed:" ",maxFileSize:"300MB",labelIdle:'   <span class="filepond--label-action"></span>'}),is!==null&&a("div",{className:"flex flex-col mt-6 items-center",children:a("video",{width:"400",controls:!0,className:"flex-1",children:a("source",{src:is.url,type:"video/mp4"})})})]})})}),((u=pe.features)==null?void 0:u.singature_rc_shop)&&a("div",{className:"flex flex-col mt-6 gap-4",children:a("div",{className:"upload-container w-full",children:h("div",{className:"custom-file-container",children:[h("div",{className:"label-container flex items-center justify-between",children:[a("p",{className:"mb-0",children:"4. "}),!(E!=null&&E.shop_signature_at)&&y==="shop"&&(E==null?void 0:E.status_id)>=3&&a("button",{type:"button",className:"btn btn-primary btn-lg",onClick:Qo,disabled:!1,children:""})]}),a("div",{className:"mb-10",children:rl?a("div",{className:"text-center text-gray-500 p-10 bg-gray-100 rounded-lg",children:a("p",{children:"..."})}):Mr?a("div",{className:"pdf-viewer-container border rounded-lg overflow-hidden shadow-sm",children:a("iframe",{src:`${Mr}#toolbar=0`,width:"100%",height:"800px",className:"border-0",title:"PDF Preview"})}):a("div",{className:"text-center text-gray-400 p-10 bg-gray-100 rounded-lg",children:a("p",{children:""})})})]})})}),a(ke,{appear:!0,show:gn,as:R.Fragment,children:h(Je,{as:"div",open:gn,onClose:Dr,className:"relative z-50",children:[a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a("div",{className:"fixed inset-0 bg-black/60"})}),a("div",{className:"fixed inset-0 overflow-y-auto",children:a("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",afterEnter:_s,children:h(Je.Panel,{className:"panel w-full max-w-xl transform text-left transition-all shadow-xl p-6 sm:p-8",children:[a(Je.Title,{as:"h3",className:"text-2xl font-bold mb-2 text-center",children:""}),a("button",{onClick:Dr,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-800",children:a(Ft,{className:"w-6 h-6"})}),a("p",{className:"mb-5 text-sm text-gray-500 text-center",children:""}),a("div",{className:"relative border-2 border-dashed rounded-lg bg-white overflow-hidden",children:a(zc,{ref:ht,penColor:"#0000DE",canvasProps:{className:"w-full h-56 sigCanvas"}})}),h("div",{className:"flex justify-center items-center gap-4 mt-6",children:[h("button",{type:"button",className:"btn btn-outline-secondary",onClick:Zo,children:[a($c,{className:"w-5 h-5 ltr:mr-2 rtl:ml-2"})," "]}),a("button",{type:"button",className:"btn btn-primary",onClick:nl,children:""})]})]})})})})]})}),(_===4||_===5)&&f&&!de&&a("button",{type:"button",className:"btn !mt-6 w-full border-0 btn-primary",onClick:()=>{qr()},children:""})]})},tc=()=>{const r={0:"w-[0%]",1:"w-[8%]",2:"w-[30%]",3:"w-[50%]",4:"w-[70%]",5:"w-[90%]"},T=`${(g=>r[g]||"")(_)}`;return _>5||!v?a("div",{className:"flex flex-col items-center",children:h("div",{className:"relative z-[1] flex-1 mt-4 w-[60vw]",children:[a("div",{className:"bg-[#f3f2ee] w-[100%] h-1 absolute ltr:left-0 rtl:right-0 top-[30px] m-auto -z-[1] transition-[width]"}),a("ul",{className:"mb-5 grid grid-cols-5",children:["","","","",""].map(G=>h("li",{className:"mx-auto flex flex-col items-center",children:[a("div",{className:"border-[3px] border-[#f3f2ee] bg-white dark:bg-[#253b5c] dark:border-[#1b2e4b] flex justify-center items-center w-16 h-16 rounded-full",children:a(Tt,{})}),a("span",{className:"text-center block mt-2",children:G})]},G))})]})}):a("div",{className:"flex flex-col items-center",children:h("div",{className:"relative z-[1] flex-1 mt-4 w-[60vw] wizard-menu",children:[a("div",{className:`${T} bg-[#19d20c] w-[15%] h-1 absolute ltr:left-0 rtl:right-0 top-[30px] m-auto -z-[1] transition-[width]`}),h("ul",{className:"mb-5 grid grid-cols-5",children:[h("li",{className:"mx-auto flex flex-col items-center",children:[a("div",{className:`${_>=1?"!border-[#19d20c] !bg-[#19d20c] text-white":""} border-[3px] border-[#f3f2ee] bg-white dark:bg-[#253b5c] dark:border-[#1b2e4b] flex justify-center items-center w-16 h-16 rounded-full`,children:a(Tt,{})}),h("p",{className:`${_>=1?"text-[#19d20c] ":""}text-center block mt-2`,children:["",a("span",{className:"wizard-isMobile",children:""})]})]}),h("li",{className:"mx-auto flex flex-col items-center",children:[a("div",{className:`${_>=2?"!border-[#19d20c] !bg-[#19d20c] text-white":""} border-[3px] border-[#f3f2ee] bg-white dark:bg-[#253b5c] dark:border-[#1b2e4b] flex justify-center items-center w-16 h-16 rounded-full`,children:a(Tt,{})}),h("p",{className:`${_>=2?"text-[#19d20c] ":""}text-center block mt-2`,children:[a("span",{className:"wizard-isMobile",children:""}),""]})]}),h("li",{className:"mx-auto flex flex-col items-center",children:[a("div",{className:`${_>=3?"!border-[#19d20c] !bg-[#19d20c] text-white":""} border-[3px] border-[#f3f2ee] bg-white dark:bg-[#253b5c] dark:border-[#1b2e4b] flex justify-center items-center w-16 h-16 rounded-full`,children:a(Tt,{})}),h("p",{className:`${_>=3?"text-[#19d20c] ":""}text-center block mt-2`,children:["",a("span",{className:"wizard-isMobile",children:""})]})]}),h("li",{className:"mx-auto flex flex-col items-center",children:[a("div",{className:`${_>=4?"!border-[#19d20c] !bg-[#19d20c] text-white":""} border-[3px] border-[#f3f2ee] bg-white dark:bg-[#253b5c] dark:border-[#1b2e4b] flex justify-center items-center w-16 h-16 rounded-full`,children:a(Tt,{})}),h("p",{className:`${_>=4?"text-[#19d20c] ":""}text-center block mt-2`,children:["",a("span",{className:"wizard-isMobile",children:""})]})]}),h("li",{className:"mx-auto flex flex-col items-center",children:[a("div",{className:`${_>=5?"!border-[#19d20c] !bg-[#19d20c] text-white":""} border-[3px] border-[#f3f2ee] bg-white dark:bg-[#253b5c] dark:border-[#1b2e4b] flex justify-center items-center w-16 h-16 rounded-full`,children:a(Tt,{})}),h("p",{className:`${_>=5?"text-[#19d20c] ":""}text-center block mt-2`,children:["",a("span",{className:"wizard-isMobile",children:""})]})]})]})]})})},nc=()=>{window.open("/apps/customer/add","_blank","noopener,noreferrer")},sc=()=>{window.open("/apps/asset/add","_blank","noopener,noreferrer")},rc=r=>{window.open("/apps/business-unit/preview/"+r.id,"_blank","noopener,noreferrer")},ic=r=>{p(wc("preview")),window.open("/apps/shop/edit/"+r.id,"_blank","noopener,noreferrer")},ac=Zt().shape({contract_type_id:Ie().nullable().required(""),insurance_type_id:Ie().nullable().required(""),contract_date:Ie().nullable().required(""),id_shop:Ie().required(""),id_customer:Ie().required(""),id_asset:Ie().required(""),price:Ie().nullable().required("").matches(yt,""),down_payment:Ie().nullable().required("").matches(yt,""),rate_per_month:Ie().nullable().required(""),ins_period:Ie().nullable().required(""),ins_due_at:Ie().nullable().required(""),ins_pay_day:Ie().nullable().required("")}),oc=Zt().shape({down_payment:Ie().nullable().required("").matches(yt,""),ins_amount:Ie().nullable().required("").matches(yt,""),...(E==null?void 0:E.penalty_fee_limit)>0?{penalty_fee:ti().max(E==null?void 0:E.penalty_fee_limit,` ${E==null?void 0:E.penalty_fee_limit} /`).required("")}:{penalty_fee:ti().required("")},unlock_fee:Ie().nullable().required("").matches(yt,""),other_fee:Ie().nullable().required("").matches(yt,""),deduct_down_payment:Ie().nullable().required("").matches(yt,"")}),lc=(r="",u="")=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0,html:`
        <label for="reference" style="display: block text-align: left font-size: 1rem margin-top: 10px color: #000000"> :</label>
        <input id="reference" type="text" type="text" value=${r} disabled class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000background: #eee">
      `}).then(T=>{T.isConfirmed&&Es(f?{data:{query:r,full:!0,id_shop:u}}:{data:{query:r,full:!0}})})},{mutateAsync:cc,isLoading:dc}=Zr(Q.ekycCreateContact,{onSuccess:r=>{r.statusCode==200&&(Gt("","success"),ze({}))},onError:r=>{d.fire({icon:"error",title:r.message,padding:"10px 20px"})}}),{mutateAsync:uc}=Zr(Q.ekycUpdateContract,{onSuccess:r=>{r.statusCode==200&&(Gt(" ekyc ","success"),ms({type:"change-status",status:!1}),ze({}))},onError:r=>{d.fire({icon:"error",title:r.message,padding:"10px 20px"})}}),pc=async()=>{try{const r=await Rs.get(`https://api.techex.co.th/v1/contracts/${E==null?void 0:E.contract_key}`);r.data.status==200&&ms({type:"change",status:r.data.data.contract.isSigned,link:r.data.data.downloadUrl})}catch{d.fire({icon:"error",title:" KYC  ",padding:"10px 20px"})}},hc=async()=>{var r,u;try{const T=await Rs.get(`https://api.techex.co.th/v1/contracts/signed/${E==null?void 0:E.contract_key}`);T.data.status==200&&ms({type:"change-signed",link:T.data.data.downloadUrl})}catch(T){d.fire({icon:"error",title:(u=(r=T==null?void 0:T.response)==null?void 0:r.data)==null?void 0:u.message,padding:"10px 20px"})}},fc=()=>{if(fs.link){const r=document.createElement("a");r.href=fs.link,r.download="contract.pdf",document.body.appendChild(r),r.click()}},{mutateAsync:mc}=oe(`${Q.ekycCancelContract}${i}`,{onSuccess:r=>{r.statusCode==200?($t(!1),Gt(" Ekyc ","success"),ze({})):Gt(r==null?void 0:r.message,"error")},onError:r=>{Gt(r==null?void 0:r.message,"error")}});return a(Ve,{children:h("div",{className:"flex flex-col gap-2.5 pb-[80px]",children:[a(Uc,{items:O}),Ao&&a(Js,{mainSrc:No,onCloseRequest:()=>os(!1)}),(ut||il||vl||Rl||Ml||Nl||wl||Pl||kl||yn>0||Xo||xl||Yo||Tl||Bl||tl||ul||bl||ml)&&a(ua,{}),E.is_completed&&a("span",{className:"text-white text-center p-4 bg-green-500 rounded-lg",children:""}),tc(),(()=>{const r=new Date().getHours();return y==="shop"&&(E!=null&&E.prev_contract_count)&&r>=10&&r<22?h("div",{className:"flex justify-between w-full bg-[#002a42] p-3 rounded text-[#ffffff]",children:[h("div",{className:"flex items-center flex-1",children:[a("div",{className:"bg-[#f45a02] w-8 h-8 rounded-full flex items-center justify-center text-white",children:a(Jr,{className:"w-4.5 h-4.5"})}),a("div",{className:"ml-2"}),""]}),h("div",{className:"flex justify-center items-center flex-1",children:["   ",E==null?void 0:E.prev_contract_count,"  "]}),h("div",{className:"flex justify-end items-center flex-1",children:[" ",E!=null&&E.prev_contract_time?E==null?void 0:E.prev_contract_time:"-"," "]})]}):null})(),a("div",{className:"panel flex-1",children:h(_e.Group,{children:[h(_e.List,{className:"mt-3 flex flex-wrap border-b border-white-light dark:border-[#191e3a]",children:[a(_e,{as:R.Fragment,children:({selected:r})=>a("button",{className:`${r?"!border-white-light !border-b-white  text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black":""} dark:hover:border-b-black -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,onClick:()=>pt("contract"),children:""})}),_>=3?a(_e,{as:R.Fragment,children:({selected:r})=>a("button",{className:`${r?"!border-white-light !border-b-white  text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black":""} dark:hover:border-b-black" -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,onClick:()=>pt("additional"),children:""})}):a(_e,{className:"pointer-events-none -mb-[1px] block p-3.5 py-2 text-white-light outline-none dark:text-dark",children:""}),c?a(_e,{as:R.Fragment,children:({selected:r})=>a("button",{className:`${r?"!border-white-light !border-b-white  text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black ":""} dark:hover:border-b-black -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,onClick:()=>pt("history"),children:""})}):a(_e,{className:"pointer-events-none -mb-[1px] block p-3.5 py-2 text-white-light outline-none dark:text-dark",children:""}),!I&&(c&&(E==null?void 0:E.status_id)>3?a(_e,{as:R.Fragment,children:({selected:r})=>a("button",{className:`${r?"!border-white-light !border-b-white text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black":""} dark:hover:border-b-black -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,onClick:()=>pt("installment"),children:""})}):a(_e,{className:"pointer-events-none -mb-[1px] block p-3.5 py-2 text-white-light outline-none dark:text-dark",children:""})),!I&&(_>=5?a(_e,{as:R.Fragment,children:({selected:r})=>a("button",{className:`${r?"!border-white-light !border-b-white text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black":""} dark:hover:border-b-black -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,onClick:()=>pt("credit"),children:""})}):a(_e,{className:"pointer-events-none -mb-[1px] block p-3.5 py-2 text-white-light outline-none dark:text-dark",children:""})),c&&f&&a(_e,{as:R.Fragment,children:({selected:r})=>a("button",{className:`${r?"!border-white-light !border-b-white text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black":""} dark:hover:border-b-black -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,onClick:()=>pt("note-event"),children:""})}),!I&&(_>=3?a(_e,{as:R.Fragment,children:({selected:r})=>a("button",{className:`${r?"!border-white-light !border-b-white text-themePrimary !outline-none dark:!border-[#191e3a] dark:!border-b-black":""} dark:hover:border-b-black -mb-[1px] block border border-transparent p-3.5 py-2 hover:text-themePrimary`,onClick:()=>pt("device-lock"),children:""})}):a(_e,{className:"pointer-events-none -mb-[1px] block p-3.5 py-2 text-white-light outline-none dark:text-dark",children:""}))]}),h(_e.Panels,{children:[h(_e.Panel,{children:[a(kt,{initialValues:E,onSubmit:zl,enableReinitialize:!0,autoComplete:"off",validationSchema:ac,children:r=>{var u,T,g,G,re,$,Oe,be,ae,Pe,Le,De,je;return R.useEffect(()=>{const x={commission_type:r.values.commission_type,commission:r.values.commission,principle:r.values.principle,price:r.values.price},ne=Pr(x);r.setFieldValue("commission_price",ne)},[r.values.commission]),R.useEffect(()=>{var se,ue;if(r.values.down_payment_type==="percent"){const $e=r.values.price*((se=r.values)==null?void 0:se.down_payment_rate),Xt=r.values.price-Ss($e);r.setFieldValue("down_payment",Ss($e)),r.setFieldValue("principle",Xt)}else{const $e=r.values.price-((ue=r.values)==null?void 0:ue.down_payment);r.setFieldValue("principle",$e)}const x={commission_type:r.values.commission_type,commission:r.values.commission,principle:r.values.principle,price:r.values.price},ne=Pr(x);r.setFieldValue("commission_price",ne)},[r.values.price,r.values.down_payment,r.values.down_payment_rate,r.setFieldValue]),R.useEffect(()=>{if(r.values.principle&&r.values.rate_per_month&&r.values.ins_period){const x=r.values.principle*r.values.rate_per_month/r.values.ins_period;r.setFieldValue("ins_amount",Ss(x))}else r.setFieldValue("ins_amount",0)},[r.values.principle,r.values.rate_per_month,r.values.ins_period,r.values.ins_amount,r.setFieldValue]),h(Ve,{children:[_>5&&a("div",{className:"w-full h-[auto] bg-[#fedee2] text-[#f9303e] rounded-md mt-5 mb-5",children:h("div",{className:"p-5",children:[" !","  "+((u=D==null?void 0:D.find(x=>x.data.id===_))==null?void 0:u.data.name)," ",": ",E.reason_cancel]})}),ds!="none"&&!wr&&a("div",{className:"w-full h-[auto] text-warning bg-warning-light dark:bg-warning-dark-light rounded-md mt-5 mb-5",children:h("div",{className:"p-5",onClick:()=>Or(Cr),style:{cursor:"pointer"},children:[ds=="on_process"?"":""," : ",(E==null?void 0:E.refinance_ref)??""]})}),ds!="none"&&wr&&a("div",{className:"w-full h-[auto] text-warning bg-warning-light dark:bg-warning-dark-light rounded-md mt-5 mb-5",children:h("div",{className:"p-5",onClick:()=>Or(Cr),style:{cursor:"pointer"},children:["  : ",(E==null?void 0:E.refinance_ref)??""]})}),(r.values.contract_type_id==5||r.values.contract_type_id==6)&&!c&&h("div",{className:"relative border border-white-dark/20 flex flex w-[300px] float-right",children:[a("input",{type:"text",name:"refinance_ref",placeholder:"",value:r.values.refinance_ref,onChange:r.handleChange,onBlur:r.handleBlur,disabled:!!(Ar||c),className:"form-input border-0 border-l rounded-none bg-white  focus:shadow-[0_0_5px_2px_rgb(194_213_255_/_62%)] dark:shadow-[#1b2e4b] placeholder:tracking-wider focus:outline-none py-3"}),a("button",{className:"text-primary m-auto p-3 flex items-center justify-center",onClick:()=>{var x;if(!Ar&&!c){if(f&&((x=r.values)==null?void 0:x.id_shop)=="")return d.fire({icon:"error",title:"",padding:"10px 20px"}),!1;r.values.refinance_ref&&(zo(r.values),Es({data:{query:r.values.refinance_ref,full:!1}}))}},children:h("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mx-auto w-5 h-5",children:[a("circle",{cx:"11.5",cy:"11.5",r:"9.5",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),a("path",{d:"M18.5 18.5L22 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})]}),c&&(_===3||_===4||_===5)&&h("div",{className:"inline-flex float-right",children:[a("button",{className:"btn btn-primary ltr:rounded-r-none rtl:rounded-l-none",children:""}),a("div",{className:"dropdown",children:a(Sc,{placement:`${n?"bottom-start":"bottom-end"}`,btnClassName:"btn dropdown-toggle btn-primary ltr:rounded-l-none rtl:rounded-r-none border-l-[#4468fd] before:border-[5px] before:border-l-transparent before:border-r-transparent before:border-t-inherit before:border-b-0 before:inline-block before:border-t-white-light h-full",button:a("span",{className:"sr-only",children:"Toggle dropdown"}),children:h("ul",{className:"!min-w-[250px]",children:[a("li",{children:a("button",{type:"button",onClick:()=>{me(!0),ut||al({data:{id:c}})},children:""})}),a("li",{children:a("button",{type:"button",onClick:()=>{me(!0),ut||ll({data:{id:c}})},children:" PDPA"})}),a("li",{children:a("button",{type:"button",onClick:()=>{me(!0),ut||ol({data:{id:c}})},children:""})}),((T=pe.features)==null?void 0:T.signature_online)&&((g=E==null?void 0:E.business_unit)==null?void 0:g.signature_online_type)==1&&![2,3,4,11,16,17,18,19,34,39].includes((G=E==null?void 0:E.credit)==null?void 0:G.id)&&a("li",{children:a("button",{type:"button",onClick:()=>{const ne=E.contract_type_id==5||E.contract_type_id==6?`/apps/contract/signature-preview/${c}?type=refinance`:`/apps/contract/signature-preview/${c}`;window.open(ne,"_blank","noopener,noreferrer")},children:""})}),pe.features.pdf_receipts&&_>=3&&a("li",{children:a("button",{type:"button",onClick:()=>{me(!0),ut||cl({})},children:""})}),pe.features.pdf_pay&&on!="shop"&&_===5&&a("li",{children:a("button",{type:"button",onClick:()=>{dl({data:{only_content:!0}})},children:""})}),pe.features.pdf_close&&on!="shop"&&_===5&&a("li",{children:a("button",{type:"button",onClick:()=>{me(!0),ut||hl({})},children:""})}),pe.features.pdf_return&&on!="shop"&&_===5&&a("li",{children:a("button",{type:"button",onClick:()=>{me(!0),ut||gl()},children:""})})]})})})]}),(E==null?void 0:E.customer_signature_at)&&a("div",{className:"inline-flex float-right",style:{marginRight:10},children:a("span",{style:{marginTop:0,padding:10},className:`badge ${E!=null&&E.customer_signature_at?"badge-outline-success":"badge-outline-danger"}`,children:E!=null&&E.customer_signature_at?"":""})}),(E==null?void 0:E.e_contract_status)&&a("div",{className:"inline-flex float-right",style:{marginRight:10},children:a("span",{style:{marginTop:0,padding:10},className:`badge ${E!=null&&E.e_contract_status?"badge-outline-success":"badge-outline-danger"}`,children:E!=null&&E.e_contract_status?" Ekyc ":""})}),h(Ut,{className:"space-y-5 dark:text-white custom-select mt-5",children:[a("div",{className:"text-4xl pt-4 font-semibold text-center text-themePrimary",children:""}),h("div",{className:"flex flex-row w-full gap-5",children:[a(Me,{label:"",id:"contract_type_id",name:"contract_type_id",placeholder:"",options:k,disabled:_>2&&f||_>1&&y==="shop"}),a(Me,{label:"",id:"insurance_type_id",name:"insurance_type_id",placeholder:"",options:te,disabled:_>2&&f||_>1&&y==="shop"})]}),h("div",{className:"flex flex-row w-full gap-5",children:[a(le,{label:"",name:"reference",disabled:!0}),a(ei,{label:"",name:"contract_date",disabled:_>2&&f||_>1&&y==="shop",onChange:x=>{r.setFieldValue("contract_date",Bt(x)+"T00:00:00.000Z")}})]}),h("div",{className:"!mt-8 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex",children:a("span",{className:"bg-white dark:bg-black dark:text-white-light inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-base font-semibold -mt-[10px] ",children:""})}),a("div",{className:"flex flex-row p-5",children:h("div",{className:"flex-auto w-[50%]",children:[a(Me,{label:"",id:"id_shop",name:"id_shop",placeholder:"",isSearchable:!0,options:Y,onChange:x=>Dt(r,x,"id_shop"),onInputChange:x=>vs(r,x,"id_shop"),disabled:I||_>1,handleOnMenuOpen:()=>{var x;gs({data:{query:"",contract_type_id:((x=r.values)==null?void 0:x.contract_type_id)??0,page:1,pageSize:10}})}}),a("div",{className:"mt-3 grid grid-cols-10 justify-items-start content-center ",children:!rt.isEmpty(w)&&h(Ve,{children:[a("div",{className:"col-span-12 grid gap-1 pb-2",children:a("div",{className:"flex flex-row pointer",onClick:()=>ic(w),children:h("p",{className:"text-2xl text-primary hover:underline",children:[" ",w.name]})})}),a("div",{className:"col-span-6 grid gap-2 pb-2",children:h("div",{className:"flex flex-row",children:[a(ri,{className:"mr-2"}),h("p",{children:[" ",ci((w==null?void 0:w.tax_id)||"-")]})]})}),a("div",{className:"col-span-6 grid gap-2 pb-2",children:h("div",{className:"flex flex-row",children:[a(si,{className:"mr-2"}),h("p",{children:[" ",w.email||"-"]})]})}),a("div",{className:"col-span-12 grid gap-2 pb-2",children:h("div",{className:"flex flex-row",children:[a(vn,{className:"mr-2"}),h("p",{children:[" ",Rn(w.phone_number||"-")]})]})}),a("div",{className:"col-span-12 grid gap-2 pb-2",children:h("div",{className:"flex flex-row",children:[a(en,{className:"mr-2"}),h("p",{children:[" ",(w==null?void 0:w.full_address)||"-"]})]})}),w.facebook_id!=null&&w.facebook_id!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(ai,{className:"mr-2"}),(w==null?void 0:w.facebook_id)!==null&&a("a",{href:w==null?void 0:w.facebook_id,target:"_blank",rel:"noopener noreferrer",className:"flex-1 underline-offset-1 text-primary",children:w.facebook_id.slice(0,50)})]})}),w.line_id!=null&&w.line_id!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(ii,{className:"mr-2"}),(w==null?void 0:w.line_id)!==null&&a("a",{href:`https://line.me/ti/p/${w==null?void 0:w.line_id.trim().replaceAll("@","%40")}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 underline-offset-1 text-primary",children:w==null?void 0:w.line_id})]})}),w.website!=null&&w.website!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(Bc,{className:"mr-2"}),(w==null?void 0:w.website)!==null&&a("a",{href:w==null?void 0:w.website,target:"_blank",rel:"noopener noreferrer",className:"flex-1 underline-offset-1 text-primary",children:w.website.slice(0,50)})]})})]})})]})})]}),h("div",{className:"!mt-8 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex",children:a("span",{className:`bg-white dark:bg-black dark:text-white-light
                                                          inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-base font-semibold -mt-[10px] `,children:""})}),h("div",{className:"flex flex-col p-5",children:[a("div",{className:"w-full h-[auto] bg-[#fedee2] text-[#f9303e] rounded-md",children:Et&&!Ge&&a("div",{className:"p-5",children:" !   "})}),a("div",{className:"flex-auto flex-row w-full pt-2",children:a(Me,{label:"",id:"id_business_unit",name:"id_business_unit",placeholder:"",options:Ee,onChange:x=>Dt(r,x,"id_business_unit"),disabled:rt.isEmpty(w)||_>2&&f||_>1&&y==="shop",filterOption:()=>!0,handleOnMenuOpen:()=>{}})}),!rt.isEmpty(C)&&h("div",{className:"flex flex-row flex-wrap mt-6",children:[a("div",{className:"flex w-[100%] lg:w-[30%] justify-center lg:justify-start content-start",children:C!=null&&C.logo_image_url&&(C==null?void 0:C.logo_image_url)!==""?a("img",{className:"h-[100px] w-auto",src:C==null?void 0:C.logo_image_url,alt:"bu-logo"}):null}),a("div",{className:"flex w-[100%] lg:w-[70%] lg:pl-5",children:h("div",{className:"mt-3 justify-items-start content-center",children:[a("div",{className:"col-span-12 grid gap-1 pb-2",children:a("div",{className:"flex flex-row pointer",onClick:()=>rc(C),children:h("p",{className:"text-lg hover:underline",children:[" ",C==null?void 0:C.name," "]})})}),h("div",{className:"col-span-12 grid gap-1",children:[h("div",{className:"flex flex-row",children:[a(vn,{className:"mr-2"}),h("p",{children:[" ",Rn((C==null?void 0:C.phone)||"-")]})]}),h("div",{className:"flex flex-row",children:[a(en,{className:"mr-2"}),h("p",{children:[" ",C==null?void 0:C.full_address," "]})]})]})]})})]})]})]}),h("div",{className:"!mt-8 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex",children:a("span",{className:`bg-white dark:bg-black dark:text-white-light
                                                          inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-base font-semibold -mt-[10px] `,children:""})}),h("div",{className:"flex flex-col p-5",children:[a("div",{className:"w-full h-[auto] bg-[#fedee2] text-[#f9303e] rounded-md",children:Et&&!Ge&&a("div",{className:"p-5",children:" !   "})}),a("div",{className:"flex-auto flex-row w-full pt-2",children:a(Me,{label:"",id:"id_shop_group",name:"id_shop_group",placeholder:"",options:Z,onChange:x=>Dt(r,x,"id_shop_group"),disabled:rt.isEmpty(w)||_>2&&f||_>1&&y==="shop",filterOption:()=>!0,handleOnMenuOpen:()=>{}})})]})]}),h("div",{className:"!mt-8 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex",children:a("span",{className:"bg-white dark:bg-black dark:text-white-light inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-base font-semibold -mt-[10px] ",children:""})}),h("div",{className:"flex flex-col p-5",children:[h("div",{className:"flex flex-row w-full",children:[a("div",{className:"flex-auto w-[95%]",children:a(Me,{label:"",id:"id_customer",name:"id_customer",placeholder:"",isSearchable:!0,options:F,onChange:x=>Dt(r,x,"id_customer"),onInputChange:x=>vs(r,x,"id_customer"),disabled:rt.isEmpty(w)||_>2&&f||_>1&&y==="shop",filterOption:()=>!0,zIndex:"z-2",handleOnMenuOpen:()=>{En({data:{query:"",id_shop:w.id,page:1,pageSize:10}})}})}),_<5&&a("div",{className:"flex flex-auto w-[5%] mx-2 pt-6",children:a("button",{type:"button",className:"btn btn-primary",onClick:nc,children:a(oi,{})})})]}),!rt.isEmpty(S)&&h("div",{className:"flex flex-row flex-wrap mt-6",children:[a("div",{className:"flex-auto w-[100%]  lg:w-[30%]",children:a(ws,{items:[{image_url:S==null?void 0:S.citizen_image_url},{image_url:S==null?void 0:S.verification_image_url}]})}),a("div",{className:"flex-auto w-[100%] lg:w-[70%] lg:pl-5",children:h("div",{className:"mt-3 grid grid-cols-10 justify-items-start content-center",children:[a("div",{className:"col-span-12 grid gap-1 pb-2",children:a("div",{className:"flex flex-row",children:a("p",{className:"text-lg",children:a("a",{href:`/apps/customer/edit/${S==null?void 0:S.id}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 content-center underline-offset-1 text-primary ",children:S==null?void 0:S.name},"id_customer")})})}),a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(ri,{className:"mr-2"}),h("p",{children:[" ",ci((S==null?void 0:S.citizen_id)??"-")]})]})}),a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(si,{className:"mr-2"}),h("p",{children:[" ",(S==null?void 0:S.email)??"-"]})]})}),S.phone_number!=null&&S.phone_number!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(vn,{className:"mr-2"}),h("p",{children:[" ",Rn((S==null?void 0:S.phone_number)||"-")]})]})}),S.phone_number_ref!=null&&S.phone_number_ref!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(vn,{className:"mr-2"}),h("p",{children:[" ",Rn((S==null?void 0:S.phone_number_ref)??"-")]})]})}),S.full_address!=null&&S.full_address!=""&&a("div",{className:"col-span-12 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(en,{className:"mr-2"}),h("p",{children:[" : ",(S==null?void 0:S.full_address)??"-"]})]})}),S.full_current_address!=null&&S.full_current_address!=""&&a("div",{className:"col-span-12 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(en,{className:"mr-2"}),h("p",{children:[" : ",(S==null?void 0:S.full_current_address)??"-"]})]})}),S.full_work_address!=null&&S.full_work_address!=""&&a("div",{className:"col-span-12 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(en,{className:"mr-2"}),h("p",{children:[" : ",(S==null?void 0:S.full_work_address)??"-"]})]})}),S.facebook_id!=null&&S.facebook_id!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(ai,{className:"mr-2"}),(S==null?void 0:S.facebook_id)!==null&&a("a",{href:S==null?void 0:S.facebook_id,target:"_blank",rel:"noopener noreferrer",className:"flex-1 underline-offset-1 text-primary",children:S.facebook_id.slice(0,50)})]})}),S.line_id!=null&&S.line_id!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(ii,{className:"mr-2"}),(S==null?void 0:S.line_id)!==null&&a("a",{href:`https://line.me/ti/p/${S==null?void 0:S.line_id.trim().replaceAll("@","%40")}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 underline-offset-1 text-primary",children:S==null?void 0:S.line_id})]})}),S.instagram_id!=null&&S.instagram_id!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(Fc,{className:"mr-2"}),(S==null?void 0:S.instagram_id)!==null&&a("a",{href:`https://www.instagram.com/${S==null?void 0:S.instagram_id.trim()}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 underline-offset-1 text-primary",children:S==null?void 0:S.instagram_id})]})}),S.tiktok_id!=null&&S.tiktok_id!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(Xc,{className:"mr-2"}),(S==null?void 0:S.tiktok_id)!==null&&a("a",{href:`https://www.tiktok.com/${S==null?void 0:S.tiktok_id.trim()}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 underline-offset-1 text-primary",children:S==null?void 0:S.tiktok_id})]})}),S.credit_level!=null&&S.credit_level!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(li,{className:"mr-2"}),h("p",{children:[" ",a("span",{className:"pr-3",children:" (BU)"}),"  ",((re=l.find(x=>x.value===S.credit_level))==null?void 0:re.label)||""]})]})}),S.shop_credit_level!=null&&S.shop_credit_level!=""&&a("div",{className:"col-span-6 grid gap-1 pb-2",children:h("div",{className:"flex flex-row",children:[a(li,{className:"mr-2"}),h("p",{children:[" ",a("span",{className:"pr-3",children:" ()"}),"  ",(($=l.find(x=>x.value===S.shop_credit_level))==null?void 0:$.label)||""]})]})}),h("div",{className:"col-span-7 grid gap-1",children:["  ",h("div",{className:"flex flex-row",children:[a(Jr,{className:"shrink-0 mr-2"}),"  ",E==null?void 0:E.contract_process_text,"   "]})," "]})]})})]})]})]}),h("div",{className:"!mt-8 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex",children:a("span",{className:"bg-white dark:bg-black dark:text-white-light inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-base font-semibold -mt-[10px] ",children:""})}),h("div",{className:"flex flex-col p-5",children:[h("div",{className:"flex flex-row w-full items-center",children:[a("div",{className:"flex-auto w-[95%]",children:a(Me,{label:"",id:"id_asset",name:"id_asset",placeholder:"",isSearchable:!0,options:Ot,onChange:x=>Dt(r,x,"id_asset"),onInputChange:x=>vs(r,x,"id_asset"),disabled:rt.isEmpty(w)||_>2&&f||_>1&&y==="shop",filterOption:()=>!0,zIndex:"z-2",handleOnMenuOpen:()=>{bn({data:{query:"",id_shop:w.id,page:1,pageSize:10}})}})}),_<5&&a("div",{className:"flex flex-auto w-[5%] mx-2 pt-6",children:a("button",{type:"button",className:"btn btn-primary",onClick:sc,children:a(oi,{})})})]}),!rt.isEmpty(q)&&h("div",{className:"flex flex-row flex-wrap mt-6",children:[a("div",{className:"flex-auto w-[100%] lg:w-[30%]",children:a("div",{className:"",children:a(ws,{items:q==null?void 0:q.asset_images})})}),a("div",{className:"flex-auto w-[100%] lg:w-[70%] lg:pl-5",children:h("div",{className:"mt-3 grid grid-cols-10 justify-items-start content-center",children:[a("div",{className:"col-span-12 grid gap-1 pb-4",children:a("p",{className:"text-lg",children:a("a",{href:`/apps/asset/view/${q==null?void 0:q.id}/${w==null?void 0:w.id}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 content-center underline-offset-1 text-primary",children:(q==null?void 0:q.name)||"-"},"id_customer")})}),h("div",{className:"col-span-2 grid gap-1",children:[a("p",{className:"line-break-anywhere",children:"Serial No"}),a("p",{className:"line-break-anywhere",children:""}),a("p",{className:"line-break-anywhere",children:""}),a("p",{className:"line-break-anywhere",children:""})]}),h("div",{className:"col-span-3 grid gap-1",children:[h("p",{className:"line-break-anywhere",children:[" ",(q==null?void 0:q.serial_number)||"-"," "]}),h("p",{className:"line-break-anywhere",children:[" ",(q==null?void 0:q.model_number)||"-"," "]}),h("p",{className:"line-break-anywhere",children:[" ",(q==null?void 0:q.color)||"-"]}),h("p",{className:"line-break-anywhere",children:[" ",(q==null?void 0:q.note)||"-"," "]})]}),h("div",{className:"col-span-2 grid gap-1",children:[a("p",{className:"line-break-anywhere",children:"IMEI"}),a("p",{className:"line-break-anywhere",children:""}),a("p",{className:"line-break-anywhere",children:""}),a("p",{className:"line-break-anywhere"})]}),h("div",{className:"col-span-3 grid gap-1",children:[h("p",{className:"line-break-anywhere",children:[" ",(q==null?void 0:q.imei)||"-"]}),h("p",{className:"line-break-anywhere",children:[" ",(q==null?void 0:q.capacity)||"-"]}),h("p",{className:"line-break-anywhere",children:[" ",q!=null&&q.price?((Oe=q==null?void 0:q.price)==null?void 0:Oe.toLocaleString("en-US"))+" ":"-"," "]}),a("p",{className:"line-break-anywhere"})]})]})})]})]})]}),Ge&&h("div",{className:"!mt-8 border border-white-light dark:border-[#1b2e4b] group rounded-md",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex",children:a("span",{className:"bg-white dark:bg-black dark:text-white-light inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-base font-semibold -mt-[10px] ",children:""})}),h("div",{className:"flex flex-wrap flex-row px-5 pb-5",children:[h("div",{className:"w-full lg:w-6/12 2xl:w-7/12",children:[h("div",{className:"flex-1",children:[a("div",{className:"input-flex-row",children:a(le,{label:"",name:"price",disabled:y==="shop"&&_>1||f&&_>2})}),a("div",{className:"input-flex-row gap-5",children:h(Ve,{children:[a(Me,{label:"",id:"down_payment_type",name:"down_payment_type",options:[{label:"",value:"amount"},{label:"",value:"percent"}],disabled:_>2||!f}),r.values.down_payment_type==="percent"&&a(Me,{label:"",id:"down_payment_rate",name:"down_payment_rate",options:xc,isSearchable:!0,disabled:_>2||!f&&_>1})]})})]}),h("div",{className:"flex-1",children:[h("div",{className:"input-flex-row gap-5",children:[a(le,{label:"",name:"down_payment",disabled:y==="shop"&&_>1||f&&_>2||r.values.down_payment_type==="percent"||!f}),a(Me,{label:"",id:"ins_period",name:"ins_period",options:Oc,disabled:y==="shop"&&_>1||f&&_>2,onChange:x=>{Dt(r,x,"ins_period")}})]}),h("div",{className:"input-flex-row gap-5",children:[a(ei,{label:"",name:"ins_due_at",disabled:y==="shop"&&_>1||f&&[3,4,6,7,8].includes(_),onChange:x=>{r.setFieldValue("ins_due_at",Bt(x)+"T00:00:00.000Z")}}),a(Me,{label:"",id:"ins_pay_day",name:"ins_pay_day",options:Pc,disabled:y==="shop"&&_>1||f&&[3,4,6,7,8].includes(_)})]}),a("div",{children:a(Lc,{name:"has_advance_installments",label:"",disabled:y==="shop"&&_>1||f&&_>2})}),a("div",{className:"input-flex-row",children:f&&a(le,{label:"",name:"rate_per_month",type:"number",disabled:r.values.rate_per_month===null||_>2})})]})]}),h("div",{className:"w-full lg:w-6/12 2xl:w-5/12 lg:pl-5",children:[a("div",{className:"input-flex-row",children:h("div",{className:"flex flex-col flex-1 ",children:[a("label",{children:"  "}),a("div",{className:"flex-auto bg-[#eeeeee] h-[50%] w-[100%] text-center align-center leading-normal w-3/4 rounded-md mb-1 py-2",children:r.values.principle.toLocaleString("en-US")})]})}),a("div",{className:"input-flex-row",children:h("div",{className:"flex flex-col flex-1",children:[a("label",{children:"  "}),a("div",{className:"flex-auto bg-[#eeeeee] h-[50%] w-[100%] text-center align-center leading-normal w-3/4 rounded-md mb-1 py-2",children:(r.values.ins_amount*r.values.ins_period+parseInt(r.values.down_payment)).toLocaleString("en-US")})]})}),a("div",{className:"input-flex-row",children:h("div",{className:"flex flex-col flex-1",children:[a("label",{children:"  "}),a("div",{className:"flex-auto bg-[#eeeeee] h-[100%] w-[100%] text-3xl lg:text-7xl 2xl:text-9xl text-center align-center leading-normal w-3/4 rounded-md py-5 lg:py-9",style:{fontSize:"10rem"},children:(be=r.values.ins_amount)==null?void 0:be.toLocaleString("en-US")})]})})]})]})]}),f&&h("div",{className:"!mt-6 border border-white-light dark:border-[#1b2e4b] group rounded-md pt-5 z-[-1]",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex justify-center",children:a("span",{className:"bg-white dark:bg-black dark:text-white-light inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-lg font-semibold -mt-[10px] ",children:""})}),h("div",{className:"p-5",children:[h("div",{children:[a("div",{className:"text-l font-semibold ltr:sm:text-left rtl:sm:text-right text-center pt-2 pb-2",children:""}),((ae=pe.features)==null?void 0:ae.contract_issuer)&&a(le,{label:"",name:"contract_issuer",disabled:_>5||de}),h("div",{className:"input-flex-row",children:[a(le,{label:"Commission  (%)",name:"commission",type:"number",disabled:_>5||de}),a(le,{label:" ()",name:"benefit",type:"number",disabled:_>5||de})]}),((Pe=pe.features)==null?void 0:Pe.commission_type)&&h("div",{className:"input-flex-row",children:[a(Me,{label:"Commission type",id:"commission_type",name:"commission_type",options:[{value:1,label:" 1"},{value:2,label:" 2"}],disabled:!0}),a(le,{label:"Commission Price",name:"commission_price",type:"number",disabled:!0})]})]}),h("div",{className:"pt-8",children:[a("div",{className:"text-l font-semibold ltr:sm:text-left rtl:sm:text-right text-center pb-2",children:""}),h("div",{className:"input-flex-row",children:[a(le,{label:" ()",name:"penalty_fee",type:"number",disabled:_>5||de}),a(le,{label:" (/)",name:"penalty_fee_limit",type:"number",disabled:_>5||de})]})]}),a("div",{children:h("div",{className:"input-flex-row",children:[a(le,{label:" ()",name:"fee",type:"number",disabled:_>5||de}),a(le,{label:" ()",name:"unlock_fee",type:"number",disabled:_>5||de})]})}),a("div",{children:h("div",{className:"input-flex-row",children:[a(le,{label:"  ()",name:"tracking_fee",type:"number",disabled:_>5||de}),a(le,{label:" ()",name:"preliminary_credit_assessment",type:"number",disabled:_>5||de})]})}),a("div",{className:"pt-5",children:a(le,{label:"",name:"condition_contract",as:"textarea",rows:"10",className:"form-textarea ltr:rounded-l-none rtl:rounded-r-none resize-none","default-value":"-",disabled:_>5||de})}),a("div",{className:"mt-6 z-[-1]",children:a(le,{label:"",name:"memo",as:"textarea",rows:"5",className:"form-textarea ltr:rounded-l-none rtl:rounded-r-none resize-none","default-value":"-",disabled:_>5||de})}),_===5&&h("div",{className:"text-themePrimary mt-5",children:[": ",Jt(r.values.approved_time)," .  : ",r.values.approved_by]})]})]}),a("div",{ref:e,style:{height:"0px"}}),a(Ve,{children:a("footer",{className:"main-content",style:{position:"fixed",left:0,bottom:0,width:"100%",height:"80px",textAlign:"center",backgroundColor:"white",zIndex:0},children:a("div",{className:"flex flex-row gap-5",children:h("div",{className:"flex-0 flex flex-row w-full gap-4 pr-[130px] justify-start px-5",children:[_<=1&&Ge&&!de&&a("button",{type:"submit",className:"btn btn-primary !mt-6 w-full border-0 bg-[#eeeeee] text-black max-w-[200px]",children:""}),_===1&&v&&Ge&&!de&&a("button",{type:"button",className:"btn-primary btn !mt-6 w-full border-0 text-white max-w-[200px]",onClick:()=>{Kl(r)},children:""}),f&&h(Ve,{children:[_===5&&["11","12","13","14","15","16","17","18","19"].includes((Le=E==null?void 0:E.credit)==null?void 0:Le.code)&&!E.is_completed&&a("button",{type:"button",onClick:()=>{ce.fire({title:"",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",cancelButtonText:"",confirmButtonText:"",reverseButtons:!0,html:`<label for="password" style="display: block text-align: left font-size: 1rem margin-top: 10px color: #000000">:</label>
                                                <input id="password" type="password" type="text" class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000" placeholder=" ">`,preConfirm:()=>{const x=document==null?void 0:document.getElementById("password");return x!=null&&x.value?x==null?void 0:x.value:(ce.showValidationMessage(""),!1)}}).then(x=>{if(x.isConfirmed){const ne={id_contract:E.uuid};Cl({data:ne})}})},className:"btn bg-green-500 text-white !mt-6 w-full border-0 uppercase shadow-[0_10px_20px_-10px_rgba(67,97,238,0.44)] max-w-[200px]",children:""}),_>1&&_<=5&&!de&&a("button",{type:"submit",className:"btn !mt-6 w-full border-0 btn-primary max-w-[200px]",children:""}),_>1&&_<5&&!de&&a("button",{type:"button",className:"btn bg-[#c80224] text-white !mt-6 w-full border-0 uppercase shadow-[0_10px_20px_-10px_rgba(67,97,238,0.44)] max-w-[250px]",onClick:()=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0,html:`<label for="reason_cancel" style="display: block text-align: left margin-bottom: 10px font-size: 1rem font-size: 1rem margin-top: 10px color: #000000">:</label>
                                                  <input id="reason_cancel" type="text" class="swal2-input" style="margin: 0 !important width: 100% color: #000000" placeholder="">
                                                  <label for="password" style="display: block text-align: left font-size: 1rem margin-top: 10px color: #000000 color: #000000">:</label>
                                                  <input id="password" type="password" type="text" class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000" placeholder=" ">`,preConfirm:()=>{var se,ue;const x=(se=document==null?void 0:document.getElementById("reason_cancel"))==null?void 0:se.value,ne=((ue=document==null?void 0:document.getElementById("password"))==null?void 0:ue.value)??"";return!x||!ne?(ce.showValidationMessage(""),!1):{reason_cancel:x,password:ne}}}).then(x=>{if(x.isConfirmed){const ne=_===2?6:7,{reason_cancel:se,password:ue}=x.value;jr(se,ue,ne)}})},children:_===2?"":""}),_<5&&_!==1&&_!==0&&!de&&a("button",{type:"button",className:"btn !mt-6 w-full border-0 btn-dark max-w-[200px]",onClick:()=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0}).then(x=>{x.isConfirmed&&Hr(r,1)})},children:""}),(_===2||_===4)&&!de&&a(Ve,{children:a("button",{type:"button",className:"btn bg-[#0516af] text-white !mt-6 w-full border-0 uppercase shadow-[0_10px_20px_-10px_rgba(67,97,238,0.44)] max-w-[200px]",onClick:()=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0}).then(x=>{x.isConfirmed&&(_===2?Xl(r):Hr(r,5))})},children:_===2?"":""})}),_===5&&!de&&a("button",{type:"button",className:"btn bg-[#ff0000] text-white !mt-6 w-full border-0 uppercase shadow-[0_10px_20px_-10px_rgba(67,97,238,0.44)] max-w-[200px]",onClick:()=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0,html:`<label for="reason_cancel" style="display: block text-align: left margin-bottom: 10px font-size: 1rem margin-top: 10px color: #000000">:</label>
                                                <input id="reason_cancel" type="text" class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000" placeholder="">
                                                <label for="password" style="display: block text-align: left font-size: 1rem margin-top: 10px color: #000000">:</label>
                                                <input id="password" type="password" type="text" class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000" placeholder=" ">`,preConfirm:()=>{var se,ue;const x=(se=document==null?void 0:document.getElementById("reason_cancel"))==null?void 0:se.value,ne=(ue=document==null?void 0:document.getElementById("password"))==null?void 0:ue.value;return!x||!ne?(ce.showValidationMessage(""),!1):{reason_cancel:x,password:ne}}}).then(x=>{if(x.isConfirmed){const{reason_cancel:ne,password:se}=x.value;jr(ne,se,8)}})},children:""}),_===5&&!de&&((je=(De=pe)==null?void 0:De.features)==null?void 0:je.contract_appr_restart)&&a("button",{type:"button",className:"btn bg-[#b3b3b3] text-white !mt-6 w-full border-0 uppercase shadow-[0_10px_20px_-10px_rgba(67,97,238,0.44)] max-w-[200px]",onClick:()=>{ce.fire({title:"",text:"?",icon:"warning",showCancelButton:!0,confirmButtonColor:pe.color.themePrimary,cancelButtonColor:"#d33",confirmButtonText:"",cancelButtonText:"",reverseButtons:!0,html:`<label for="reason" style="display: block text-align: left margin-bottom: 10px font-size: 1rem margin-top: 10px color: #000000">:</label>
                                                <input id="reason" type="text" class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000" placeholder="">
                                                <label for="password" style="display: block text-align: left font-size: 1rem margin-top: 10px color: #000000">:</label>
                                                <input id="password" type="password" type="text" class="swal2-input" style="margin: 0 !important width: 100% font-size: 1rem color: #000000" placeholder=" ">`,preConfirm:()=>{var se,ue;const x=(se=document==null?void 0:document.getElementById("reason"))==null?void 0:se.value,ne=(ue=document==null?void 0:document.getElementById("password"))==null?void 0:ue.value;return!x||!ne?(ce.showValidationMessage(""),!1):{reason:x,password:ne}}}).then(x=>{if(x.isConfirmed){const{reason:ne,password:se}=x.value;Ul({data:{id_contract:c,password:se,reason:ne}})}})},children:""})]})]})})})})]})]})}}),o?a(cm,{id_contract:o}):a(Ve,{children:" "})]}),a(_e.Panel,{children:a("div",{className:"p-6",children:_>=3?h(Ve,{children:[a("div",{className:"text-lg font-semibold text-center",children:` ${E.reference}`}),a("div",{className:"w-full h-[auto] bg-[#ffddab] text-[#f3831e] rounded-md mt-3",children:a("div",{className:"p-5",children:"!   "})}),a("div",{className:"mt-6",children:ec()}),_===3&&a("button",{type:"button",className:"btn !mt-6 w-full border-0 btn-primary",onClick:()=>{qr()},children:""}),a("hr",{className:"border-white-light dark:border-[#1b2e4b] my-10 w-full"}),a(kt,{initialValues:E,onSubmit:()=>{},enableReinitialize:!0,children:r=>{var u;return a(Ut,{children:pe.features.e_sign_status&&((u=E==null?void 0:E.business_unit)==null?void 0:u.signature_online_type)==2&&c&&(_===3||_===4||_===5)&&h("div",{className:"!mt-6 border border-white-light dark:border-[#1b2e4b] group rounded-md pt-5 z-[-1]",children:[a("div",{className:"border-b border-white-light dark:border-[#1b2e4b] p-5 pt-0 flex justify-center",children:a("span",{className:"bg-white dark:bg-black dark:text-white-light inline-block px-3 h-[20px] lg:h-[20px] rounded flex justify-center items-center text-lg font-semibold -mt-[10px] ",children:" KYC"})}),h("div",{className:"p-5",children:[fs.status&&a("div",{className:"flex justify-end gap-2",children:a("button",{onClick:()=>uc({data:{uuid:i,e_contract_status:!0}}),type:"button",className:"btn bg-orange-500 text-white shadow-lg hover:shadow-none max-w-40",children:" KYC"})}),r.values.e_contract_status&&h("div",{className:"flex justify-end gap-2",children:[r.values.status_id!=5&&a("button",{type:"button",onClick:()=>$t(!0),className:"btn bg-red-600 text-white shadow-lg hover:shadow-none max-w-40",children:" e-sign"}),a("button",{type:"button",onClick:()=>{fc()},className:"btn btn-primary max-w-40",children:" e-sign"})]}),a("div",{className:"flex flex-col gap-2",children:a(Nm,{onGenerate:async()=>{await cc({data:{uuid:E.uuid}})},loading:dc,showStatus:r.values.e_contract_status,label:"",name:"e_contract_link",className:"form-textarea ltr:rounded-l-none rtl:rounded-r-none resize-none",disabled:!0,copy:!0})})]})]})})}})]}):null})}),a(_e.Panel,{children:h("div",{className:"pt-5",children:[h("div",{className:"text-lg font-semibold text-center",children:[" ",E==null?void 0:E.reference]}),a("div",{className:"mb-5",children:a("div",{className:"xl:max-w-[900px] lg:max-w-[600px] md:max-w-[550px] sm:max-w-[400px] mx-auto",children:(()=>{const r=u=>{const g=`
                                  <table class="w-full text-sm">
                                      <thead>
                                      <tr>
                                          <th style="width:10%"></th>
                                          <th style="width:40%"></th>
                                          <th style="width:40%"></th>
                                      </tr>
                                      </thead>
                                      <tbody>
                                      ${u.map(G=>`
                                  <tr>
                                  <td class="text-black">${G.field_name}</td>
                                  <td class="text-black" style="white-space: pre-line word-wrap: break-word">${G.prev}</td>
                                  <td class="text-black">${G.current}</td>
                                  </tr>
                              `).join("")}
                                      </tbody>
                                  </table>
                                  `;ce.fire({title:"",html:g,confirmButtonColor:pe.color.themePrimary,confirmButtonText:"",width:"80%"})};return Ro.sort((u,T)=>Ne.utc(T.info.update_at).valueOf()-Ne.utc(u.info.update_at).valueOf()).map((u,T)=>{const g=u.info.update_at;return h("div",{className:"flex",children:[a("p",{className:"text-[#3b3f5c] dark:text-white-light min-w-[58px] max-w-[100px] text-base font-semibold py-2.5",children:kc(g)}),a("div",{className:"relative before:absolute before:left-1/2 before:-translate-x-1/2 before:top-[15px] before:w-2.5 before:h-2.5 before:border-2 before:border-themePrimary before:rounded-full after:absolute after:left-1/2 after:-translate-x-1/2 after:top-[25px] after:-bottom-[15px] after:w-0 after:h-auto after:border-l-2 after:border-themePrimary after:rounded-full"}),h("div",{className:"p-2.5 self-center ltr:ml-2.5 rtl:ltr:mr-2.5 rtl:ml-2.5",children:[f&&a("p",{className:"text-[#3b3f5c] dark:text-white-light font-semibold text-[13px] cursor-pointer hover:underline",onClick:()=>r(u.details),children:""}),h("p",{className:"text-white-dark text-xs font-bold self-center",children:[" : ",u.info.chnage_by]})]})]},T)})})()})})]})}),a(_e.Panel,{children:h("div",{className:"pt-5",children:[E.is_closed&&a("div",{className:"flex w-full",children:a("div",{className:"flex items-center p-3.5 rounded text-success bg-success-light dark:bg-success-dark-light w-full",children:h("span",{className:"ltr:pr-2 rtl:pl-2",children:[a("strong",{className:"ltr:mr-1 rtl:ml-1",children:" :"})," ",E.credit.code," - ",E.credit.name]})})}),_===5?h("div",{className:"flex",children:[a("div",{className:"flex-1"}),h("div",{className:"flex-1 text-lg font-semibold text-center",children:[" ",E==null?void 0:E.reference]}),a("div",{className:"flex flex-1 justify-end",children:!E.is_closed&&!de&&h("button",{type:"button",className:"flex-0 btn btn-sm btn-outline-danger",onClick:()=>Jl(),disabled:E.on_payment_process==="pay_installment",children:[" ",E.on_payment_process==="close_contract"?"()":""]})})]}):a("div",{className:"flex",children:h("div",{className:"flex-1 text-lg font-semibold text-center",children:[" ",E==null?void 0:E.reference]})}),a("div",{className:"mt-5 panel p-0 border-0 overflow-hidden",children:a("div",{className:"table-responsive",children:h("table",{className:"table-striped table-hover",children:[a("thead",{children:h("tr",{children:[a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:"action"})]})}),a("tbody",{children:hn==null?void 0:hn.map(r=>{var u,T;return h("tr",{children:[a("td",{className:"text-center",children:r==null?void 0:r.ins_no}),h("td",{className:"text-center",children:[" ",r==null?void 0:r.amount]}),a("td",{className:"text-center",children:ni(r==null?void 0:r.due_at)}),a("td",{className:"text-center",children:a("span",{className:`badge ${Vl(r.status,r.is_due)}`,children:jl(r.status,r.is_due,r.invoice_type)})}),(r==null?void 0:r.status)==="complete"?h("td",{className:"text-center",children:[" ",(r==null?void 0:r.payment.amount)??"-"]}):a("td",{className:"text-center",children:" - "}),a("td",{className:"text-center",children:r!=null&&r.payed_at?Jt(r==null?void 0:r.payed_at):"-"}),(u=r.payment)!=null&&u.payment_method&&(r==null?void 0:r.status)==="complete"?h("td",{className:"text-center",children:[" ",(T=r.payment)==null?void 0:T.payment_method]}):a("td",{className:"text-center",children:" - "}),h("td",{className:"text-center",children:[" ",ql(r)," "]})]},r==null?void 0:r.id)})})]})})})]})}),a(_e.Panel,{children:a("div",{className:"xl:max-w-[900px] lg:max-w-[600px] md:max-w-[550px] sm:max-w-[400px] mx-auto mt-5",children:a(kt,{initialValues:$o,onSubmit:$l,enableReinitialize:!0,autoComplete:"off",validationSchema:Zt().shape({contentStatus:Ie().required("")}),children:r=>{var u,T;return h(Ut,{children:[!de&&h(Ve,{children:[h("div",{className:"flex gap-5 flex-col",children:[h("div",{className:"flex-1 text-lg font-semibold text-center",children:[" ",E==null?void 0:E.reference]}),h("div",{className:"flex-1 text-lg font-semibold",children:[" ",(u=E==null?void 0:E.credit)==null?void 0:u.name]})]}),![2,3,4,11,16,17,18,19,34,39].includes((T=E==null?void 0:E.credit)==null?void 0:T.id)&&h("div",{children:[a("div",{className:"flex-1 text-lg font-semibold mt-5",children:a(Me,{label:"",id:"contentStatus",name:"contentStatus",placeholder:"",options:Po})}),a("div",{className:"flex flex-1 mt-5",children:a(le,{label:"",name:"note",as:"textarea",rows:"5"})}),a("button",{type:"submit",className:"btn btn-primary !my-4 w-full border-0 primary ",children:""})]})]}),h("div",{children:[a("div",{className:"flex-1 text-lg font-semibold mt-4",children:""}),a("div",{className:"mt-5 panel p-0 border-0 overflow-hidden",children:a("div",{className:"table-responsive",children:h("table",{className:"table-striped table-hover",children:[a("thead",{children:h("tr",{children:[a("th",{className:"text-center",children:"-"}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""})]})}),a("tbody",{children:us==null?void 0:us.map(g=>{var G,re;return h("tr",{children:[a("td",{className:"text-center",children:g!=null&&g.created_at?Jt(g==null?void 0:g.created_at):"-"}),a("td",{className:"text-center",children:((G=g==null?void 0:g.credit)==null?void 0:G.code)+" - "+((re=g==null?void 0:g.credit)==null?void 0:re.name)}),a("td",{className:"text-center",children:(g==null?void 0:g.note)??"-"}),a("td",{className:"text-center",children:(g==null?void 0:g.name)??"-"})]},g==null?void 0:g.id)})})]})})})]})]})}})})}),a(_e.Panel,{children:c&&f&&h("div",{className:"panel px-6 flex-1 py-6 z-[0]",children:[a(kt,{initialValues:{message:""},onSubmit:zr,enableReinitialize:!0,autoComplete:"off",validationSchema:Zt().shape({message:Ie().nullable().required("")}),children:({values:r})=>a(Ut,{children:_<=5&&h("div",{children:[a(le,{label:"",name:"message",as:"textarea",rows:"5",placeholder:" ",className:"form-textarea ltr:rounded-l-none rtl:rounded-r-none resize-none"}),a("div",{className:"text-right",children:a("button",{type:"reset",className:"btn btn btn-outline-primary !mt-2 display-inline",onClick:()=>{zr(r)},children:""})})]})})}),a("div",{className:"mt-5 ",children:Co.map(r=>h("div",{children:[h("div",{className:"mt-2",children:[r.name," ",Jt(r.created_at)]}),a("div",{className:"bg-[#eeeeee] py-3 px-6",children:r.message})]},r.name))})]})}),a(_e.Panel,{children:a("div",{className:"xl:max-w-[1200px] lg:max-w-[600px] md:max-w-[550px] sm:max-w-[400px] mx-auto mt-5",children:a(kt,{initialValues:_n,onSubmit:Wl,enableReinitialize:!0,autoComplete:"off",validationSchema:Zt().shape({provider_applock_id:Ie().nullable().required("")}),children:r=>{var u,T;return h(Ut,{children:[a("div",{className:"flex gap-5 flex-col",children:a("div",{className:"flex-1 text-lg font-semibold text-center",children:""})}),!de&&a(Ve,{children:!(E!=null&&E.is_completed)&&![2,3,4,11,16,17,18,19,34,39].includes((u=E==null?void 0:E.credit)==null?void 0:u.id)&&h(Ve,{children:[a("div",{className:"text-lg font-semibold",children:a(Me,{label:"",id:"provider_applock_id",name:"provider_applock_id",placeholder:"",options:Bo,onChange:g=>Vo(g.value)})}),h("div",{children:[a("div",{className:"flex-1 text-lg font-semibold my-5 ",children:a(Me,{label:"",id:"isLockedStatus",name:"isLockedStatus",placeholder:"",options:[{value:!1,label:""},{value:!0,label:""}]})}),Go==0&&a("div",{className:"flex items-center p-3.5 rounded text-danger bg-danger-light border border-danger",children:a("span",{className:"ltr:pr-2 rtl:pl-2",children:"   "})}),a("button",{type:"submit",className:"btn btn-primary !my-4 w-full border-0 primary ",children:""})]})]})}),h("div",{children:[a("div",{className:"flex-1 text-lg font-semibold mt-4",children:""}),a("div",{className:"mt-5 panel p-0 border-0 overflow-hidden",children:a("div",{className:"table-responsive",children:h("table",{className:"table-striped table-hover",children:[a("thead",{children:h("tr",{children:[a("th",{className:"text-center",children:"-"}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center min-w-[180px]",children:"()"}),a("th",{className:"text-center",children:""}),a("th",{className:"text-center",children:""})]})}),a("tbody",{children:(T=_n==null?void 0:_n.history)==null?void 0:T.map(g=>h("tr",{children:[a("td",{className:"text-center",children:g!=null&&g.created_at?Jt(g==null?void 0:g.created_at):"-"}),a("td",{className:"text-center",children:g==null?void 0:g.is_locked}),a("td",{className:"text-center",children:(g==null?void 0:g.service_provider)??"-"}),a("td",{className:"text-center",children:(g==null?void 0:g.is_lock_device)??"-"}),a("td",{className:"text-center",children:a("span",{className:`${Hl(g==null?void 0:g.device_status)}`,children:(g==null?void 0:g.device_status)??"-"})}),a("td",{className:"text-center",children:(g==null?void 0:g.name)??"-"}),a("td",{className:"text-center",children:(g==null?void 0:g.note)??"-"})]},g==null?void 0:g.id))})]})})})]})]})}})})})]})]})}),a(ke,{appear:!0,show:yr,as:R.Fragment,children:h(Je,{as:"div",open:yr,onClose:()=>Tr(!1),className:"relative z-[51]",children:[a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a("div",{className:"fixed inset-0 bg-[black]/60"})}),a("div",{className:"fixed inset-0 overflow-y-auto",children:a("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:h(Je.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[a("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>{Tr(!1)},children:a(Ft,{})}),h("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:[" : #",E==null?void 0:E.reference]}),h("div",{className:"p-8",children:[h("div",{className:"grid grid-cols-2 content-center",children:[a("div",{className:"h-auto p-2 w-auto",children:"  "}),a("div",{className:"h-auto p-2 w-auto text-right",children:($r=E==null?void 0:E.asset)==null?void 0:$r.name})]}),h("div",{className:"grid grid-cols-2 content-center",children:[a("div",{className:"h-auto p-2 w-auto",children:"  "}),a("div",{className:"h-auto p-2 w-auto text-right",children:ie==null?void 0:ie.ins_no})]}),h("div",{className:"grid grid-cols-2 content-center",children:[a("div",{className:"h-auto p-2 w-auto",children:"  "}),a("div",{className:"h-auto p-2 w-auto text-right",children:ie!=null&&ie.payed_at?ni(ie==null?void 0:ie.payed_at):"-"})]}),h("div",{className:"grid grid-cols-2 content-center",children:[a("div",{className:"h-auto p-2 w-auto",children:"  "}),h("div",{className:"h-auto p-2 w-auto text-right",children:[(Wr=ie==null?void 0:ie.amount)==null?void 0:Wr.toLocaleString("en-US"),""]})]}),h("div",{className:"grid grid-cols-2 content-center",children:[a("div",{className:"h-auto p-2 w-auto",children:" / "}),h("div",{className:"h-auto p-2 w-auto text-right",children:[ie==null?void 0:ie.penalty_fee,""]})]}),h("div",{className:"grid grid-cols-2 content-center",children:[a("div",{className:"h-auto p-2 w-auto",children:"  "}),h("div",{className:"h-auto p-2 w-auto text-right",children:[ie==null?void 0:ie.fee,""]})]}),h("div",{className:"grid grid-cols-2 content-center",children:[a("div",{className:"h-auto p-2 w-auto",children:"  "}),h("div",{className:"h-auto p-2 w-auto text-right",children:[((ie==null?void 0:ie.amount)+(ie==null?void 0:ie.penalty_fee)+(ie==null?void 0:ie.fee)).toLocaleString("en-US"),""]})]})]})]})})})})]})}),a(ke,{appear:!0,show:Ir,as:R.Fragment,children:h(Je,{as:"div",open:Ir,onClose:()=>ls(!1),className:"relative z-[52]",children:[a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a("div",{className:"fixed inset-0 bg-[black]/60"})}),a("div",{className:"fixed inset-0 overflow-y-auto",children:a("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:h(Je.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-xl text-black dark:text-white-dark",children:[a("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>{ls(!1)},children:a(Ft,{})}),a("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px] pt-7 text-center",children:" "}),h("div",{className:"p-8 pt-3 bg-[#fbfbfb]",children:[a("div",{className:"grid content-center",children:a("div",{className:"h-auto p-2 w-auto",children:h(go,{children:[h(vo,{children:[a(Io,{}),a(yo,{}),a(cn,{}),a(bo,{}),a(To,{})]}),a(Eo,{containerProps:{style:{minHeight:"300px"}},value:ps,onChange:r=>Nr(r.target.value)})]})})}),a("div",{className:"flex justify-center",children:a("button",{type:"button",className:"btn !mt-6 w-full border-0 btn-primary max-w-[200px]",onClick:()=>Yl(),children:""})})]})]})})})})]})}),a(ke,{appear:!0,show:vr,as:R.Fragment,children:h(Je,{as:"div",open:vr,onClose:()=>cs(!1),className:"relative z-[52]",children:[a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a("div",{className:"fixed inset-0 bg-[black]/60"})}),a("div",{className:"fixed inset-0 overflow-y-auto",children:a("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:h(Je.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-xl text-black dark:text-white-dark",children:[a("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>{cs(!1)},children:a(Ft,{})}),a("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px] pt-7 text-center",children:"-"}),a("div",{className:"px-6",children:a(kt,{initialValues:kr,onSubmit:_l,enableReinitialize:!0,autoComplete:"off",validationSchema:oc,children:r=>h(Ut,{className:"space-y-5 dark:text-white custom-select",children:[h("div",{className:"input-flex-row",children:[a("div",{className:"input-container",children:a(le,{label:"",name:"down_payment",onKeyPress:u=>{/[0-9]/.test(u.key)||u.preventDefault()},onKeyUp:u=>{var g,G;let T=0;((g=u==null?void 0:u.target)==null?void 0:g.value)!==""&&(T=parseInt(((G=u==null?void 0:u.target)==null?void 0:G.value)??"0")??0),r.setFieldValue("down_payment",T!==0?T:""),r.values.down_payment=T!==0?T:"",Pt(Lt({...r==null?void 0:r.values,down_payment:T!==0?T:0}))},require:!0})}),a("div",{className:"input-container",children:a(le,{label:"",name:"ins_amount",onKeyPress:u=>{/[0-9]/.test(u.key)||u.preventDefault()},onKeyUp:u=>{var g,G;let T=0;((g=u==null?void 0:u.target)==null?void 0:g.value)!==""&&(T=parseInt(((G=u==null?void 0:u.target)==null?void 0:G.value)??"0")??0),r.setFieldValue("ins_amount",T!==0?T:""),r.values.ins_amount=T!==0?T:"",Pt(Lt({...r==null?void 0:r.values,ins_amount:T!==0?T:0}))},require:!0})})]}),h("div",{className:"input-flex-row",children:[a("div",{className:"input-container",children:a(le,{label:"",name:"penalty_fee",onKeyPress:u=>{/[0-9]/.test(u.key)||u.preventDefault()},onKeyUp:u=>{var g,G;let T=0;((g=u==null?void 0:u.target)==null?void 0:g.value)!==""&&(T=parseInt(((G=u==null?void 0:u.target)==null?void 0:G.value)??"0")??0),r.setFieldValue("penalty_fee",T),r.values.penalty_fee=T,Pt(Lt({...r==null?void 0:r.values,penalty_fee:T}))},require:!0})}),a("div",{className:"input-container",children:a(le,{label:"",name:"unlock_fee",onKeyPress:u=>{/[0-9]/.test(u.key)||u.preventDefault()},onKeyUp:u=>{var g,G;let T=0;((g=u==null?void 0:u.target)==null?void 0:g.value)!==""&&(T=parseInt(((G=u==null?void 0:u.target)==null?void 0:G.value)??"0")??0),r.setFieldValue("unlock_fee",T!==0?T:""),r.values.unlock_fee=T!==0?T:"",Pt(Lt({...r==null?void 0:r.values,unlock_fee:T!==0?T:0}))},require:!0})})]}),h("div",{className:"input-flex-row",children:[a("div",{className:"input-container",children:a(le,{label:" ",name:"other_fee",onKeyPress:u=>{/[0-9]/.test(u.key)||u.preventDefault()},onKeyUp:u=>{var g,G;let T=0;((g=u==null?void 0:u.target)==null?void 0:g.value)!==""&&(T=parseInt(((G=u==null?void 0:u.target)==null?void 0:G.value)??"0")??0),r.setFieldValue("other_fee",T!==0?T:""),r.values.other_fee=T!==0?T:"",Pt(Lt({...r==null?void 0:r.values,other_fee:T!==0?T:0}))},require:!0})}),a("div",{className:"input-container",children:a(le,{label:" 50%",name:"deduct_down_payment",onKeyPress:u=>{if(!/[0-9]/.test(u.key)){u.preventDefault();return}},require:!0,disabled:!0})})]}),h("div",{className:"input-flex-row",children:[a("div",{className:"input-container",children:a(le,{label:"",name:"total",disabled:!0})}),a("div",{className:"input-container",children:""})]}),a("div",{className:"mt-1 pb-8 bg-[#fbfbfb]",children:a("div",{className:"flex justify-center",children:a("button",{type:"submit",className:"btn !mt-6 w-full border-0 btn-primary max-w-[300px]",children:"-"})})})]})})})]})})})})]})}),a(ke,{appear:!0,show:Rr,as:R.Fragment,children:h(Je,{as:"div",open:Rr,onClose:()=>$t(!1),className:"relative z-[52]",children:[a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a("div",{className:"fixed inset-0 bg-[black]/60"})}),a("div",{className:"fixed inset-0 overflow-y-auto",children:a("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:a(ke.Child,{as:R.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:h(Je.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-xl text-black dark:text-white-dark",children:[a("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>{$t(!1)},children:a(Ft,{})}),h("div",{className:"flex flex-col items-center justify-center py-6 px-8",children:[a("h1",{className:"text-2xl font-bold",children:" Ekyc"}),a("p",{className:"text-red-500",children:" "}),h("div",{className:"mt-4 flex gap-4",children:[a("button",{type:"button",onClick:()=>$t(!1),className:"btn shadow-lg",children:""}),a("button",{type:"button",onClick:async()=>await mc({}),className:"btn bg-red-600 text-white shadow-lg hover:shadow-none max-w-40",children:""})]})]})]})})})})]})})]})})};export{M_ as default};
