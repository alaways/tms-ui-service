import{u as ye,a as ve,an as Ae,r as a,c as m,g as o,f as r,F as Se,j as t,p as Ee,v as Ne,s as Ce}from"./index-a90aa29c.js";import{c as B,a as g}from"./object-7405de1d.js";import{S as Te}from"./sweetalert2.all-ca2d1030.js";import{T as q}from"./tippy-react.esm-150a8dd6.js";import{d as xe}from"./debounce-5af6d14d.js";import{Q as Ie}from"./index-2f30bf27.js";import{F as De,a as Pe}from"./formik.esm-c4fd04ca.js";import{S as Re}from"./react-select.esm-b46d9623.js";import{I as Ue}from"./InputField-d7971719.js";import{S as K}from"./SelectField-917481a8.js";import{P as W}from"./config-8de56c22.js";import{s as n}from"./showNotification-b9615e49.js";import{I as ke}from"./IconX-54a3093e.js";import{I as Me}from"./IconEdit-bf2b08f0.js";import{I as we}from"./IconPlus-4c7e79c8.js";import{I as Oe}from"./IconSettings-49e5d033.js";import{I as Le}from"./IconTrashLines-902954df.js";import{B as Fe}from"./breadcrumbs-b9914bbc.js";/* empty css              */import{q as x,_ as Y}from"./transition-d4ca4cfa.js";import"./_defineProperty-6dbd93ca.js";import"./_baseIsEqual-06123cd3.js";import"./isObjectLike-b76e75a8.js";import"./isSymbol-15555f2d.js";import"./floating-ui.dom-0aeb9e8a.js";import"./createSuper-98fcd92d.js";import"./lodash-f7ec5310.js";import"./keyboard-f171a3e5.js";import"./use-is-mounted-22b05dcc.js";import"./bugs-a60d55c3.js";const je="admin",gt=()=>{const z=ye(),$=ve(),{id:y,type_name:I}=Ae(),h=y?Number(y):void 0,D=localStorage.getItem(je);(D?JSON.parse(D).role:null)!=="admin"&&z("/");const c={id:"",name:"",id_asset_type:y,id_asset_name:"",is_active:!0},P=[{id:1,title:"สินทรัพย์"},{id:2,title:"ประเภท สี"},{id:3,title:"ประเภท รุ่น"}],[s,X]=a.useState(P[0]),[f,A]=a.useState(!1),[J,Q]=a.useState([]),[S,R]=a.useState(c),[Z,ee]=a.useState([]),[E,U]=a.useState(c),[te,se]=a.useState([]),[N,k]=a.useState(c),[ae,ie]=a.useState([]),[C,Ve]=a.useState(c),[M,p]=a.useState(!1),[u,w]=a.useState(1),[_,re]=a.useState(W[4]),[oe,v]=a.useState(0),[d,ne]=a.useState(""),[le,ce]=a.useState([]),[de,me]=a.useState([]),[b,pe]=a.useState(null),{mutate:O}=m(o.nameFindAll,{onSuccess:e=>{$(Ce("ตั้งค่าประเภทสินทรัพย์"+I)),Q(e.data.list),v(e.data.total),ce([{value:null,label:"ทั้งหมด"},...e.data.list.map(i=>({value:i.id,label:i.name}))]),me([...e.data.list.map(i=>({value:i.id,label:i.name}))])},onError:()=>{console.error("Failed to fetch asset name data")}}),{mutate:L}=m(o.colorFindAll,{onSuccess:e=>{ee(e.data.list),v(e.data.total)},onError:()=>{console.error("Failed to fetch asset color data")}}),{mutate:F}=m(o.modelFindAll,{onSuccess:e=>{se(e.data.list),v(e.data.total)},onError:()=>{console.error("Failed to fetch asset model data")}}),{mutate:j}=m(o.capacityFindAll,{onSuccess:e=>{ie(e.data.list),v(e.data.total)},onError:()=>{console.error("Failed to fetch asset capacity data")}}),l=a.useCallback(()=>{if(s.id===1)O({data:{page:u,page_size:_,query:d,id_asset_type:h}});else if(s.id===2){const e={page:u,page_size:_,query:d,id_asset_type:h};b!==null&&(e.id_asset_name=b),L({data:e})}else if(s.id===3){const e={page:u,page_size:_,query:d,id_asset_type:h};b!==null&&(e.id_asset_name=b),F({data:e})}else s.id===4&&j({data:{page:u,page_size:_,query:d,id_asset_type:h}})},[s,u,_,d,b,O,L,F,j]);a.useEffect(()=>{l()},[l]);const{mutate:H}=m(s.id===1?o.nameCreate:s.id===2?o.colorCreate:s.id===3?o.modelCreate:o.capacityCreate,{onSuccess:e=>{e.statusCode===200||e.code===200?(n("เพิ่มข้อมูลสำเร็จ","success"),p(!1),l()):n(e.message,"error")},onError:e=>{n(e.message,"error")}}),{mutate:V}=m(s.id===1?o.nameUpdate:s.id===2?o.colorUpdate:s.id===3?o.modelUpdate:o.capacityUpdate,{onSuccess:e=>{e.statusCode===200||e.code===200?(n("แก้ไขข้อมูลสำเร็จ","success"),p(!1),l()):n(e.message,"error")},onError:e=>{n(e.message,"error")}}),{mutate:ue}=m(s.id===1?o.nameDelete:s.id===2?o.colorDelete:s.id===3?o.modelDelete:o.capacityDelete,{onSuccess:e=>{e.statusCode===200||e.code===200?(n("ลบข้อมูลสำเร็จ","success"),l()):n(e.message,"error")},onError:e=>{n(e.message,"error")}}),G=(e=null)=>{if(e){const i=JSON.parse(JSON.stringify(e));s.id===1?R(i):s.id===2?U(i):s.id===3&&k(i)}else s.id===1?R(c):s.id===2?U(c):s.id===3&&k(c);p(!0)},_e=B().shape({name:g().required("กรุณาใส่ข้อมูลให้ครบ"),is_active:g().required("กรุณาใส่ข้อมูลให้ครบ")}),he=B().shape({name:g().required("กรุณาใส่ข้อมูลให้ครบ"),id_asset_name:g().required("กรุณาใส่ข้อมูลให้ครบ"),is_active:g().required("กรุณาใส่ข้อมูลให้ครบ")}),fe=a.useCallback(e=>{const i={...e,active:e.is_active};e.id?V({data:i,id:e.id}):H({data:{...i,id_asset_type:h}})},[H,V,y]),be=e=>{Te.fire({title:"คุณแน่ใจหรือไม่?",text:"คุณจะไม่สามารถกู้คืนข้อมูลนี้ได้!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"ใช่, ลบเลย!",cancelButtonText:"ยกเลิก"}).then(i=>{i.isConfirmed&&ue({data:e,id:e.id})})},T=a.useMemo(()=>xe(()=>{l()},500),[l]);return a.useEffect(()=>(T(),()=>{T.cancel()}),[d,T]),r(Se,{children:[t("div",{className:"my-2",children:t(Fe,{items:[{to:"/apps/asset-type/list",label:"ประเภทสินทรัพย์"},{label:"ตั้งค่า",isCurrent:!0}]})}),t("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:t("div",{className:"flex items-center justify-between flex-wrap gap-4 px-5 ",children:r("p",{className:"text-lg",children:["ตั้งค่าประเภทสินทรัพย์: ",I]})})}),r("div",{className:"flex flex-col xl:flex-row gap-5 relative mt-5",children:[t("div",{className:`${f?"!block h-full xl:h-auto":""} panel absolute xl:relative p-0 flex-none w-80 border-0 overflow-y-auto z-10 xl:block divide-y divide-[#ebedf2] dark:divide-[#191e3a] hidden`,children:P.map(e=>t("div",{children:t("button",{type:"button",className:`${e.id===s.id?"bg-gray-100 dark:bg-[#192A3A]":""} w-full flex items-center p-4 hover:bg-gray-100 dark:hover:bg-[#192A3A]`,onClick:()=>{X(e),A(!f)},children:t("div",{className:"ltr:pr-4 rtl:pl-4",children:r("div",{className:"flex items-center mt-2 font-semibold",children:[r("div",{className:"flex items-center font-normal mr-3",children:[t(Oe,{}),t("div",{className:"font-medium text-sm"})]}),t("div",{className:"min-w-20 text-base ltr:mr-3 rtl:ml-3 ",children:e.title})]})})})},e.id))}),t("div",{className:`bg-black/60 z-[5] w-full h-full absolute rounded-md hidden ${f?"!block xl:!hidden":""}`,onClick:()=>A(!f)}),r("div",{className:"panel p-0 flex-1",children:[r("div",{className:"flex items-center justify-between flex-wrap gap-4 p-4  border-b border-[#ebedf2] dark:border-[#191e3a]",children:[r("div",{className:"flex sm:flex-row flex-col sm:items-center sm:gap-3 gap-4 w-full sm:w-auto",children:[t("button",{type:"button",className:"xl:hidden hover:text-primary block ltr:mr-5 rtl:ml-5",onClick:()=>A(!f),children:t(Ee,{})}),t("p",{className:"text-lg",children:s.title})]}),t("div",{className:"flex sm:flex-row flex-col sm:items-center sm:gap-3 gap-4 w-full sm:w-auto"})]}),r("div",{className:"flex justify-between py-2 px-4 pt-5",children:[t("div",{className:"flex flex-row items-center gap-3",children:r("button",{type:"button",className:"btn btn-primary",onClick:()=>G(),children:[t(we,{className:"ltr:mr-2 rtl:ml-2"}),"เพิ่ม"]})}),r("div",{className:"flex flex-row gap-3",children:[s.id===2||s.id===3?t(Re,{placeholder:"สินทรัพย์",className:"pr-6 z-10 w-[200px]",options:le,isSearchable:!0,onChange:e=>{pe(e.value),l()}}):null,r("div",{className:"relative",children:[t("input",{type:"text",placeholder:"ค้นหา",className:"form-input py-2 ltr:pr-11 rtl:pl-11 peer",value:d,onChange:e=>ne(e.target.value)}),t("button",{type:"button",className:"absolute ltr:right-[11px] rtl:left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-primary",children:t(Ne,{className:"mx-auto"})})]})]})]}),t("div",{className:"flex-1 p-4 overflow-hidden",children:t("div",{className:"datatables pagination-padding",children:t(Ie,{className:"whitespace-nowrap table-hover invoice-table",records:s.id===1?J:s.id===2?Z:s.id===3?te:ae,columns:[{accessor:"id",title:"ลำดับ",sortable:!1,render:(e,i)=>t("div",{children:i+1})},...s.id===2||s.id===3?[{accessor:"asset_name",title:"ชื่อสินทรัพย์",sortable:!1,render:({asset_name:e})=>t("div",{className:"flex items-center font-normal",children:t("div",{children:e?e.name:"-"})})}]:[],{accessor:"name",title:s.id===1?"ชื่อสินทรัพย์":s.id===2?"สี":s.id===3?"รุ่น":"ความจุ",sortable:!1,render:({name:e})=>t("div",{className:"flex items-center font-normal",children:t("div",{children:e})})},{accessor:"is_active",title:"เปิดปิดการใช้งาน",sortable:!1,render:({is_active:e})=>t("span",{className:`badge ${e?"badge-outline-success":"badge-outline-danger"}`,children:e?"เปิดใช้งาน":"ปิดใช้งาน"})},{accessor:"action",title:"Actions",sortable:!1,textAlignment:"center",render:e=>r("div",{className:"flex gap-4 items-center w-max mx-auto",children:[t(q,{content:"แก้ไข",theme:"Primary",children:t("a",{className:"flex hover:text-info cursor-pointer",onClick:()=>G(e),children:t(Me,{className:"w-4.5 h-4.5"})})}),t(q,{content:"ลบ",theme:"Primary",children:t("a",{className:"flex hover:text-danger",onClick:i=>be(e),children:t(Le,{})})})]})}],highlightOnHover:!0,totalRecords:oe,recordsPerPage:_,page:u,onPageChange:e=>w(e),recordsPerPageOptions:W,onRecordsPerPageChange:e=>{w(1),re(e)},paginationText:({from:e,to:i,totalRecords:ge})=>`โชว์ ${e} ถึง ${i} ของ ${ge} หน้าทั้งหมด`})})})]})]}),t(x,{appear:!0,show:M,as:a.Fragment,children:r(Y,{as:"div",open:M,onClose:()=>p(!1),className:"relative z-[51]",children:[t(x.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t("div",{className:"fixed inset-0 bg-[black]/60"})}),t("div",{className:"fixed inset-0 overflow-y-auto",children:t("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:t(x.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:r(Y.Panel,{className:"panel border-0 p-0 pb-3 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[t("button",{type:"button",className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",onClick:()=>p(!1),children:t(ke,{})}),t("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:S.id||E.id||N.id||C.id?"แก้ไข":"เพิ่ม"}),t("div",{className:"p-5",children:t(De,{enableReinitialize:!0,autoComplete:"off",onSubmit:fe,initialValues:s.id===1?S:s.id===2?E:s.id===3?N:C,validationSchema:s.id===2||s.id===3?he:_e,children:e=>r(Pe,{className:"space-y-5  mb-7 dark:text-white custom-select",children:[s.id===2||s.id===3?t(K,{require:!0,id:"id_asset_name",label:"สินทรัพย์",name:"id_asset_name",options:de,onChange:i=>{e.setFieldValue("id_asset_name",i.value)}}):null,t(Ue,{require:!0,label:"ชื่อ",name:"name",type:"text",placeholder:"กรุณาใส่ข้อมูล"}),t(K,{require:!0,label:"สถานะ",id:"is_active",name:"is_active",options:[{value:!0,label:"เปิด"},{value:!1,label:"ปิด"}],placeholder:"กรุณาเลือก",onChange:i=>{e.setFieldValue("is_active",i.value)},isSearchable:!1}),r("div",{className:"flex justify-end items-center mt-8",children:[t("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>p(!1),children:"ยกเลิก"}),t("button",{type:"submit",className:"btn btn-primary ltr:ml-4 rtl:mr-4",children:S.id||E.id||N.id||C.id?"บันทึก":"เพิ่ม"})]})]})})})]})})})})]})})]})};export{gt as default};
